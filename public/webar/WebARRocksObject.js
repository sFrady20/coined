/**
 * Copyright (c) 2020 WebAR.rocks ( https://webar.rocks )
 * 
 * You cannot reproduce, sublicense, distribute or sell this software or part of this software without an explicit (and written) authorization of WebAR.rocks.
 * 
 * You should be granted by a written agreement by WebAR.rocks to use this software for an explicit period of time (e.g. yearly).
 * This agreement should list the domain(s) where this software can be hosted. Each subdomain is considered as a separate domain. A 301 or 302 HTTP direction to an authorized domain is authorized too.
 * 
 * You cannot use this software or part of this software for other purpose than rigid head accessories virtual try-on.
 * 
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. 
 * 
*/

var WEBARROCKSOBJECT=(function(){window.WEBARROCKSOBJECT=function(){function ob(){var b=null,c=null,d=null,e=0;this.Ec=function(k){return b[k]};this.ad=function(k){var m=null;e=k.length;b=k.map(function(l,n){l=Object.assign({},l,{index:n,parent:this,Ga:m,Mc:n===e-1});return m=n=0===n?Cb.instance(l):Db.instance(l)});c=b[0];d=b[e-1];b.forEach(function(l,n){0!==n&&l.Wc()})};this.I=function(k,m){var l=m;b.forEach(function(n){l=n.I(l,k)});return l};this.Dc=function(){return c.B()};this.Gc=function(){return d.B()};this.Hb=function(){return d.Fc()};
this.cd=function(k){d.pc(k)};this.Fb=function(){return d.Fb()};this.j=function(){b&&(b.forEach(function(k){k.j()}),d=c=b=null,e=0)}}var Za;function fb(b,c){var d=c%8;return b[(c-d)/8]>>7-d&1}function Eb(b){var c=JSON.parse(b);b=c.ne;var d=c.nf,e=c.n;var k="undefined"===typeof btoa?Buffer.from(c.data,"base64").toString("latin1"):atob(c.data);var m=k.length;c=new Uint8Array(m);for(var l=0;l<m;++l)c[l]=k.charCodeAt(l);k=new Float32Array(e);m=new Float32Array(d);l=b+d+1;for(var n=0;n<e;++n){for(var p=
l*n,r=0===fb(c,p)?1:-1,h=p+1,u=1,y=0,z=h+b-1;z>=h;--z)y+=u*fb(c,z),u*=2;h=y;p=p+1+b;u=m.length;y=0;for(z=p;z<p+u;++z)m[y]=fb(c,z,!0),++y;for(u=p=0;u<d;++u)p+=m[u]*Math.pow(2,-u-1);k[n]=0===p&&0===h?0:r*(1+p)*Math.pow(2,1+h-Math.pow(2,b-1))}return k}function pb(b){if(b){var c=b.w,d=b.h;t.A.da[0]=-1+2*(b.x+c/2)/t.P;t.A.da[1]=-1+2*(b.y+d/2)/t.O;t.A.scale[0]=c/t.P;t.A.scale[1]=d/t.O}else t.A.da[0]=0,t.A.da[1]=0,t.A.scale[0]=1,t.A.scale[1]=1;t.width=t.P*t.A.scale[0];t.height=t.O*t.A.scale[1]}function gb(){var b=
[{type:"2f",name:"u33",value:t.A.da},{type:"2f",name:"u34",value:t.A.scale}],c=b.concat([{type:"1f",name:"u35",value:t.P/t.O},{name:"u7",type:"2f",value:[1/t.P,1/t.O]}]);x.C("s47",c);x.C("s48",c);x.C("s49",b)}function Ea(b,c,d){var e=Aa(b,c,"dx")*t.Z[0],k=Aa(b,c,"dy")*t.Z[1];b=d[2]*Aa(b,c,"ds");if(Ma){c=Math.cos(wa);var m=Math.sin(wa),l=-m*e+c*k;e=c*e+m*k;k=l}e*=d[0];k*=d[1];d=H.g[2];c=H.g[3];H.g[0]-=e*d*O.S[0];H.g[1]-=k*c*O.S[1];H.g[2]-=b*d*O.S[2];H.g[2]=Na.Oa(H.g[2],U.Wb[0]*t.Z[0],U.Wb[1]*t.Z[0]);
H.g[0]=Na.Oa(H.g[0],0,1);H.g[3]=H.g[2]*t.aspectRatio/t.wa;H.g[1]=Na.Oa(H.g[1],0,1)}function hb(b){var c=H.g[2],d=H.g[3],e=(2*Math.random()-1)*b,k=.5*(2*Math.random()-1)*b;H.g[0]+=(2*Math.random()-1)*b*c;H.g[1]+=e*d;H.g[2]+=k*c;H.g[3]=H.g[2]*t.aspectRatio/t.wa}function Aa(b,c,d){c=xa[c].Ob[d];return(b[c][0]+b[c][1]+b[c][2]+b[c][3])/4}function qb(b,c){if(O.Za){if(O.jb){var d=Aa(b,c,"yaw");b=-Aa(b,c,"notHere");return Math.atan2(b,d)}return Math.PI*Aa(b,c,"yaw")}return 0}function rb(b,c,d,e){c=xa[c].Ob[d];
return(b[c][0]+b[c][1]+b[c][2]+b[c][3])/4*(1-e)+e*Math.min(b[c][0],b[c][1],b[c][2],b[c][3])}function $a(b,c,d){var e=rb(b,c,"here",d),k=0;0<ib&&!O.jb&&(k=ib*rb(b,c,"notHere",d));return(e-k)/xa[c].mb}function Oa(){wa=0;Ma&&null!==Ta&&(wa=Ta[0]+Math.random()*(Ta[1]-Ta[0]));ia=X.ba;var b=Fa[Ua];b&&(H.g[0]=b[0],H.g[1]=b[1],H.g[2]=b[2],H.g[3]=b[3]);Ua=(Ua+1)%Fa.length}function Fb(b,c){O.fa&&(ea.roll=Ma?wa:jb);O.ya&&(ea.pitch=sb);O.Za&&(ea.yaw=b);ea.label=xa[R.v].label;ea.distance=xa[R.v].vc;ea.positionScale[0]=
.5+(H.g[0]-.5)/t.A.scale[0];ea.positionScale[1]=.5+(H.g[1]-.5)/t.A.scale[1];ea.positionScale[2]=H.g[2];ea.positionScale[3]=H.g[3];ea.detectScore=c}function Gb(b){var c=-1,d=-1E12;-1!==[X.ba,X.Ka].indexOf(ia)&&xa.forEach(function(p,r){p=$a(b,r,0);p>d&&(d=p,c=r)});switch(ia){case X.ba:ia=X.Ka;Ea(b,c,[1,1,1]);Za=0;break;case X.Ka:++Za;d>K.Ja?(K.ga?(ia=X.na,Va=c,R.v=c,R.eb=0):(ia=X.pb,tb=0,Va=c),Ea(b,Va,[1,1,1])):Za>U.Rc?Oa():Ea(b,c,[1,1,1]);break;case X.pb:++tb>K.Ea&&(ia=X.na,R.n=0,R.Qb=0,R.v=Va,R.K[0]=
0,R.K[1]=0);Ea(b,Va,[1,1,1]);hb(K.Aa);break;case X.na:if(K.ga||++R.n>K.V){var e=$a(b,R.v,1);if(K.ga||e>K.Ja+K.Ia||K.xa){O.fa&&(jb=O.Vb*Aa(b,R.v,"roll"),Ma&&(wa+=jb));if(kb){var k=-1;k=K.ga||K.xa?qb(b,R.v):Math.atan2(R.K[1],R.K[0]);if(O.ya){var m=.5+.5*Aa(b,R.v,"pitch");sb=O.pitchRange[0]+(O.pitchRange[1]-O.pitchRange[0])*m}Fb(k,e)}K.xa?(Ea(b,R.v,K.Zb),e>K.Yb?(R.eb=0,ea.label||(ea.label=xa[R.v].label)):++R.eb>K.Ca&&Oa()):kb?Oa():Ea(b,R.v,[.5,.5,.5])}else Oa()}else{var l=1-(K.V-R.n)/(K.V-1);e=1.5-1*
l;Ea(b,R.v,[e,e,e]);hb(K.ra*(1-l));var n=$a(b,R.v,l);n<K.Ja*l*K.sa?Oa():++R.Qb>10*K.V?Oa():xa.some(function(p,r){return R.v===r?!1:$a(b,r,l)>n*(K.ka*l+(1-l))?!0:!1})?(hb(K.la[0]),wa+=(2*Math.random()-1)*K.la[1]*Math.PI/180,R.n=0,R.K[0]=0,R.K[1]=0):(e=qb(b,R.v),R.K[0]+=Math.cos(e),R.K[1]+=Math.sin(e))}}}function Hb(){x.dc([{id:"s48",name:"_",aa:"attribute vec2 a0;uniform vec4 u36;uniform vec2 u33,u34;uniform float u32,u35;varying vec2 vv0;void main(){gl_Position=vec4(a0,0.,1.);float a=u35*(u36.z/u36.w);a*=u34.x/u34.y;float b=cos(u32),c=sin(u32);vec2 f=mat2(b,-c*a,c/a,b)*a0,g=u33+f*u34,d=u36.xy+.5*u36.zw*g;vv0=vec2(d.x,1.-d.y);}",
a:"uniform sampler2D u1;uniform vec2 u7;varying vec2 vv0;const vec3 g=vec3(1.,1.,1.);vec3 c[9];void main(){vec2 d=vv0+.5*u7;c[0]=texture2D(u1,d-u7*vec2(-1.,-1.)).rgb,c[1]=texture2D(u1,d-u7*vec2(-1.,0.)).rgb,c[2]=texture2D(u1,d-u7*vec2(-1.,1.)).rgb,c[3]=texture2D(u1,d-u7*vec2(0.,-1.)).rgb,c[4]=texture2D(u1,d-u7).rgb,c[5]=texture2D(u1,d-u7*vec2(0.,1.)).rgb,c[6]=texture2D(u1,d-u7*vec2(1.,-1.)).rgb,c[7]=texture2D(u1,d-u7*vec2(1.,0.)).rgb,c[8]=texture2D(u1,d-u7*vec2(1.,1.)).rgb;vec3 a,b;a=min(c[0],c[1]),b=max(c[0],c[1]),c[0]=a,c[1]=b,a=min(c[0],c[2]),b=max(c[0],c[2]),c[0]=a,c[2]=b,a=min(c[0],c[3]),b=max(c[0],c[3]),c[0]=a,c[3]=b,a=min(c[0],c[4]),b=max(c[0],c[4]),c[0]=a,c[4]=b,a=min(c[0],c[5]),b=max(c[0],c[5]),c[0]=a,c[5]=b,a=min(c[0],c[6]),b=max(c[0],c[6]),c[0]=a,c[6]=b,a=min(c[0],c[7]),b=max(c[0],c[7]),c[0]=a,c[7]=b,a=min(c[0],c[8]),b=max(c[0],c[8]),c[0]=a,c[8]=b,a=min(c[1],c[2]),b=max(c[1],c[2]),c[1]=a,c[2]=b,a=min(c[1],c[3]),b=max(c[1],c[3]),c[1]=a,c[3]=b,a=min(c[1],c[4]),b=max(c[1],c[4]),c[1]=a,c[4]=b,a=min(c[1],c[5]),b=max(c[1],c[5]),c[1]=a,c[5]=b,a=min(c[1],c[6]),b=max(c[1],c[6]),c[1]=a,c[6]=b,a=min(c[1],c[7]),b=max(c[1],c[7]),c[1]=a,c[7]=b,a=min(c[1],c[8]),b=max(c[1],c[8]),c[1]=a,c[8]=b,a=min(c[2],c[3]),b=max(c[2],c[3]),c[2]=a,c[3]=b,a=min(c[2],c[4]),b=max(c[2],c[4]),c[2]=a,c[4]=b,a=min(c[2],c[5]),b=max(c[2],c[5]),c[2]=a,c[5]=b,a=min(c[2],c[6]),b=max(c[2],c[6]),c[2]=a,c[6]=b,a=min(c[2],c[7]),b=max(c[2],c[7]),c[2]=a,c[7]=b,a=min(c[2],c[8]),b=max(c[2],c[8]),c[2]=a,c[8]=b,a=min(c[3],c[4]),b=max(c[3],c[4]),c[3]=a,c[4]=b,a=min(c[3],c[5]),b=max(c[3],c[5]),c[3]=a,c[5]=b,a=min(c[3],c[6]),b=max(c[3],c[6]),c[3]=a,c[6]=b,a=min(c[3],c[7]),b=max(c[3],c[7]),c[3]=a,c[7]=b,a=min(c[3],c[8]),b=max(c[3],c[8]),c[3]=a,c[8]=b,a=min(c[4],c[5]),b=max(c[4],c[5]),c[4]=a,c[5]=b,a=min(c[4],c[6]),b=max(c[4],c[6]),c[4]=a,c[6]=b,a=min(c[4],c[7]),b=max(c[4],c[7]),c[4]=a,c[7]=b,a=min(c[4],c[8]),b=max(c[4],c[8]),c[4]=a,c[8]=b,gl_FragColor=vec4(c[4]*g,1.);}",
b:"u1 u36 u34 u33 u32 u35 u7".split(" "),precision:"lowp"},{id:"s47",name:"_",aa:"attribute vec2 a0;uniform vec4 u36;uniform vec2 u33,u34;uniform float u32,u35;varying vec2 vv0;void main(){gl_Position=vec4(a0,0.,1.);float a=u35*(u36.z/u36.w);a*=u34.x/u34.y;float b=cos(u32),c=sin(u32);vec2 f=mat2(b,-c*a,c/a,b)*a0,g=u33+f*u34,d=u36.xy+.5*u36.zw*g;vv0=vec2(d.x,1.-d.y);}",a:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vv0);}",b:"u1 u36 u34 u33 u32 u35".split(" "),precision:"lowp"},
{id:"s50",name:"_",aa:"attribute vec2 a0;uniform vec4 u36;varying vec2 vv0;void main(){gl_Position=vec4(a0,0.,1.);vec2 a=u36.xy+.5*u36.zw*a0;vv0=vec2(a.x,1.-a.y);}",a:"uniform sampler2D u1;uniform vec2 u7;varying vec2 vv0;const vec3 g=vec3(1.,1.,1.);float c[5];void main(){c[0]=texture2D(u1,vv0-u7*vec2(-1.,0.)).r,c[1]=texture2D(u1,vv0-u7*vec2(0.,-1.)).r,c[2]=texture2D(u1,vv0-u7).r,c[3]=texture2D(u1,vv0-u7*vec2(0.,1.)).r,c[4]=texture2D(u1,vv0-u7*vec2(1.,0.)).r;float a,b;a=min(c[0],c[1]),b=max(c[0],c[1]),c[0]=a,c[1]=b,a=min(c[0],c[2]),b=max(c[0],c[2]),c[0]=a,c[2]=b,a=min(c[0],c[3]),b=max(c[0],c[3]),c[0]=a,c[3]=b,a=min(c[0],c[4]),b=max(c[0],c[4]),c[0]=a,c[4]=b,a=min(c[1],c[2]),b=max(c[1],c[2]),c[1]=a,c[2]=b,a=min(c[1],c[3]),b=max(c[1],c[3]),c[1]=a,c[3]=b,a=min(c[1],c[4]),b=max(c[1],c[4]),c[1]=a,c[4]=b,a=min(c[2],c[3]),b=max(c[2],c[3]),c[2]=a,c[3]=b,a=min(c[2],c[4]),b=max(c[2],c[4]),c[2]=a,c[4]=b,gl_FragColor=vec4(c[2]*g,1.);}",
b:["u1","u36","u7"],precision:"lowp"},{id:"s49",name:"_",aa:"attribute vec2 a0;uniform vec2 u33,u34;varying vec2 vv0;const vec2 f=vec2(1.,1.);void main(){gl_Position=vec4(a0,0.,1.);vec2 a=u33+a0*u34,b=(a+f)/2.;vv0=b;}",a:"uniform sampler2D u1;uniform vec4 u36;varying vec2 vv0;void main(){vec2 b=u36.xy-.5*u36.zw,c=u36.xy+.5*u36.zw,a=step(b,vv0)*step(vv0,c);vec4 d=texture2D(u1,vec2(vv0.x,1.-vv0.y));gl_FragColor=mix(d,vec4(0.,1.,0.,1.),a.x*a.y*.5);}",b:["u1","u36","u34","u33"],precision:"lowp"}]);var b=
[{type:"1i",name:"u1",value:0}];x.C("s48",b);x.C("s47",b);x.C("s50",b);x.C("s49",b);ub()}function ub(){wa=0;x.C("s47",vb);x.C("s48",vb);ea.roll=0}function Pa(){t.aspectRatio=t.width/t.height;Fa.splice(0,Fa.length);Ua=0;t.$a=Math.round(t.width*na.margins);t.ab=Math.round(t.height*na.margins);t.lb=t.width-2*t.$a;t.kb=t.height-2*t.ab;for(var b=Math.min(t.width,t.height),c=0;c<na.nSweepSsteps;++c){var d=(na.sweepScaleRange[0]+c/(na.nSweepSsteps-1)*(na.sweepScaleRange[1]-na.sweepScaleRange[0]))*b,e=d/
t.width,k=e*t.aspectRatio,m=(t.lb-d)*(t.kb-d);m=Math.round(Math.sqrt(m/Math.min(Math.floor(m/(na.sweepStepMinPx*na.sweepStepMinPx)),na.nSweepXYsteps)));for(var l=Math.round((t.lb-d)/m),n=Math.round((t.kb-d)/m),p=0;p<n;++p){var r=t.ab+Math.round(d/2+m*p);r/=t.height;for(var h=0;h<l;++h){var u=t.$a+Math.round(d/2+m*h);u/=t.width;Fa.push([u,r,e,k])}}}na.sweepShuffle?Ib.gd(Fa):Fa.reverse()}function wb(b){F.X={isFlipY:!1,isLinear:!0,width:t.width,height:t.height,isPot:!1,isFloat:!1};F.type===Ba.Ra?Object.assign(F.X,
{isKeepArray:!0,array:b.arrayBuffer}):Object.assign(F.X,{s:b});F.D=S.instance(F.X);F.Mb=!0}function xb(b,c,d){if(!b.exportData||!b.exportData.labels)return c("INVALID_NN");var e=b.exportData;"undefined"===typeof e.paramsPerLabel&&(e.paramsPerLabel={});"undefined"!==typeof d&&d.paramsPerLabel&&(e.paramsPerLabel=Object.assign(e.paramsPerLabel,d.paramsPerLabel));ab.reset_state();Ca=new ob;Ca.ad(b.layers);Ca.cd({Sb:"cpuRGBA2Float",Uc:Gb});H.D=S.instance({isFloat:!1,isPot:!1,width:Ca.Dc()});O.S=e.dxysFactors?
e.dxysFactors:U.S;e.rollMax?(O.Vb=e.rollMax,O.fa=!0):O.fa=!1;e.pitchRange?(O.pitchRange=e.pitchRange,O.ya=!0):O.ya=!1;e.splitYawComponents&&(O.jb=!0);"undefined"!==typeof e.isYaw&&(O.Za=e.isYaw);O.width=Ca.Gc();b="undefined"===typeof d?{}:d;ib="undefined"===typeof b.notHereFactor?1:b.notHereFactor;b=e.labels;d="undefined"===typeof e.paramsPerLabel?!1:e.paramsPerLabel;var k="undefined"===typeof e.inputAspectRatio?1:e.inputAspectRatio,m=Math.sqrt(k);t.Z[0]=m;t.Z[1]=1/m;k!==t.wa&&(t.wa=k,Pa());k=Array(b.length);
for(m=0;m<O.width/8;++m)for(var l=0;l<O.width;++l){var n=l+m*O.width;if(n>=b.length)break;var p=l,r=8*m,h=b[n];k[n]={mb:d&&d[h]&&d[h].thresholdDetect?d[h].thresholdDetect:U.mb,label:h,vc:e.distances&&e.distances[n]?e.distances[n]:3,Ob:{here:p+r*O.width,notHere:p+(r+1)*O.width,yaw:p+(r+2)*O.width,dx:p+(r+3)*O.width,dy:p+(r+4)*O.width,ds:p+(r+5)*O.width,roll:p+(r+6)*O.width,pitch:p+(r+7)*O.width}}}xa=k;c(!1)}var Na={Od:function(b){return Math.ceil(Math.log2(b))},Pc:function(b){return Math.log2(b)},
ae:function(b){return 0===Math.log2(b)%1},sd:function(b){var c=[0,0,0,0];b.forEach(function(d){c[0]+=d[0];c[1]+=d[1];c[2]+=d[2];c[3]+=d[3]});return c},Oa:function(b,c,d){return Math.min(Math.max(b,c),d)},vd:function(b){return b*Math.PI/180},fe:function(b,c){c=Math.pow(10,c);return Math.round(b*c)/c},ge:function(b){return Math.round(1E6*b)/1E6},Pd:function(b,c){return(100*b/c).toFixed(3)},ce:function(b,c,d){return b*(1-d)+c*d},uc:function(b,c){return Na.nc(b-c)},nc:function(b){for(;b>Math.PI;)b-=2*
Math.PI;for(;b<=-Math.PI;)b+=2*Math.PI;return b},yd:function(b,c){return Math.abs(Na.uc(b,c))},nd:function(b,c){return Math.atan2(Math.sin(b)+Math.sin(c),Math.cos(b)+Math.cos(c))}},yb={get:function(b,c,d){var e=new XMLHttpRequest;e.open("GET",b,!0);e.withCredentials=!1;e.onreadystatechange=function(){4===e.readyState&&(200===e.status||0===e.status?c(e.responseText):"undefined"!==typeof d&&d(e.status))};e.send()},Ld:function(b,c){yb.get(b,function(d){c(JSON.parse(d))})},de:function(b,c,d){var e=new XMLHttpRequest;
e.open("POST",b,!0);e.setRequestHeader("Content-type","application/x-www-form-urlencoded");e.onreadystatechange=function(){4!==e.readyState||200!==e.status&&0!==e.status||d(e.responseText)};e.send(c)},Cd:function(b,c){var d=new XMLHttpRequest;d.open("POST",b,!0);d.responseType="arraybuffer";d.onload=function(){c(d.response)};d.send()}},Ib={create:function(b,c){for(var d=Array(c),e=0;e<c;++e)d[e]=b;return d},wd:function(b,c){for(var d=0;d<b.length;++d)c[d]=b[d]},clone:function(b){for(var c=Array(b.length),
d=0;d<b.length;++d)c[d]=b[d];return c},ie:function(b,c,d){b.forEach(function(e,k){c[k]=e*d})},gd:function(b){for(var c=b.length-1;0<c;--c){var d=Math.floor(Math.random()*(c+1)),e=b[c];b[c]=b[d];b[d]=e}}},Jb={Bc:function(b,c,d){switch(b){case "relu":return d+"=max(vec4(0.,0.,0.,0.),"+c+");";case "elu":return d+"=mix(exp(-abs("+c+"))-vec4(1.,1.,1.,1.),"+c+",step(0.,"+c+"));";case "elu01":return d+"=mix(0.1*exp(-abs("+c+"))-vec4(0.1,0.1,0.1,0.1),"+c+",step(0.,"+c+"));";case "arctan":return d+"=atan(3.14159265359*texture2D(u0,vUV))/3.14159265359;";
case "copy":return"";default:return!1}}},x=function(){function b(f,w){f=a.createShader(f);a.shaderSource(f,w);a.compileShader(f);return a.getShaderParameter(f,a.COMPILE_STATUS)?f:!1}function c(f,w){f=b(a.VERTEX_SHADER,f);w=b(a.FRAGMENT_SHADER,w);k.push(f,w);var A=a.createProgram();a.attachShader(A,f);a.attachShader(A,w);a.linkProgram(A);return A}function d(f){void 0===f.aa&&(f.aa="precision lowp float;attribute vec2 a0;varying vec2 vv0;void main(){gl_Position=vec4(a0,0.,1.),vv0=a0*.5+vec2(.5,.5);}");
void 0===f.sb&&(f.sb=["a0"]);void 0===f.Ma&&(f.Ma=[2]);if(void 0===f.precision||"highp"===f.precision)f.precision=r;f.id=n++;void 0!==f.$c&&f.$c.forEach(function(A,Y){f.a=f.a.replace(A,f.Ha[Y])});f.ob=0;f.Ma.forEach(function(A){f.ob+=4*A});f.ha=c(f.aa,"precision "+f.precision+" float;\n"+f.a);f.l={};f.b.forEach(function(A){f.l[A]=a.getUniformLocation(f.ha,A)});f.attributes={};f.ca=[];f.sb.forEach(function(A){var Y=a.getAttribLocation(f.ha,A);f.attributes[A]=Y;f.ca.push(Y)});if(f.f){a.useProgram(f.ha);
l=f;m=f.id;for(var w in f.f)a.uniform1i(f.l[w],f.f[w])}f.Xa=!0}function e(f){Ga.ed(G);m!==f.id&&(G.ma(),m=f.id,l=f,a.useProgram(f.ha),f.ca.forEach(function(w){0!==w&&a.enableVertexAttribArray(w)}))}var k=[],m=-1,l=null,n=0,p=!1,r="highp",h=["u1"],u=["u0"],y={u1:0},z={u0:0},P={u1:0,u2:1},N={u3:0},E={s0:{a:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vv0);}",b:h,f:y},s1:{a:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vv0);}",b:h,f:y,precision:"lowp"},
s2:{a:"uniform sampler2D u1,u2;varying vec2 vv0;void main(){vec4 a=texture2D(u2,vv0),b=texture2D(u1,vv0);gl_FragColor=a*b;}",b:["u1","u2"],f:P},s3:{a:"uniform sampler2D u1;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u1,vv0);gl_FragColor=a.r*f;}",b:h,f:y},s4:{a:"uniform sampler2D u1,u2;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u2,vv0),b=texture2D(u1,vv0);gl_FragColor=a.a*b.r*f;}",b:["u1","u2"],f:P},s5:{a:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vec2(1.-vv0.x,vv0.y));}",
b:h,f:y},s6:{a:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vec2(vv0.x,1.-vv0.y));}",b:h,f:y},s7:{a:"uniform sampler2D u0;uniform float u4;varying vec2 vv0;void main(){vec4 a=texture2D(u0,vv0);gl_FragColor=a*u4;}",b:["u0","u4"],f:z},s8:{a:"uniform sampler2D u0;uniform float u4;varying vec2 vv0;const vec4 f=vec4(.25,.25,.25,.25),g=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0);float b=dot(a*u4,f);gl_FragColor=b*g;}",b:["u0","u4"],f:z},s9:{a:"uniform sampler2D u1;varying vec2 vv0;const vec4 e=vec4(1.,1.,1.,1.);void main(){float a=.25*dot(e,texture2D(u1,vv0));gl_FragColor=a*e;}",
b:h,f:y},s10:{a:"uniform sampler2D u1,u5;uniform float u6;const vec4 f=vec4(1.,1.,1.,1.);varying vec2 vv0;void main(){vec4 a=texture2D(u1,vv0),b=texture2D(u5,vv0);gl_FragColor=mix(b,a,u6*f);}",b:["u1","u5","u6"],f:{u1:0,u5:1}},s11:{a:"uniform sampler2D u1;uniform vec2 u7;varying vec2 vv0;void main(){gl_FragColor=.25*(texture2D(u1,vv0+u7)+texture2D(u1,vv0+u7*vec2(1.,-1.))+texture2D(u1,vv0+u7*vec2(-1.,-1.))+texture2D(u1,vv0+u7*vec2(-1.,1.)));}",b:["u1","u7"],f:y},s12:{a:"uniform sampler2D u1;uniform vec4 u8;varying vec2 vv0;float g(float a,float b){a=floor(a)+.5;return floor(a/exp2(b));}float h(float a,float b){return floor(a*exp2(b)+.5);}float i(float a,float b){return mod(a,h(1.,b));}float e(float c,float a,float b){a=floor(a+.5),b=floor(b+.5);return i(g(c,a),b-a);}vec4 j(float a){if(a==0.)return vec4(0.,0.,0.,0.);float k=128.*step(a,0.);a=abs(a);float c=floor(log2(a)),l=c+127.,b=(a/exp2(c)-1.)*8388608.,d=l/2.,m=fract(d)*2.,n=floor(d),o=e(b,0.,8.),p=e(b,8.,16.),q=m*128.+e(b,16.,23.),r=k+n;return vec4(o,p,q,r)/255.;}void main(){float a=dot(texture2D(u1,vv0),u8);gl_FragColor=j(a);}",
b:["u1","u8"],f:y},s13:{a:"uniform sampler2D u0;varying vec2 vv0;const vec4 e=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),b=e/(e+exp(-a));gl_FragColor=b;}",b:u,f:z},s14:{a:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(0.,0.,0.,0.);void main(){vec4 a=texture2D(u0,vv0);gl_FragColor=max(f,a);}",b:u,f:z},s15:{a:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0);gl_FragColor=mix(exp(-abs(a))-f,a,step(0.,a));}",b:u,f:z},s16:{a:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),b=exp(-abs(a))-f;gl_FragColor=mix(.1*b,a,step(0.,a));}",
b:u,f:z},s17:{a:"uniform sampler2D u0,u6,u9;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),c=texture2D(u6,vv0),d=texture2D(u9,vv0),b=a/d;gl_FragColor=c*mix(exp(-abs(b))-f,b,step(0.,a));}",b:["u0","u6","u9"],f:{u0:0,u6:1,u9:2}},s18:{a:"uniform sampler2D u0;const float e=3.141593;varying vec2 vv0;void main(){gl_FragColor=atan(e*texture2D(u0,vv0))/e;}",b:u,f:z},s19:{a:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),b=log(f+a);gl_FragColor=b;}",
b:u,f:z},s20:{a:"uniform sampler2D u0,u10;uniform float u11;const vec2 e=vec2(.5,.5);const float f=1e-5;const vec4 g=vec4(1.,1.,1.,1.),i=vec4(0.,0.,0.,0.);varying vec2 vv0;void main(){vec4 a=texture2D(u10,e);float b=u11*u11;vec4 c=max(b*a,f*g);gl_FragColor=texture2D(u0,vv0)/c;}",b:["u0","u10","u11"],f:{u0:0,u10:1}},s21:{a:"uniform sampler2D u1;uniform vec2 u12;varying vec2 vv0;void main(){float a=u12.x*u12.y;vec2 b=floor(vv0*a)/a,c=fract(vv0*a),d=floor(b*u12.y),f=floor(u12.x*fract(b*u12.y)),g=(f*u12.y+d)/a;gl_FragColor=texture2D(u1,g+c/a);}",
b:["u1","u12"],f:y},s22:{a:"uniform sampler2D u13,u14,u15;varying vec2 vv0;void main(){vec4 a=texture2D(u15,vv0);vec2 b=a.rg,c=a.ba;vec4 d=texture2D(u13,b),f=texture2D(u14,c);gl_FragColor=d*f;}",b:["u13","u14","u15"],f:{u14:0,u13:1,u15:2}},s23:{a:"uniform float u16;uniform sampler2D u13,u14;varying vec2 vv0;void main(){vec2 a=fract(vv0*u16);vec4 b=texture2D(u13,vv0),c=texture2D(u14,a);gl_FragColor=b*c;}",b:["u14","u13","u16"],f:{u14:0,u13:1}},s24:{a:"uniform float u16;uniform sampler2D u13,u14,u17,u18,u19,u20;varying vec2 vv0;const vec4 e=vec4(1.,1.,1.,1.),g=vec4(1e-3,1e-3,1e-3,1e-3);void main(){vec2 h=vv0*u16,l=floor(h),c=h-l;vec4 m=texture2D(u13,vv0),d=texture2D(u14,c),a=texture2D(u20,vv0);a=a*255.;vec4 n=texture2D(u17,c),o=texture2D(u18,c),p=texture2D(u19,c),i=step(-g,-a),b=e-i,j=b*step(-e-g,-a);b*=e-j;vec4 k=b*step(-2.*e-g,-a);b*=e-k;vec4 q=b;d=i*d+j*n+k*o+q*p,gl_FragColor=m*d;}",
b:"u13 u14 u16 u20 u17 u18 u19".split(" "),f:{u14:0,u13:1,u20:3,u17:4,u18:5,u19:6}},s25:{a:"uniform sampler2D u13,u14,u21;uniform float u16,u22,u23,u24;varying vec2 vv0;const vec2 j=vec2(1.,1.);void main(){vec2 a=floor(u22*vv0),b=u22*vv0-a;float c=u16/u22;vec2 d=floor(b*c),f=b*c-d,g=(a+f)/u22;float k=u22*u24/u16;vec2 l=k*d,h=(l+f*u23)/u24,i=step(h,j);vec4 m=texture2D(u13,g),n=texture2D(u14,h),o=m*n*i.x*i.y,p=texture2D(u21,g);gl_FragColor=o*u23*u23+p;}",b:"u13 u14 u16 u22 u23 u24 u21".split(" "),f:{u14:0,
u13:1,u21:2}},s26:{a:"uniform sampler2D u13,u14;varying vec2 vv0;void main(){vec4 a=texture2D(u13,vv0),b=texture2D(u14,vv0);gl_FragColor=a*b;}",b:["u13","u14"],f:{u14:0,u13:1}},s27:{a:"uniform sampler2D u1,u21;uniform float u25;varying vec2 vv0;void main(){gl_FragColor=texture2D(u21,vv0)+u25*texture2D(u1,vv0);}",b:["u1","u21","u25"],f:{u1:0,u21:1}},s28:{a:"varying vec2 vv0;uniform sampler2D u1;const vec4 f=vec4(1.,1.,1.,1.),g=vec4(.299,.587,.114,0.);void main(){vec4 a=texture2D(u1,vv0);gl_FragColor=dot(a,g)*f;}",
b:h,f:y,precision:"lowp"},s29:{a:"varying vec2 vv0;uniform sampler2D u1;uniform float u26;const vec3 f=vec3(.299,.587,.114);void main(){vec3 a=texture2D(u1,vv0).rgb,b=texture2D(u1,vv0+vec2(0.,u26)).rgb,c=texture2D(u1,vv0+vec2(u26,u26)).rgb,d=texture2D(u1,vv0+vec2(u26,0.)).rgb;gl_FragColor=vec4(dot(a,f),dot(b,f),dot(c,f),dot(d,f));}",b:["u1","u26"],f:y,precision:"lowp"},s30:{a:"varying vec2 vv0;uniform sampler2D u1;uniform float u26;const vec3 f=vec3(.299,.587,.114);void main(){vec3 a=texture2D(u1,vv0).rgb,b=texture2D(u1,vv0+vec2(0.,u26)).rgb,c=texture2D(u1,vv0+vec2(u26,u26)).rgb,d=texture2D(u1,vv0+vec2(u26,0.)).rgb;gl_FragColor=vec4(a.r,b.g,c.b,dot(d,f));}",
b:["u1","u26"],f:y,precision:"lowp"},s31:{a:"varying vec2 vv0;uniform sampler2D u1,u2;uniform float u27;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=vec4(0.);a-=texture2D(u1,vec2(vv0.x-u27,vv0.y-u27))*1.,a-=texture2D(u1,vec2(vv0.x-u27,vv0.y))*2.,a-=texture2D(u1,vec2(vv0.x-u27,vv0.y+u27))*1.,a+=texture2D(u1,vec2(vv0.x+u27,vv0.y-u27))*1.,a+=texture2D(u1,vec2(vv0.x+u27,vv0.y))*2.,a+=texture2D(u1,vec2(vv0.x+u27,vv0.y+u27))*1.;vec4 b=vec4(0.);b-=texture2D(u1,vec2(vv0.x-u27,vv0.y-u27))*1.,b-=texture2D(u1,vec2(vv0.x,vv0.y-u27))*2.,b-=texture2D(u1,vec2(vv0.x+u27,vv0.y-u27))*1.,b+=texture2D(u1,vec2(vv0.x-u27,vv0.y+u27))*1.,b+=texture2D(u1,vec2(vv0.x,vv0.y+u27))*2.,b+=texture2D(u1,vec2(vv0.x+u27,vv0.y+u27))*1.;vec3 c=sqrt(a.rgb*a.rgb+b.rgb*b.rgb);vec4 e=vec4(c,texture2D(u1,vv0).a),g=texture2D(u2,vv0);gl_FragColor=g.a*e.r*f;}",
b:["u1","u2","u27"],f:P},s32:{a:"varying vec2 vv0;uniform sampler2D u1,u2;uniform float u27;const vec4 j=vec4(1.,1.,1.,1.);const vec2 k=vec2(1.,1.);void main(){float h=0.;vec2 l=k*u27,a,b;float c,d,i=0.;for(float e=-4.;e<=4.;e+=1.)for(float f=-4.;f<=4.;f+=1.)a=vec2(e,f),c=length(a)/2.,d=exp(-c*c),b=vv0+l*a,h+=d*texture2D(u1,b).r,i+=d;vec4 m=texture2D(u2,vv0);gl_FragColor=m.a*(texture2D(u1,b).r-h/i)*j;}",b:["u1","u2","u27"],f:P},s33:{a:"uniform sampler2D u3;uniform vec2 u7;varying vec2 vv0;vec4 e(vec4 a,vec4 b){vec4 c=step(a,b);return mix(a,b,c);}const vec2 g=vec2(.5,.5),h=vec2(1.,0.),i=vec2(0.,1.);void main(){vec2 a=vv0-u7*g;vec4 b=texture2D(u3,a),c=texture2D(u3,a+u7*h),d=texture2D(u3,a+u7*i),j=texture2D(u3,a+u7),k=e(b,c),l=e(d,j);gl_FragColor=e(k,l);}",
b:["u3","u7"],f:N},s34:{a:"uniform sampler2D u3;uniform vec2 u7;varying vec2 vv0;const vec2 k=vec2(1.,0.),l=vec2(0.,1.),m=vec2(2.,0.),n=vec2(0.,2.);vec4 e(vec4 a,vec4 b){vec4 c=step(a,b);return mix(a,b,c);}vec4 f(vec2 a){vec4 b=texture2D(u3,a),c=texture2D(u3,a+u7*k),d=texture2D(u3,a+u7*l),g=texture2D(u3,a+u7),h=e(b,c),i=e(d,g);return e(h,i);}void main(){vec2 a=vv0+u7*vec2(-.55,-1.05);vec4 b=f(a),c=f(a+u7*m),d=f(a+u7*2.),g=f(a+u7*n),h=e(b,c),i=e(d,g);gl_FragColor=e(h,i);}",b:["u3","u7"],f:N},s35:{a:"uniform sampler2D u1;varying vec2 vv0;void main(){vec4 a=texture2D(u1,vv0);gl_FragColor=a*a;}",
b:["u1"],f:y,precision:"lowp"},s36:{a:"uniform sampler2D u1;uniform vec2 u7;varying vec2 vv0;const float e=15444.;void main(){vec4 a=1001./e*texture2D(u1,vv0-3.*u7)+2002./e*texture2D(u1,vv0-2.*u7)+3003./e*texture2D(u1,vv0-u7)+3432./e*texture2D(u1,vv0)+3003./e*texture2D(u1,vv0+u7)+2002./e*texture2D(u1,vv0+2.*u7)+1001./e*texture2D(u1,vv0+3.*u7);gl_FragColor=a;}",b:["u7","u1"],f:y,precision:"lowp"},s37:{a:"uniform sampler2D u1,u28,u29;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);const float g=.1;void main(){vec4 a=texture2D(u28,vv0),b=texture2D(u29,vv0),c=texture2D(u1,vv0),d=max(f*g,b-a*a),h=sqrt(d);gl_FragColor=(c-a)/h;}",
b:["u1","u28","u29"],f:{u1:0,u28:1,u29:2}}},C={s38:{a:"uniform float u16,u30;uniform sampler2D u13,u14,u21;varying vec2 vv0;const vec2 ZERO2=vec2(0.,0.),ONE2=vec2(1.,1.),HALF2=vec2(.5,.5),EPS2=vec2(1e-5,1e-5);void main(){vec4 sum=texture2D(u21,vv0);float toSparsity=1.1111;vec2 uvFrom,uvWeight,xyPatch=ZERO2,eps2=EPS2/u16,xyTo=floor(vv0*u16+eps2);float weightSize=toSparsity*u16;vec2 halfFromSparsity=ONE2*(toSparsity-1.)/2.;for(float patch_x=0.;patch_x<1.1111;patch_x+=1.){xyPatch.x=patch_x;for(float patch_y=0.;patch_y<1.1111;patch_y+=1.)xyPatch.y=patch_y,uvFrom=(xyTo+HALF2+u30*(xyPatch-halfFromSparsity))/u16,uvFrom+=step(uvFrom,-eps2),uvFrom-=step(ONE2-eps2,uvFrom),uvWeight=(xyTo*toSparsity+xyPatch+HALF2)/weightSize,sum+=texture2D(u13,uvWeight)*texture2D(u14,uvFrom);}gl_FragColor=sum,gl_FragColor*=2.2222;}",
b:["u16","u13","u14","u21","u30"],Ha:["1.1111","gl_FragColor\\*=2.2222;"]},s39:{a:"uniform float u16,u30,u24;uniform sampler2D u13,u14,u21;varying vec2 vv0;const vec2 ZERO2=vec2(0.,0.),ONE2=vec2(1.,1.),HALF2=vec2(.5,.5),EPS2=vec2(1e-4,1e-4);void main(){vec4 sum=texture2D(u21,vv0);float fromSparsity=1.1111,shrinkFactor=3.3333;vec2 uvFrom,uvWeight,xyFrom,xyPatchTo,xyPatch=ZERO2,xyShrink=ZERO2,eps2=EPS2/u24,xyTo=floor(vv0*u16+eps2);float weightSize=fromSparsity*u24;vec2 halfFromSparsity=ONE2*(fromSparsity-1.)/2.;float toSparsity=weightSize/u16;vec2 xyFrom0=xyTo*shrinkFactor;for(float patch_x=0.;patch_x<1.1111;patch_x+=1.){xyPatch.x=patch_x;for(float patch_y=0.;patch_y<1.1111;patch_y+=1.){xyPatch.y=patch_y;for(float shrink_x=0.;shrink_x<3.3333;shrink_x+=1.){xyShrink.x=shrink_x;for(float shrink_y=0.;shrink_y<3.3333;shrink_y+=1.)xyShrink.y=shrink_y,xyFrom=xyFrom0+xyShrink+shrinkFactor*u30*(xyPatch-halfFromSparsity),uvFrom=(xyFrom+HALF2)/u24,uvFrom+=step(uvFrom,-eps2),uvFrom-=step(ONE2-eps2,uvFrom),xyPatchTo=xyPatch*shrinkFactor+xyShrink,uvWeight=(xyTo*toSparsity+xyPatchTo+HALF2)/weightSize,sum+=texture2D(u13,uvWeight)*texture2D(u14,uvFrom);}}}gl_FragColor=sum,gl_FragColor*=2.2222;}",
b:"u16 u24 u13 u14 u21 u30".split(" "),Ha:["1.1111","gl_FragColor\\*=2.2222;","3.3333"]}},G={za:function(){return p},o:function(){if(!p){r="highp";for(var f in E)d(E[f],f);x.set("s0");a.enableVertexAttribArray(0);p=!0;return Wa.o()}},dc:function(f){f.forEach(function(w){G.rb(w)})},rb:function(f){E[f.id]=f;d(f,f.id)},Ib:function(f,w,A){w||(w=f);E[w]=Object.create(C[f]);E[w].Lc=!0;C[f].Ha&&C[f].Ha.forEach(function(Y,la){E[w].a=E[w].a.replace(new RegExp(Y,"g"),A[la])});d(E[w],w)},set:function(f){e(E[f])},
zc:function(f){return"undefined"===typeof E[f]?!1:E[f].Xa},ma:function(){-1!==m&&(m=-1,l.ca.forEach(function(f){0!==f&&a.disableVertexAttribArray(f)}))},hb:function(){var f=0;l.ca.forEach(function(w,A){A=l.Ma[A];a.vertexAttribPointer(w,A,a.FLOAT,!1,l.ob,f);f+=4*A})},Bd:function(){a.enableVertexAttribArray(0)},ib:function(){a.vertexAttribPointer(l.ca[0],2,a.FLOAT,!1,8,0)},ke:function(f,w){a.uniform1i(l.l[f],w)},J:function(f,w){a.uniform1f(l.l[f],w)},ia:function(f,w,A){a.uniform2f(l.l[f],w,A)},le:function(f,
w){a.uniform2fv(l.l[f],w)},oe:function(f,w){a.uniform3fv(l.l[f],w)},me:function(f,w,A,Y){a.uniform3f(l.l[f],w,A,Y)},pe:function(f,w,A,Y,la){a.uniform4f(l.l[f],w,A,Y,la)},ja:function(f,w){a.uniform4fv(l.l[f],w)},qe:function(f,w){a.uniformMatrix2fv(l.l[f],!1,w)},re:function(f,w){a.uniformMatrix3fv(l.l[f],!1,w)},se:function(f,w){a.uniformMatrix4fv(l.l[f],!1,w)},C:function(f,w){G.set(f);w.forEach(function(A){switch(A.type){case "4f":a.uniform4fv(l.l[A.name],A.value);break;case "3f":a.uniform3fv(l.l[A.name],
A.value);break;case "2f":a.uniform2fv(l.l[A.name],A.value);break;case "1f":a.uniform1f(l.l[A.name],A.value);break;case "1i":a.uniform1i(l.l[A.name],A.value);break;case "mat2":a.uniformMatrix2fv(l.l[A.name],!1,A.value);break;case "mat3":a.uniformMatrix3fv(l.l[A.name],!1,A.value);break;case "mat4":a.uniformMatrix4fv(l.l[A.name],!1,A.value)}})},Nd:function(){return"lowp"},j:function(){a.disableVertexAttribArray(0);G.ma();for(var f in E){var w=E[f];w.Xa&&(w.Xa=!1,a.deleteProgram(w.ha));w.Lc&&delete E[f]}k.forEach(function(A){a.deleteShader(A)});
k.splice(0);n=0;p=!1}};return G}(),a=null,Ha=function(){function b(h){console.log("ERROR in ContextFeedForward: ",h);return!1}function c(){if(navigator.userAgent&&-1!==navigator.userAgent.indexOf("forceWebGL1")||/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream)return!0;if(/(Mac)/i.test(navigator.platform)){var h;(h=navigator.userAgent)?(h=h.match(/Mac OS X (\d+)_(\d+)/)||h.match(/Mac OS X (\d+).(\d+)/),h=!h||3>h.length?!1:[parseInt(h[1],10),parseInt(h[2],10)]):h=!1;if(h&&10===h[0]&&
15===h[1])return!0}return!1}var d=null,e=null,k=null,m=null,l=!0,n=null,p=null,r={B:function(){return d.width},N:function(){return d.height},Fd:function(){return d},Ed:function(){return a},F:function(){return l},flush:function(){a.flush()},Cc:function(){n||(n=new Uint8Array(d.width*d.height*4));a.readPixels(0,0,d.width,d.height,a.RGBA,a.UNSIGNED_BYTE,n);return n},Hd:function(){return d.toDataURL("image/jpeg")},Id:function(){ya.G();e||(e=document.createElement("canvas"),k=e.getContext("2d"));e.width=
d.width;e.height=d.height;for(var h=r.Cc(),u=k.createImageData(e.width,e.height),y=e.width,z=e.height,P=u.data,N=0;N<z;++N)for(var E=z-N-1,C=0;C<y;++C){var G=4*(N*y+C),f=4*(E*y+C);P[G]=h[f];P[G+1]=h[f+1];P[G+2]=h[f+2];P[G+3]=h[f+3]}k.putImageData(u,0,0);return e.toDataURL("image/png")},Gd:function(h){!e&&h&&(e=document.createElement("canvas"),k=e.getContext("2d"));var u=h?e:document.createElement("canvas");u.width=d.width;u.height=d.height;(h?k:u.getContext("2d")).drawImage(d,0,0);return u},o:function(h){h.qc&&
!h.Pa?d=document.getElementById(h.qc):h.Pa&&(d=h.Pa);d||(d=document.createElement("canvas"));d.width=h&&void 0!==h.width?h.width:512;d.height=h&&void 0!==h.height?h.height:512;"undefined"===typeof h&&(h={});void 0===h.premultipliedAlpha&&(h.premultipliedAlpha=!1);void 0===h.Lb&&(h.Lb=!0);void 0===h.antialias&&(h.antialias=!1);if(!a){var u={antialias:h.antialias,alpha:!0,preserveDrawingBuffer:!0,premultipliedAlpha:h.premultipliedAlpha,stencil:!1,depth:h.Lb};navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("noAntialiasing")&&
(u.antialias=!1);c()||(a=d.getContext("webgl2",u));a?l=!0:((a=d.getContext("webgl",u))||(a=d.getContext("experimental-webgl",u)),l=!1)}if(!a)return b("WebGL1 and 2 are not enabled");(m=a.getExtension("WEBGL_lose_context"))&&h.Rb&&(p=h.Rb,d.addEventListener("webglcontextlost",p,!1));if(!Z.o())return b("Not enough capabilities");if(!Z.kc()&&l)return b("Your configuration cannot process color buffer float");a.clearColor(0,0,0,0);a.disable(a.DEPTH_TEST);a.disable(a.BLEND);a.disable(a.DITHER);a.disable(a.STENCIL_TEST);
a.disable(a.SCISSOR_TEST);a.GENERATE_MIPMAP_HINT&&a.hint(a.GENERATE_MIPMAP_HINT,a.FASTEST);a.disable(a.SAMPLE_ALPHA_TO_COVERAGE);a.disable(a.SAMPLE_COVERAGE);return!0},Jc:function(){if(!x.o())return!1;a.depthFunc(a.LEQUAL);a.clearDepth(1);return!0},j:function(){a&&Z.j();m&&p&&(d.removeEventListener("webglcontextlost",p,!1),p=null);n=k=e=d=null}};return r}(),Ga=function(){var b="undefined"===typeof x?null:x;return{ed:function(c){b!==c&&(b&&b.ma(),b=c)},za:function(){return b.za()},ib:function(){b.ib()},
hb:function(){b.hb()},ma:function(){b.ma()},set:function(c){b.set(c)},j:function(){b.j&&b.j()}}}(),ja=function(){var b=null,c=null,d=0,e=-2,k=-2,m=!1,l=[],n={reset:function(){k=e=-2},o:function(){m||(b=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,b),a.bufferData(a.ARRAY_BUFFER,new Float32Array([-1,-1,3,-1,-1,3]),a.STATIC_DRAW),c=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,c),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2]),a.STATIC_DRAW),n.Na(),m=!0)},instance:function(p){var r=
d++,h=p.U?p.U.length:0,u="undefined"===typeof p.mode?a.STATIC_DRAW:p.mode,y=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,y);a.bufferData(a.ARRAY_BUFFER,p.bc instanceof Float32Array?p.bc:new Float32Array(p.bc),u);e=r;var z=null,P=null,N=null;if(p.U){z=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,z);var E=null;65536>p.U.length?(E=Uint16Array,P=a.UNSIGNED_SHORT,N=2):(E=Uint32Array,P=a.UNSIGNED_INT,N=4);a.bufferData(a.ELEMENT_ARRAY_BUFFER,p.U instanceof E?p.U:new E(p.U),u);k=r}var C={jc:function(G){e!==
r&&(a.bindBuffer(a.ARRAY_BUFFER,y),e=r);G&&Ga.hb()},fc:function(){k!==r&&(a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,z),k=r)},bind:function(G){C.jc(G);C.fc()},zd:function(){a.drawElements(a.TRIANGLES,h,P,0)},Ad:function(G,f){a.drawElements(a.TRIANGLES,G,P,f*N)},remove:function(){a.deleteBuffer(y);p.U&&a.deleteBuffer(z);C=null}};l.push(C);return C},Na:function(){-1!==e&&(a.bindBuffer(a.ARRAY_BUFFER,b),e=-1);-1!==k&&(a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,c),k=-1)},i:function(p,r){p&&ja.Na();r&&Ga.ib();a.drawElements(a.TRIANGLES,
3,a.UNSIGNED_SHORT,0)},Eb:function(){a.deleteBuffer(b);a.deleteBuffer(c)},j:function(){n.Eb();l.forEach(function(p){p.remove()});a.bindBuffer(a.ARRAY_BUFFER,null);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,null);n.reset();m=!1;l.splice(0);d=0}};return n}(),W=function(){var b=null,c=null,d=null,e=!1,k=[],m={u:-2,Bb:1},l={za:function(){return e},o:function(){if(!e){b=a.createFramebuffer();var n=Z.F();c=n&&a.DRAW_FRAMEBUFFER?a.DRAW_FRAMEBUFFER:a.FRAMEBUFFER;d=n&&a.READ_FRAMEBUFFER?a.READ_FRAMEBUFFER:a.FRAMEBUFFER;
e=!0}},Kd:function(){return c},Ta:function(){return d},T:function(){return a.FRAMEBUFFER},Qd:function(){return m},Dd:function(){return b},instance:function(n){void 0===n.Kb&&(n.Kb=!1);var p=n.D?n.D:null,r=n.width,h=void 0!==n.height?n.height:n.width,u=b,y=null,z=!1,P=!1,N=0;p&&(r=r?r:p.B(),h=h?h:p.N());var E={Xb:function(){z||(u=a.createFramebuffer(),z=!0,N=m.Bb++)},cc:function(){E.Xb();E.m();y=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,y);a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,
r,h);a.framebufferRenderbuffer(c,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,y);a.clearDepth(1)},bind:function(C,G){N!==m.u&&(a.bindFramebuffer(c,u),m.u=N);p&&p.m();G&&a.viewport(0,0,r,h);C&&a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT)},pd:function(){N!==m.u&&(a.bindFramebuffer(c,u),m.u=N)},clear:function(){a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT)},td:function(){a.clear(a.COLOR_BUFFER_BIT)},ud:function(){a.clear(a.DEPTH_BUFFER_BIT)},fd:function(){a.viewport(0,0,r,h)},m:function(){N!==m.u&&(a.bindFramebuffer(c,
u),m.u=N)},rtt:function(C){p=C;m.u!==N&&(a.bindFramebuffer(a.FRAMEBUFFER,u),m.u=N);C.m()},G:function(){a.bindFramebuffer(c,null);m.u=-1},resize:function(C,G){r=C;h=G;y&&(a.bindRenderbuffer(a.RENDERBUFFER,y),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,r,h))},remove:function(){u===b||P||(a.bindFramebuffer(c,u),a.framebufferTexture2D(c,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,null,0),y&&a.framebufferRenderbuffer(c,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,null),a.bindFramebuffer(c,null),a.deleteFramebuffer(u),
y&&a.deleteRenderbuffer(y));P=!0}};n.Kb&&E.cc();k.push(E);return E},G:function(){a.bindFramebuffer(c,null);m.u=-1},kd:function(){a.bindFramebuffer(c,null);a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT);a.viewport(0,0,Z.B(),Z.N());m.u=-1},reset:function(){m.u=-2},M:function(){0!==m.u&&(a.bindFramebuffer(c,b),m.u=0)},clear:function(){a.viewport(0,0,Z.B(),Z.N());a.clear(a.COLOR_BUFFER_BIT)},j:function(){l.G();k.forEach(function(n){n.remove()});a.deleteFramebuffer(b);l.reset();e=!1;k.splice(0);m.u=-2;
m.Bb=1}};return l}(),La=function(){function b(q){a.bindTexture(a.TEXTURE_2D,q)}function c(q){ka[0]=q;q=aa[0];var D=q>>16&32768,g=q>>12&2047,I=q>>23&255;return 103>I?D:142<I?D|31744|((255==I?0:1)&&q&8388607):113>I?(g|=2048,D|(g>>114-I)+(g>>113-I&1)):D=(D|I-112<<10|g>>1)+(g&1)}function d(q){var D=new Uint16Array(q.length);q.forEach(function(g,I){D[I]=c(g)});return D}function e(){if(null!==ma.Va)return ma.Va;var q=m(d([1,1,1,1]));return null===q?!0:ma.Va=q}function k(){if(null!==ma.Wa)return ma.Wa;var q=
m(new Uint8Array([255,255,255,255]));return null===q?!0:ma.Wa=q}function m(q){if(!Ga.za()||!N)return null;var D=null;try{var g=a.getError();D=B.instance({isFloat:!1,H:!0,array:q,width:1});g=a.getError();if(g!==a.NO_ERROR)return!1}catch(I){return!1}W.G();a.viewport(0,0,1,1);a.clearColor(0,0,0,0);a.clear(a.COLOR_BUFFER_BIT);Ga.set("s0");D.tb(0);ja.i(!1,!0);q=new Uint8Array(4);a.readPixels(0,0,1,1,a.RGBA,a.UNSIGNED_BYTE,q);q=.9<q[0];D.remove();W.M();return q}var l=0,n=null,p=0,r=null,h=null,u=null,y=
null,z=null,P=null,N=!1,E=[],C={isFloat:!1,isPot:!0,isLinear:!1,isMipmap:!1,isAnisotropicFiltering:!1,isMirrorX:!1,isMirrorY:!1,isSrgb:!1,isKeepArray:!1,isFlipY:null,width:0,height:0,url:null,array:null,data:null,s:null,Kc:!1,H:!1,R:null,Ba:4,bb:0},G=!1,f=null,w=null,A=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],Y=!1,la=!1,ka=new Float32Array(1),aa=new Int32Array(ka.buffer),ma={Va:null,Wa:null},B={o:function(){if(!N){z=[a.RGB,!1,a.RGB,a.RGBA];P=[a.RGB,!1,a.RGB,a.RGBA];n=[a.TEXTURE0,a.TEXTURE1,a.TEXTURE2,
a.TEXTURE3,a.TEXTURE4,a.TEXTURE5,a.TEXTURE6,a.TEXTURE7];Y="undefined"!==typeof JEContext;la="undefined"!==typeof Z;Y&&JEContext.be()&&n.push(a.TEXTURE8,a.TEXTURE9);r=[-1,-1,-1,-1,-1,-1,-1,-1];y=[a.UNSIGNED_BYTE,a.FLOAT,a.FLOAT];if(!h){for(var q=new Float32Array(16384),D=0;16384>D;++D)q[D]=2*Math.random()-1;h={random:B.instance({isFloat:!0,isPot:!0,array:q,width:64}),$b:B.instance({isFloat:!1,isPot:!0,width:1,array:new Uint8Array([0,0,0,0])})}}N=!0}},Ic:function(){B.md()},Ud:function(){return h.$b},
md:function(){y[1]=Z.va()},bd:function(){P=z=[a.RGBA,a.RGBA,a.RGBA,a.RGBA]},ee:function(q,D){x.set("s1");W.G();var g=q.B(),I=q.N();a.viewport(0,0,g,I);q.c(0);ja.i(!1,!1);a.readPixels(0,0,g,I,a.RGBA,a.UNSIGNED_BYTE,D)},Cb:function(q,D,g,I,oa){a.activeTexture(a.TEXTURE0);var sa=a.createTexture();b(sa);var pa=Z.F()&&a.RGBA32F?a.RGBA32F:a.FLOAT;I=I instanceof Float32Array?I:new Float32Array(I);0!==Na.Pc(I.length)%1&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE));a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,oa);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,D,g,0,a.RGBA,pa,I);b(null);a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1);W.M();x.set("s0");a.viewport(0,0,D,g);a.framebufferTexture2D(W.T(),a.COLOR_ATTACHMENT0,a.TEXTURE_2D,q,0);a.clearColor(0,0,0,0);a.clear(a.COLOR_BUFFER_BIT);b(sa);ja.i(!0,!1);a.deleteTexture(sa);r[0]=-1;u=
null;l=0},instance:function(q){function D(){b(qa);ta&&a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,ta);g.isPot?(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,g.isMirrorX?a.MIRRORED_REPEAT:a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,g.isMirrorY?a.MIRRORED_REPEAT:a.REPEAT)):(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE));g.isAnisotropicFiltering&&"undefined"!==typeof JESETTINGS&&a.texParameterf(a.TEXTURE_2D,JEContext.Jd().TEXTURE_MAX_ANISOTROPY_EXT,
JESETTINGS.od);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,g.isLinear?a.LINEAR:a.NEAREST);g.isLinear?a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,g.isMipmap&&!Ia?a.NEAREST_MIPMAP_LINEAR:a.LINEAR):a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,g.isMipmap&&!Ia?a.NEAREST_MIPMAP_NEAREST:a.NEAREST);ca=z[g.Ba-1];fa=P[g.Ba-1];ha=y[oa];if(Z.F()){var v=a.RGBA32F;ca===a.RGBA&&ha===a.FLOAT&&v&&(fa=v);ca===a.RGB&&ha===a.FLOAT&&v&&(fa=v,ca=a.RGBA)}if(g.H&&!g.isFloat||g.isFloat&&g.isMipmap&&Wa.Oc())(v=
a.RGBA16F)&&(fa=v),ha=Z.va();g.bb&&(bb=g.bb);g.isSrgb&&4===g.Ba&&(ca=JEContext.Sd());if(g.s)a.texImage2D(a.TEXTURE_2D,0,fa,ca,ha,g.s);else if(g.url)a.texImage2D(a.TEXTURE_2D,0,fa,ca,ha,Da);else if(ua){try{a.getError(),a.texImage2D(a.TEXTURE_2D,0,fa,J,L,0,ca,ha,ua),a.getError()!==a.NO_ERROR&&(a.texImage2D(a.TEXTURE_2D,0,fa,J,L,0,ca,ha,null),a.getError()!==a.NO_ERROR&&a.texImage2D(a.TEXTURE_2D,0,a.RGBA,J,L,0,a.RGBA,a.UNSIGNED_BYTE,null))}catch(Ub){a.texImage2D(a.TEXTURE_2D,0,fa,J,L,0,ca,ha,null)}g.isKeepArray||
(ua=null)}else a.texImage2D(a.TEXTURE_2D,0,fa,J,L,0,ca,ha,null);if(g.isMipmap)if(!Ia&&T)T.Sa(),cb=!0;else if(Ia){v=Math.log(Math.min(J,L))/Math.log(2);Qa=Array(1+v);Qa[0]=qa;for(var M=1;M<=v;++M){var ba=Math.pow(2,M),Q=J/ba;ba=L/ba;var Ja=a.createTexture();b(Ja);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texImage2D(a.TEXTURE_2D,0,fa,Q,ba,0,ca,ha,null);b(null);Qa[M]=Ja}cb=!0}b(null);r[l]=-1;ta&&a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,
!1);db=!0;g.R&&T&&(g.R(T),g.R=null)}var g=Object.assign({},C,q),I=p++;null===g.isFlipY&&(g.isFlipY=g.url||g.array?!0:!1);g.data&&(g.array="string"===typeof g.data?Eb(g.data):g.isFloat?new Float32Array(g.data):new Uint8Array(g.data),g.isFlipY=!1);var oa=0,sa=g.s?!0:!1,pa=null,Ra=null,zb=!1,lb=null;g.H=g.H||g.isFloat;g.H&&(oa=1);g.Kc||Z.F()||!g.isFloat||!la||Z.vb()||(g.isFloat=!1);g.isFloat&&(oa=2);g.isAnisotropicFiltering&&Y&&!JEContext.Wd()&&(g.isAnisotropicFiltering=!1);var qa=a.createTexture(),
Da=null,ua=!1,J=0,L=0,db=!1,eb=!1,va=null,za=null,mb=null,Xa=null,fa=null,ca=null,ha=null,ta=g.isFlipY,Ia=g.H&&g.isMipmap&&"undefined"!==typeof Wa&&!Wa.mc()?!0:!1,Qa=null,bb=-1,cb=!1,Ka={Nb:!1,ub:null,Db:null};g.width&&(J=g.width,L=g.height?g.height:J);var T={get:function(){return qa},B:function(){return J},N:function(){return L},Vd:function(){return g.url},Xd:function(){return g.isFloat},Zd:function(){return g.H},$d:function(){return g.isLinear},Sa:function(){a.generateMipmap(a.TEXTURE_2D)},ic:function(v,
M){Ia?(v||(v=T.Gb()),T.La(M),b(Qa[v]),r[M]=-1):T.c(M)},Gb:function(){-1===bb&&(bb=Math.log(J)/Math.log(2));return bb},Ac:function(v){if(Ia){v||(v=T.Gb());x.set("s11");T.La(0);for(var M=J,ba=L,Q=1;Q<=v;++Q)M/=2,ba/=2,x.ia("u7",.25/M,.25/ba),a.viewport(0,0,M,ba),b(Qa[Q-1]),a.framebufferTexture2D(W.T(),a.COLOR_ATTACHMENT0,a.TEXTURE_2D,Qa[Q],0),ja.i(!1,1===Q);r[0]=-1}else T.Sa()},La:function(v){v!==l&&(a.activeTexture(n[v]),l=v)},c:function(v){if(!db)return!1;T.La(v);if(r[v]===I)return!1;b(qa);r[v]=I;
return!0},tb:function(v){a.activeTexture(n[v]);l=v;b(qa);r[v]=I},m:function(){u=T;a.framebufferTexture2D(W.T(),a.COLOR_ATTACHMENT0,a.TEXTURE_2D,qa,0)},W:function(){u=T;a.viewport(0,0,J,L);a.framebufferTexture2D(W.T(),a.COLOR_ATTACHMENT0,a.TEXTURE_2D,qa,0)},nb:B.nb,resize:function(v,M){J=v;L=M;D()},clone:function(v){v=B.instance({width:J,height:L,H:g.H,isFloat:g.isFloat,isLinear:g.isLinear,isMirrorY:g.isMirrorY,isFlipY:v?!ta:ta,isPot:g.isPot});Ga.set("s0");W.M();v.m();a.viewport(0,0,J,L);T.c(0);ja.i(!0,
!0);return v},fd:function(){a.viewport(0,0,J,L)},remove:function(){a.deleteTexture(qa);E.splice(E.indexOf(T),1);T=null},refresh:function(){T.tb(0);ta&&a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!0);sa?a.texImage2D(a.TEXTURE_2D,0,fa,ca,a.UNSIGNED_BYTE,g.s):a.texImage2D(a.TEXTURE_2D,0,fa,J,L,0,ca,ha,ua);ta&&a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1)},xb:function(){var v=J*L*4;za=[new Uint8Array(v),new Uint8Array(v),new Uint8Array(v),new Uint8Array(v)];va=[new Float32Array(za[0].buffer),new Float32Array(za[1].buffer),
new Float32Array(za[2].buffer),new Float32Array(za[3].buffer)];mb=new Uint8Array(4*v);Xa=new Float32Array(mb.buffer);eb=!0},Ub:function(){eb||T.xb();a.readPixels(0,0,J,4*L,a.RGBA,a.UNSIGNED_BYTE,mb);for(var v=J*L,M=2*v,ba=3*v,Q=0;Q<v;++Q)va[0][Q]=Xa[Q],va[1][Q]=Xa[Q+v],va[2][Q]=Xa[Q+M],va[3][Q]=Xa[Q+ba];return va},Yc:function(){Ka.Nb||(Ka.ub=new Uint8Array(J*L*4),Ka.Db=new Float32Array(Ka.buffer),Ka.Nb=!0);a.readPixels(0,0,J,L,a.RGBA,a.UNSIGNED_BYTE,Ka.ub);return Ka.Db},yb:function(v){W.G();x.set("s12");
T.c(0);if(v)a.viewport(0,0,J,L),x.ja("u8",.25,.25,.25,.25),ja.i(!1,!0);else for(v=0;4>v;++v)a.viewport(0,L*v,J,L),x.ja("u8",A[v]),ja.i(!1,0===v)},ac:function(v){var M=ha===y[0]&&!k();b(qa);ta&&a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!0);M?(zb||(pa=document.createElement("canvas"),pa.width=J,pa.height=L,Ra=pa.getContext("2d"),lb=Ra.createImageData(J,L),zb=!0),lb.data.set(v),Ra.putImageData(lb,0,0),a.texImage2D(a.TEXTURE_2D,0,fa,ca,ha,pa)):a.texImage2D(a.TEXTURE_2D,0,fa,J,L,0,ca,ha,v);r[l]=I;ta&&a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,
!1)},ue:function(v,M){b(qa);M&&a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!0);a.texImage2D(a.TEXTURE_2D,0,fa,ca,ha,v);r[l]=I;M&&a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1)},je:function(v,M){var ba=J*L,Q=4*ba;v=g.H?v?"RGBE":"JSON":"RGBA";M&&(v=M);M=Z.F()&&!1;var Ja=null;switch(v){case "RGBE":Ja="s40";break;case "JSON":Ja=M?"s0":"s12";break;case "RGBA":case "RGBAARRAY":Ja="s6"}eb||("RGBA"===v||"RGBE"===v||"RGBAARRAY"===v?(za=new Uint8Array(Q),eb=!0):"JSON"!==v||M||T.xb());W.G();x.set(Ja);T.c(0);Q=null;if("RGBA"===
v||"RGBE"===v||"RGBAARRAY"===v){a.viewport(0,0,J,L);ja.i(!0,!0);a.readPixels(0,0,J,L,a.RGBA,a.UNSIGNED_BYTE,za);if("RGBAARRAY"===v)return{data:za};G||(f=document.createElement("canvas"),w=f.getContext("2d"),G=!0);f.width=J;f.height=L;ba=w.createImageData(J,L);ba.data.set(za);w.putImageData(ba,0,0);Q=f.toDataURL("image/png")}else if("JSON"===v)if(M)Q=new Float32Array(ba),a.viewport(0,0,J,L),ja.i(!0,!0),a.readPixels(0,0,J,L,a.RGBA,a.FLOAT,Q);else{for(Q=0;4>Q;++Q)a.viewport(0,L*Q,J,L),x.ja("u8",A[Q]),
ja.i(!Q,!Q);T.Ub();Q=Array(ba);for(M=0;M<ba;++M)Q[4*M]=va[0][M],Q[4*M+1]=va[1][M],Q[4*M+2]=va[2][M],Q[4*M+3]=va[3][M]}return{format:v,data:Q,width:J,height:L,isMirrorY:g.isMirrorY,isFlipY:"RGBA"===v?g.isFlipY:!g.isFlipY}}};g.isMipmap&&!Ia&&db&&!cb&&(T.Sa(),cb=!0);if(g.url)b(qa),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,1,1,0,a.RGBA,a.UNSIGNED_BYTE,null),Da=new Image,Da.xd="Anonymous",Da.crossOrigin="Anonymous",Da.src=g.url,Da.onload=function(){J=Da.width;L=Da.height;D()};else if(g.s){var Ab=function(){J=
void 0!==g.s.videoWidth?g.s.videoWidth:g.s.width;L=void 0!==g.s.videoHeight?g.s.videoHeight:g.s.height;J?D():setTimeout(Ab,1)};Ab()}else g.array?(g.H&&!g.isFloat?g.array instanceof Uint16Array?(ua=g.array,D()):e()?(ua=d(g.array),D()):(D(),B.Cb(qa,T.B(),T.N(),g.array,ta)):(ua=g.isFloat?g.array instanceof Float32Array?g.array:new Float32Array(g.array):g.array instanceof Uint8Array?g.array:new Uint8Array(g.array),D()),g.isKeepArray||(ua&&ua!==g.array&&(ua=null),delete g.array)):D();T.Rd=T.B;g.R&&db&&
(g.R(T),g.R=null);E.push(T);return T},G:function(q){q!==l&&(a.activeTexture(n[q]),l=q);r[q]=-1;b(null)},qd:function(q){h.random.c(q)},nb:function(){u=null;a.framebufferTexture2D(W.T(),a.COLOR_ATTACHMENT0,a.TEXTURE_2D,null,0)},reset:function(){for(var q=0;q<n.length;++q)r[q]=-1;l=-1},he:function(){l=-1},jd:function(){for(var q=0;q<n.length;++q)B.G(q)},Eb:function(){h&&(h.random.remove(),h.$b.remove())},te:function(q,D){if("RGBA"===q.format||"RGBE"===q.format){var g=new Image;g.src=q.data;g.onload=
function(){B.instance({isMirrorY:q.isMirrorY,isFlipY:q.isFlipY,isFloat:!1,s:g,R:function(I){if("RGBA"===q.format)D(I);else{var oa=q.width,sa=q.height,pa=B.instance({isMirrorY:q.isMirrorY,isFloat:!0,width:oa,height:sa,isFlipY:q.isFlipY});W.M();a.viewport(0,0,oa,sa);x.set("s41");pa.m();I.c(0);ja.i(!0,!0);B.G(0);D(pa);a.flush();setTimeout(I.remove,50)}}})}}else"JSON"===q.format?D(B.instance({isFloat:!0,isFlipY:q.isFlipY,width:q.width,height:q.height,array:new Float32Array(q.data)})):D(!1)},j:function(){u&&
(ya.M(),B.nb(),ya.G());B.jd();E.slice(0).forEach(function(q){q.remove()});E.splice(0);N=!1;p=0;Wa.j()}};return B}(),Z=function(){function b(){c="undefined"===typeof Ha?JEContext:Ha;d=!0}var c=null,d=!1,e=!1,k=null,m=null,l=!1,n=null,p=!1,r=null,h=!1,u=null,y=!1,z=!0,P=!0,N=!0,E=null,C="undefined"===typeof window?{}:window,G={o:function(){if(d)return!0;b();G.Ab();G.Qa();G.xc();G.yc();W.o();La.o();if(!G.rc())return!1;ja.o();La.Ic();return!0},B:function(){d||b();return c.B()},N:function(){d||b();return c.N()},
F:function(){d||b();return c.F()},xc:function(){y=(u=a.getExtension("EXT_color_buffer_float")||a.getExtension("WEBGL_color_buffer_float")||a.getExtension("OES_color_buffer_float"))?!0:!1;C.GL_EXT_COLORBUFFERFLOAT=u},yc:function(){a.getExtension("EXT_color_buffer_half_float")||a.getExtension("WEBGL_color_buffer_half_float")||a.getExtension("OES_color_buffer_half_float")},Ab:function(){if(!e){k=a.getExtension("OES_texture_float")||a.getExtension("MOZ_OES_texture_float")||a.getExtension("WEBKIT_OES_texture_float");
if((l=(C.GL_EXT_FLOAT=k)?!0:!1)||this.F())m=a.getExtension("OES_texture_float_linear")||a.getExtension("MOZ_OES_texture_float_linear")||a.getExtension("WEBKIT_OES_texture_float_linear"),C.GL_EXT_FLOATLINEAR=m;e=!0}},Qa:function(){if(!h){if(n=a.getExtension("OES_texture_half_float")||a.getExtension("MOZ_OES_texture_half_float")||a.getExtension("WEBKIT_OES_texture_half_float"))E=n.HALF_FLOAT_OES,p=!0;!E&&a.HALF_FLOAT&&(E=a.HALF_FLOAT);!E&&a.FLOAT&&(E=a.FLOAT);C.GL_EXT_HALFFLOAT=n;if(p||this.F())r=a.getExtension("OES_texture_half_float_linear")||
a.getExtension("MOZ_OES_texture_half_float_linear")||a.getExtension("WEBKIT_OES_texture_half_float_linear"),C.GL_EXT_HALFFLOATLINEAR=r;h=!0}},va:function(){G.Qa();return E},vb:function(){return z},lc:function(){return P},rd:function(){return N},kc:function(){return y},tc:function(){P=z=!0;var f=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,f);var w=a.createTexture();a.bindTexture(a.TEXTURE_2D,w);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,
a.NEAREST);a.texImage2D(a.TEXTURE_2D,0,G.F()&&a.RGBA32F?a.RGBA32F:a.RGBA,1,1,0,a.RGBA,a.FLOAT,null);a.framebufferTexture2D(W.T(),a.COLOR_ATTACHMENT0,a.TEXTURE_2D,w,0);var A=a.checkFramebufferStatus(W.Ta());A!==a.FRAMEBUFFER_COMPLETE&&(z=!1);a.texImage2D(a.TEXTURE_2D,0,G.F()&&a.RGBA16F?a.RGBA16F:a.RGBA,1,1,0,a.RGBA,G.va(),null);a.framebufferTexture2D(W.T(),a.COLOR_ATTACHMENT0,a.TEXTURE_2D,w,0);A=a.checkFramebufferStatus(W.Ta());A!==a.FRAMEBUFFER_COMPLETE&&(P=!1);a.bindTexture(a.TEXTURE_2D,null);a.bindFramebuffer(a.FRAMEBUFFER,
null);a.deleteTexture(w);a.deleteFramebuffer(f)},sc:function(){var f=W.instance({width:1});f.Xb();var w=La.instance({width:1,isFloat:!0,Ba:3});f.m();w.m();a.flush();a.checkFramebufferStatus(W.Ta())!==a.FRAMEBUFFER_COMPLETE?(La.bd(),N=!1):N=!0;f.remove();w.remove()},rc:function(){G.tc();if(!z&&!P)return!1;G.sc();return!0},j:function(){La.j();Ga.j();W.j();ja.j();d=!1}};return G}(),V=ja,ya=W,S=La,Wa=function(){function b(z,P,N,E){a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,E?a.NEAREST_MIPMAP_NEAREST:
a.LINEAR);var C=null;if(null!==N)try{if(C=a.getError(),C!==a.NO_ERROR&&console.log("GLERR in test_mipmapping():",C),a.texImage2D(a.TEXTURE_2D,0,z,2,2,0,a.RGBA,P,N),C=a.getError(),C!==a.NO_ERROR)return!1}catch(G){return!1}E&&a.generateMipmap(a.TEXTURE_2D);V.Na();V.i(!1,!0);C=a.getError();if("FUCKING_BIG_ERROR"===C)return!1;a.readPixels(0,0,1,1,a.RGBA,a.UNSIGNED_BYTE,l);C=a.getError();C===a.INVALID_OPERATION&&"undefined"!==typeof a.PIXEL_PACK_BUFFER&&(a.bindBuffer(a.PIXEL_PACK_BUFFER,null),a.readPixels(0,
0,1,1,a.RGBA,a.UNSIGNED_BYTE,l),C=a.getError());return C!==a.NO_ERROR?!1:0!==l[0]}function c(z){return Z.vb()&&b(h,a.FLOAT,new Float32Array(p),z)?(m=k.qb,!0):!1}function d(z,P){if(!Z.lc())return!1;if(b(u,Z.va(),new Uint16Array(p),z)||b(u,a.FLOAT,new Float32Array(p),z))return m=k.pa,!0;a.bindTexture(a.TEXTURE_2D,P);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,1,1,0,a.RGBA,a.UNSIGNED_BYTE,null);La.Cb(P,1,1,new Float32Array(p),!1);a.bindTexture(a.TEXTURE_2D,P);return b(u,null,null,z)?(m=k.pa,!0):!1}var e=!1,k=
{qb:3,pa:2,RGBA8:0},m=k.RGBA8,l=new Uint8Array(4),n=[.8,1,.8,1],p=n.concat(n,n,n),r=!0,h=null,u=null,y={o:function(){Z.Ab();Z.Qa();u=h=a.RGBA;if(Ha.F()){var z=a.RGBA32F;z&&(h=z);(z=a.RGBA16F)&&(u=z)}V.o();ya.reset();ya.G();a.viewport(0,0,1,1);x.set("s0");e=!0;z=a.createTexture();a.activeTexture(a.TEXTURE0);a.bindTexture(a.TEXTURE_2D,z);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);
if(d(!0,z)||c(!0))return!0;r=!1;if(d(!1,z)||c(!1))return!0;if(Ha.F()){u=h=a.RGBA;if(d(!0)||c(!0))return!0;r=!1;if(d(!1)||c(!1))return!0}return!1},mc:function(){return r},Md:function(){return m},Yd:function(){e||y.o();return m===k.qb},Oc:function(){e||y.o();return m===k.pa},j:function(){e=!1;m=k.RGBA8;r=!0}};return y}(),Kb=function(){return{instance:function(b){var c=S.instance(b.alpha),d=S.instance(b.beta);return{wc:function(){c.c(1);d.c(2)}}}}}(),Cb=function(){return{instance:function(b){var c=null,
d=!1,e=!1,k=null,m=!1,l=!1,n=null,p="undefined"===typeof b.preprocessing?!1:b.preprocessing,r="undefined"===typeof b.preprocessingSize?b.size:b.preprocessingSize;b.mask&&(d=!0,SETTINGS&&void 0!==SETTINGS.ec&&(b.mask=SETTINGS.ec+b.mask),c=S.instance({isFloat:!1,url:b.mask}));var h=!1;b.customInputShader&&(h="s42",x.rb({name:"_",id:h,a:b.customInputShader,b:["uSource"],precision:"lowp"}),x.C(h,[{type:"1i",name:"_",value:0}]));switch(p){case "sobel":n="s31";m=!0;break;case "meanNormalization":n="s32";
m=!0;break;case "grayScale":n="s28";m=!1;break;case "grayScaleTilt":n="s29";l=!0;m=!1;break;case "rgbGrayTilt":n="s30";l=!0;m=!1;break;case "copy":n=h?h:"s0";break;case "inputLightRegulation":n=h?h:"s28";k=Lb.instance({Jb:r,Tb:b.size,Pb:b.nBlurPass,Nc:!1});e=!0;break;case "direct":case "none":n=!1;break;default:n="s3"}l&&x.C(n,[{name:"u26",type:"1f",value:b.tilt}]);d&&(n+="Mask");var u=S.instance({isFloat:!1,isPot:!1,width:b.size}),y={B:function(){return r},Ua:function(){return y.B()},Fc:function(){return e?
k.Hb():u},I:function(){ya.M();n&&(x.set(n),m&&x.J("u27",1/b.size),u.W(),d&&c.c(1),V.i(!1,!1),u.c(0),e&&k.process(u))},j:function(){u.remove();d&&c.remove()}};return y}}}(),Db=function(){return{instance:function(b){"undefined"===typeof b.disableNormalize&&(b.disableNormalize=!1);var c={input:null,Y:null,Ya:null,L:null,Fa:null,fb:null,gb:null},d=null,e=[],k=[],m=!1,l=null,n=!0,p=-1,r=b.isReorganize?b.isReorganize:!1,h=b.kernelsNumber?!0:!1,u=b.dynPelu?Kb.instance(b.dynPelu):!1,y=u?!0:!1,z={isEnabled:!1};
b.Mc?(b.sparsity="undefined"!==typeof b.sparsity?b.sparsity:b.Ga.Ua(),n=!1):"full"===b.connectivityUp&&(b.sparsity=b.Ga.Ua());var P={elu:"s15",elu01:"s16",relu:"s14",arctan:"s18",sigmoid:"s13",copy:"s0",softplus:"s19",dynPelu:"s17"}[b.activation],N=b.sparsity*b.sparsity,E=!1,C=b.size,G="";if(b.maxPooling){switch(b.maxPooling.size){case 2:G="s33";break;case 4:G="s34"}E=!0;C/=b.maxPooling.size;c.fb=S.instance({isFloat:!0,isPot:!1,width:C})}var f=void 0!==b.Tc&&b.Tc?!0:!1,w=null,A=null,Y=null;if(f){w=
"s43"+b.index.toString();x.Ib("s43",w,[((b.normalization.n-1)/2).toFixed(1)]);x.C(w,[{type:"1i",name:"u1",value:0},{type:"2f",name:"u7",value:[1/b.size,1/b.size]},{type:"1f",name:"u6",value:b.normalization.alpha},{type:"1f",name:"u9",value:b.normalization.beta},{type:"1f",name:"u31",value:b.normalization.k}]);var la={isFloat:!0,isPot:!0,width:b.size};A=S.instance(la);Y=S.instance(la)}var ka=-1,aa=null;n&&(c.L=S.instance({isFloat:!0,isPot:!1,width:b.size}));c.Y=S.instance(b.bias);var ma={B:function(){return b.size},
Ua:function(){return C},Fb:function(){return b.classesCount},hc:function(B){d.c(B)},Wc:function(){b.remap&&b.remap.isEnabled&&(z={isEnabled:!0,Qc:S.instance({isFloat:!1,isFlipY:!1,array:new Uint8Array(b.remap.maskTexture.data),width:b.remap.maskTexture.width,isPot:!1}),layers:b.remap.layers.map(function(B){return b.parent.Ec(B)}),depth:b.remap.depth})},dd:function(){switch(b.connectivityUp){case "direct":aa=Mb.instance(b.connectivity);break;case "square":aa=Nb.instance(b.connectivity);break;case "squareFast":aa=
Ob.instance(b.connectivity,b.activation);break;case "full":aa=Pb.instance(b.connectivity);break;case "conv":p=b.kernelsNumber,aa=Qb.instance(b.connectivity),r&&(c.Fa=S.instance({width:C,isFloat:!0,isFlipY:!1,isPot:!1}))}if(aa.$){var B=b.size*b.sparsity;ka=Math.log(B/b.size)/Math.log(2);c.input=S.instance({isMipmap:!0,isFloat:!0,isPot:!0,width:B,bb:ka});c.Ya=S.instance({isFloat:!0,isPot:!0,width:b.size})}},I:function(B){d=B;aa.$?(c.input.W(),h&&c.Y.c(2),aa.I(z),c.input.c(0),c.input.Ac(ka),c.Ya.W(),
h?x.set("s0"):(x.set("s27"),x.J("u25",N),c.Y.c(1)),c.input.ic(ka,0),V.i(!1,!1),x.set(P),f?A.m():c.L.m(),c.Ya.c(0),y&&u.wc(),V.i(!1,!1)):(c.L.W(),c.Y.c(1),aa.I());f&&(x.set(w),Y.m(),A.c(0),V.i(!1,!1),x.set("s44"),x.J("u6",1),c.L.m(),Y.c(1),V.i(!1,!1));if(n)return E?(c.fb.W(),c.L.c(0),x.set(G),x.ia("u7",1/b.size,1/b.size),V.i(!1,!1),B=c.fb):B=c.L,B.c(0),r&&(c.Fa.m(),x.set("s21"),x.ia("u12",p,C/p),V.i(!1,!1),B=c.Fa,c.Fa.c(0)),B;B=c.L;b.disableNormalize||(x.set("gpuRawAvg"===m?"s8":"s7"),x.J("u4",1/b.size),
c.gb.W(),c.L.c(0),V.i(!1,!1),B=c.gb);switch(m){case "cpuRGBA2Float":B.yb(!1);B=ma.Xc(B);l(B);break;case "cpuMeanFloat":B.yb(!0);B=B.Yc();l(B);break;case "gpuRawAvg":case "gpuRaw":B.c(0);case "none":l(B)}return!1},pc:function(B){B&&"undefined"!==typeof B.Sb&&(m=B.Sb,l=B.Uc);c.L=S.instance({isFloat:!0,isPot:!0,isMipmap:!1,width:b.size});B="undefined"!==typeof b.classesCount&&b.classesCount?b.classesCount:b.size*b.size;for(var q=0,D=0,g=0;q<B;++q)e.push(D+(b.size-1-g)*b.size),k.push([-1,-1,-1,-1]),++D,
D===b.size&&(D=0,++g);b.disableNormalize||(c.gb=S.instance({isFloat:!0,isPot:!0,width:b.size}))},Xc:function(B){var q=B.Ub();e.forEach(function(D,g){k[g][0]=q[0][D];k[g][1]=q[1][D];k[g][2]=q[2][D];k[g][3]=q[3][D]});return k},j:function(){for(var B in c){var q=c[B];q&&q.remove()}aa&&(aa.j(),aa=null)}};b.Ga&&ma.dd(b.Ga);return ma}}}();ob.zb=function(b){b.forEach(function(c){c.oc&&S.zb(c.oc.ve);c.Y&&S.zb(c.Y)})};var Mb=function(){return{instance:function(b){var c=S.instance(b.weights);delete b.weights.data;
return{$:!0,ua:function(){return 1},j:function(){c.remove()},Hc:function(){return c},I:function(){x.set("s26");c.c(1);V.i(!1,!1)}}}}}(),Pb=function(){return{instance:function(b){var c=b.fromLayerSize,d=S.instance(b.weights);delete b.weights.data;return{$:!0,ua:function(){return c},j:function(){d.remove()},I:function(e){if(e.isEnabled){x.set("s24");e.Qc.c(3);var k,m=Math.min(e.layers.length,e.depth);for(k=0;k<m;++k)e.layers[k].hc(4+k)}else x.set("s23");x.J("u16",b.toLayerSize);d.c(1);V.i(!1,!1)}}}}}(),
Nb=function(){return{instance:function(b){for(var c=b.fromLayerSize,d=b.toLayerSize,e=b.toSparsity,k=e*d,m=k/c,l=c/d,n=0,p=0,r=0,h=Array(e*d*e*d*4),u=Array(e*d*e*d*4),y=Array(c*c),z=0;z<y.length;++z)y[z]=0;z=Math.floor(e/2);for(var P=.5/d,N=.5/c,E=.5/k,C=0;C<d;++C)for(var G=Math.round(C*l),f=0;f<d;++f){var w=Math.round(f*l),A=C/d,Y=f/d;A+=P;Y+=P;for(var la=0;la<e;++la){var ka=G+la-z;0>ka&&(ka+=c);ka>=c&&(ka-=c);for(var aa=0;aa<e;++aa){var ma=n/k,B=p/k,q=w+aa-z;0>q&&(q+=c);q>=c&&(q-=c);var D=ka/c,
g=q/c;B=1-B-1/k;D+=N;g+=N;ma+=E;B+=E;var I=C*e+la,oa=f*e+aa;oa=d*e-oa-1;I=oa*d*e+I;h[4*I]=ma;h[4*I+1]=B;h[4*I+2]=D;h[4*I+3]=g;g=y[q*c+ka]++;I=g%m;D=ka*m+I;q=q*m+(g-I)/m;q=c*m-1-q;q=q*c*m+D;u[4*q]=ma;u[4*q+1]=B;u[4*q+2]=A;u[4*q+3]=Y;++n>=k&&(n=0,++p);++r}}}y=null;var sa=S.instance(b.weights);delete b.weights.data;var pa=S.instance({width:k,isFloat:!0,array:new Float32Array(u),isPot:!0});u=null;var Ra=S.instance({width:k,isFloat:!0,array:new Float32Array(h),isPot:!0});h=null;return{$:!0,ua:function(){return m},
j:function(){pa.remove();Ra.remove();sa.remove()},I:function(){x.set("s22");sa.c(1);Ra.c(2);V.i(!1,!1)}}}}}(),Qb=function(){return{instance:function(b){var c=b.kernelsNumber,d=b.toSparsity,e=d*b.toLayerSize/b.fromLayerSize,k=S.instance(b.weights);delete b.weights.data;return{$:!0,ua:function(){return e},Td:function(){return d},Hc:function(){return k},j:function(){k.remove()},I:function(){x.set("s25");x.J("u22",c);x.J("u23",d);x.J("u16",b.toLayerSize);x.J("u24",b.fromLayerSize);k.c(1);V.i(!1,!1)}}}}}(),
Ob=function(){return{instance:function(b,c){var d=b.fromLayerSize,e=b.toLayerSize,k=b.toSparsity,m=b.stride?b.stride:1,l=k*e/d,n=e<d,p=d/e,r=S.instance(b.weights);delete b.weights.data;var h="s45"+[d.toString(),e.toString(),k.toString(),m.toString(),c].join("_");x.zc(h)||(b=Jb.Bc(c,"gl_FragColor","gl_FragColor"),e=[{type:"1f",name:"u16",value:e},{type:"1f",name:"u30",value:m}],n&&e.push({type:"1f",name:"u24",value:d}),d=[(n?l:k).toFixed(1),b],n&&d.push(p.toFixed(1)),x.Ib(n?"s39":"s38",h,d),x.C(h,
e.concat([{type:"1i",name:"u14",value:0},{type:"1i",name:"u21",value:1},{type:"1i",name:"u13",value:3}])));return{$:!1,ua:function(){return l},j:function(){r.remove()},I:function(){x.set(h);r.c(3);V.i(!1,!1)}}}}}(),Lb=function(){return{instance:function(b){var c=b.Pb?b.Pb:3,d=b.Jb?b.Jb:64,e=b.Tb?b.Tb:64,k=b.Nc?!0:!1;b={isFloat:!1,width:d,isPot:!1,isFlipY:!1};var m=S.instance(b),l=S.instance(b),n=S.instance(b),p=S.instance(b),r=S.instance({isFloat:!0,width:e,isPot:!1,isFlipY:!1}),h=1/d;return{process:function(u){x.set("s35");
p.m();V.i(k,!1);x.set("s36");for(var y=0;y<c;++y)m.m(),x.ia("u7",h,0),V.i(k,!1),n.m(),p.c(0),V.i(k,!1),l.m(),m.c(0),x.ia("u7",0,h),V.i(k,!1),p.m(),n.c(0),V.i(k,!1),y!==c-1&&l.c(0);x.set("s37");r.m();u.c(0);l.c(1);p.c(2);V.i(k,!1);r.c(0)},Hb:function(){return r}}}}}(),nb=function(){var b={n:5,cb:1,ta:[30,45],k:.7,ld:200,Vc:.05},c,d=0,e=-1,k=-1,m=0,l=-1,n={level:-1,o:function(p){c=Object.assign({},b,p);l=n.level=c.cb},hd:function(p){p=p||0;var r=Math.min(Math.max(p-d,2),200);d=p;var h=-1===e?0:c.k;
e=Math.min(Math.max(1E3/r,5),120)*(1-h)+e*h;p-k>c.ld&&5<++m&&(r=c.k,l=l*(1-r)+(e<c.ta[0]?n.level-1:e>c.ta[1]?n.level+1:n.level)*r,Math.abs(l-n.level)>1-c.Vc&&(r=Math.min(Math.max(Math.round(l),0),c.n-1),r!==n.level&&(l=n.level=r,e=(c.ta[1]-c.ta[0])/2)),k=p)},reset:function(){k=e=-1;m=0}};return n}(),U={qa:512,S:[.05,.05,.15],Zc:{margins:.1,nSweepXYsteps:36,nSweepSsteps:4,sweepScaleRange:[.3,.7],sweepStepMinPx:16,sweepShuffle:!0},Wb:[1/15,.9],Rc:3,mb:.68,Ea:10,Aa:.03,V:8,Ia:-.02,ra:.02,ka:.7,Ca:20,
sa:.3,la:[.02,10],Da:[1,6],Sc:3},na=Object.create(U.Zc),jb=0,sb=0,kb=!1,O={width:-1,Za:!0,fa:!1,ya:!1,Vb:null,jb:!1,pitchRange:null,S:U.S},Ca=null,ra=null,Sa=!1,Ma=!1,wa=0,Ta=null,t=null,Rb={aspectRatio:1,wa:1,Z:[1,1],width:0,height:0,P:0,O:0,$a:0,ab:0,lb:0,kb:0,ea:"s47",A:{da:[0,0],scale:[1,1]}},Fa=[],Ua=0,H={D:null,g:[0,0,0,0]},X={oa:-2,LOADING:-1,ba:0,Ka:1,pb:2,na:3},ia=X.oa,Ya=-2,xa=null;var tb=Za=0;var Va=-1;var R={n:0,Qb:0,eb:0,v:-1,K:[0,0]},Ba={undefined:0,video:1,wb:2,Ra:3},F=null,Sb={current:0,
element:null,D:null,Mb:!1,type:Ba.undefined,time:-1,X:null},Bb=!1,ea={distance:0,label:!1,positionScale:[0,0,0,0],detectScore:0,yaw:0,pitch:0,roll:0},ib=1,Tb={cutShader:null,thresholdDetectFactor:1,thresholdDetectFactorUnstitch:1,isSkipConfirmation:!1,isKeepTracking:!1,trackingFactors:[2,2,2],secondNeighborFactor:U.ka,nLocateAutomoves:U.Ea,locateMoveNoiseAmplitude:U.Aa,nConfirmAutoMoves:U.V,nConfirmUnstitchMoves:U.Ca,confirmMoveNoiseAmplitude:U.ra,thresholdConfirmOffset:U.Ia,tiltPosAngleIfAmbiguousDetection:U.la,
confirmScoreMinFactorDuringAutoMove:U.sa},da={},K={Ja:1,Yb:1,ga:!1,xa:!1,Zb:null,ka:U.ka,Ea:-1,Aa:-1,V:-1,Ia:-1,ra:-1,Ca:-1,la:null,sa:-1},vb=[{type:"1f",name:"u32",value:0}],ab={VERSION:"1.1.2",init:function(b){function c(d){b.callbackReady&&b.callbackReady(d)}if(ia!==X.oa)return c("ALREADY_INITIALIZED");ia=X.LOADING;t=Object.assign({},Rb);F=Object.assign({},Sb);if("undefined"!==typeof b.canvas)ra=b.canvas,Sa=!1;else if("undefined"===typeof b.canvasId)ra=document.createElement("canvas"),Sa=!1;else{ra=
document.getElementById(b.canvasId);if(!ra)return c("INVALID_CANVASID"),!1;Sa=!0}"undefined"!==typeof b.isDebugRender&&(Sa=b.isDebugRender);Sa&&(ra.style.display="block");b.scanSettings&&Object.assign(na,b.scanSettings);b.canvasSize&&(U.qa=b.canvasSize);nb.o({n:U.Da[1]-U.Da[0]+1,cb:U.Sc-U.Da[0]});Ma="undefined"===typeof b.followZRot?!1:b.followZRot;Ta="undefined"===typeof b.ZRotRange?null:b.ZRotRange;Bb="undefined"!==typeof WorkerGlobalScope&&"undefined"!==typeof self&&self instanceof WorkerGlobalScope;
-1!==U.qa&&(ra.width=U.qa,ra.height=U.qa);ab.set_source(b.video,b.videoCrop);if(!Ha.o({Pa:ra,width:ra.width,height:ra.height,debug:!1,Rb:c.bind(null,"GLCONTEXT_LOST"),premultipliedAlpha:!1})||!Ha.Jc())return c("GL_INCOMPATIBLE"),!1;0===F.current&&(wb(F.element),Pa());Hb();gb();ia=X.ba;c(!1);return!0},set_source:function(b,c){"undefined"!==typeof b&&b?(F.element=b,F.current=0,F.element.isFakeVideo?(t.P=F.element.videoWidth,t.O=F.element.videoHeight,F.type=Ba.Ra):"VIDEO"===b.tagName?(t.P=F.element.videoWidth,
t.O=F.element.videoHeight,F.type=Ba.video):(t.P=F.element.width,t.O=F.element.height,F.type=Ba.wb),pb(c)):F.current=1;-1===[X.oa,X.LOADING].indexOf(ia)&&(F.X&&F.X.s&&(F.X.s=b),Pa(),gb(),F.type===Ba.wb&&F.D.refresh())},set_NN:function(b,c,d){if(1===Ya)c&&c("NN_LOADING");else{var e=function(k){Ya=0;c&&c(k)};Ya=1;"string"===typeof b?yb.get(b,function(k){if(!k)return e("INVALID_NN");var m=null;try{m=JSON.parse(k)}catch(l){return e("INVALID_NN")}xb(m,e,d)},function(){e("NOTFOUND_NN")}):xb(b,e,d)}},reset_state:function(){ub();
Ua=0;ia=X.ba},destroy:function(){ab.reset_state();Ca&&Ca.j();Ha.j();Ya=-2;ia=X.oa;return Promise.resolve()},detect:function(b,c,d){if(ia===X.LOADING||0!==Ya)return ea;Object.assign(da,Tb,d?d:{});K.Ja=da.thresholdDetectFactor;K.Yb=da.thresholdDetectFactorUnstitch;K.ga=da.isSkipConfirmation;K.xa=da.isKeepTracking;K.Zb=da.trackingFactors;K.ka=da.secondNeighborFactor;K.Ea=da.nLocateAutomoves;K.Aa=da.locateMoveNoiseAmplitude;K.V=da.nConfirmAutoMoves;K.Ia=da.thresholdConfirmOffset;K.ra=da.confirmMoveNoiseAmplitude;
K.Ca=da.nConfirmUnstitchMoves;K.la=da.tiltPosAngleIfAmbiguousDetection;K.sa=da.confirmScoreMinFactorDuringAutoMove;ya.M();ea.label=!1;switch(F.current){case 0:F.type===Ba.video&&F.time!==F.element.currentTime?(F.D.refresh(),F.time=F.element.currentTime):F.type===Ba.Ra&&F.element.needsUpdate&&(F.D.ac(F.element.arrayBuffer),F.element.needsUpdate=!1);switch(da.cutShader){case "median":t.ea="s48";break;default:t.ea="s47"}break;case 1:if(!F.Mb){t.width=c.size.width;t.height=c.size.height;switch(da.cutShader){case "IOS":t.ea=
"s50";x.C("s50",[{name:"u7",type:"2f",value:[1/t.width,1/t.height]}]);break;default:t.ea="s47"}wb(null);Pa()}F.D.ac(c.buffer)}b||(b=nb.level+U.Da[0],nb.hd(Date.now()));for(c=0;c<b;++c)H.D.W(),x.set(t.ea),Ma&&O.fa&&x.J("u32",ia===X.na?wa:0),F.D.c(0),x.ja("u36",H.g),V.i(!1,!1),H.D.c(0),kb=c===b-1,Ca.I(!1,H.D),ya.M();ya.kd();Sa&&(a.viewport(0,0,ra.width,ra.height),x.set("s49"),F.D.c(0),x.ja("u36",H.g),V.i(!1,!1),Bb&&a.commit?a.commit():a.flush());return ea},get_aspectRatio:function(){return t.width/
t.height},set_scanSettings:function(b){Object.assign(na,b);Pa()},set_videoCrop:function(b){pb(b);gb();Pa()}};return ab}();
;return WEBARROCKSOBJECT||window.WEBARROCKSOBJECT;})();