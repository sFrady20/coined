/**
 * Copyright (c) 2020 WebAR.rocks ( https://webar.rocks )
 * 
 * You cannot reproduce, sublicense, distribute or sell this software or part of this software without an explicit (and written) authorization of WebAR.rocks.
 * 
 * You should be granted by a written agreement by WebAR.rocks to use this software for an explicit period of time (e.g. yearly).
 * This agreement should list the domain(s) where this software can be hosted. Each subdomain is considered as a separate domain. A 301 or 302 HTTP direction to an authorized domain is authorized too.
 * 
 * You cannot use this software or part of this software for other purpose than rigid head accessories virtual try-on.
 * 
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. 
 * 
*/

var WEBARROCKSOBJECT=(function(){window.WEBARROCKSOBJECT=function(){function Cb(a){var c=null,d=null,e=null,r=0;this.o=function(t){this.ud(t.Ha);e.Hc({wb:t.wb,tb:t.tb})};this.Wc=function(t){return c[t]};this.ud=function(t){var u=null;r=t.length;c=t.map(function(p,f){p=Object.assign({},p,{index:f,parent:this,Pa:u,dd:f===r-1});return u=f=0===f?Db.instance(p):Eb.instance(p)});d=c[0];e=c[r-1];c.forEach(function(p,f){0!==f&&p.pd()})};this.I=function(t,u){var p=u;c.forEach(function(f){p=f.I(p,t)});return p};this.Vc=function(){return d.B()};this.Zc=
function(){return e.B()};this.$b=function(){return e.Yc()};this.Yb=function(){return e.Yb()};this.j=function(){c&&(c.forEach(function(t){t.j()}),e=d=c=null,r=0)};"undefined"!==typeof a&&this.o(a)}var Wa;function db(a,c){var d=c%8;return a[(c-d)/8]>>7-d&1}function Fb(a){var c=JSON.parse(a);a=c.ne;var d=c.nf,e=c.n;var r="undefined"===typeof btoa?Buffer.from(c.data,"base64").toString("latin1"):atob(c.data);var t=r.length;c=new Uint8Array(t);for(var u=0;u<t;++u)c[u]=r.charCodeAt(u);r=new Float32Array(e);
t=new Float32Array(d);u=a+d+1;for(var p=0;p<e;++p){for(var f=u*p,v=0===db(c,f)?1:-1,z=f+1,m=1,x=0,g=z+a-1;g>=z;--g)x+=m*db(c,g),m*=2;z=x;f=f+1+a;m=t.length;x=0;for(g=f;g<f+m;++g)t[x]=db(c,g,!0),++x;for(m=f=0;m<d;++m)f+=t[m]*Math.pow(2,-m-1);r[p]=0===f&&0===z?0:v*(1+f)*Math.pow(2,1+z-Math.pow(2,a-1))}return r}function nb(a){if(a){var c=a.w,d=a.h;D.A.ja[0]=-1+2*(a.x+c/2)/D.Y;D.A.ja[1]=-1+2*(a.y+d/2)/D.X;D.A.scale[0]=c/D.Y;D.A.scale[1]=d/D.X}else D.A.ja[0]=0,D.A.ja[1]=0,D.A.scale[0]=1,D.A.scale[1]=1;
D.L=D.Y*D.A.scale[0];D.H=D.X*D.A.scale[1]}function eb(){var a=[{type:"2f",name:"u33",value:D.A.ja},{type:"2f",name:"u34",value:D.A.scale}],c=a.concat([{type:"1f",name:"u35",value:D.Y/D.X},{name:"u7",type:"2f",value:[1/D.Y,1/D.X]}]);A.D("s49",c);A.D("s50",c);A.D("s51",a)}function Ga(a,c,d){var e=Aa(a,c,"dx")*D.da[0],r=Aa(a,c,"dy")*D.da[1];a=d[2]*Aa(a,c,"ds");if(La){c=Math.cos(wa);var t=Math.sin(wa),u=-t*e+c*r;e=c*e+t*r;r=u}e*=d[0];r*=d[1];d=P.g[2];c=P.g[3];P.g[0]-=e*d*S.S[0];P.g[1]-=r*c*S.S[1];P.g[2]-=
a*d*S.S[2];P.g[2]=Ma.bb(P.g[2],Ba.scaleXRange[0]*D.da[0],Ba.scaleXRange[1]*D.da[0]);P.g[0]=Ma.bb(P.g[0],0,1);P.g[3]=P.g[2]*D.aspectRatio/D.nb;P.g[1]=Ma.bb(P.g[1],0,1)}function fb(a){var c=P.g[2],d=P.g[3],e=(2*Math.random()-1)*a,r=.5*(2*Math.random()-1)*a;P.g[0]+=(2*Math.random()-1)*a*c;P.g[1]+=e*d;P.g[2]+=r*c;P.g[3]=P.g[2]*D.aspectRatio/D.nb}function Aa(a,c,d){c=xa[c].ic[d];return(a[c][0]+a[c][1]+a[c][2]+a[c][3])/4}function ob(a,c){if(S.pb){if(S.zb){var d=Aa(a,c,"yaw");a=-Aa(a,c,"notHere");return Math.atan2(a,
d)}return Math.PI*Aa(a,c,"yaw")}return 0}function pb(a,c,d,e){c=xa[c].ic[d];return(a[c][0]+a[c][1]+a[c][2]+a[c][3])/4*(1-e)+e*Math.min(a[c][0],a[c][1],a[c][2],a[c][3])}function Xa(a,c,d){var e=pb(a,c,"here",d),r=0;0<gb&&!S.zb&&(r=gb*pb(a,c,"notHere",d));return(e-r)/xa[c].Ab}function Na(){wa=0;La&&null!==Sa&&(wa=Sa[0]+Math.random()*(Sa[1]-Sa[0]));ma=aa.ha;var a=qb.get();a&&(P.g[0]=a[0],P.g[1]=a[1],P.g[2]=a[2],P.g[3]=a[2]*D.aspectRatio)}function Gb(a,c){S.la&&(la.roll=La?wa:hb);S.Fa&&(la.pitch=rb);
S.pb&&(la.yaw=a);la.label=xa[U.v].label;la.distance=xa[U.v].Mc;la.positionScale[0]=.5+(P.g[0]-.5)/D.A.scale[0];la.positionScale[1]=.5+(P.g[1]-.5)/D.A.scale[1];la.positionScale[2]=P.g[2];la.positionScale[3]=P.g[3];la.detectScore=c}function Hb(a){var c=-1,d=-1E12;-1!==[aa.ha,aa.Ya].indexOf(ma)&&xa.forEach(function(f,v){f=Xa(a,v,0);f>d&&(d=f,c=v)});switch(ma){case aa.ha:ma=aa.Ya;Ga(a,c,[1,1,1]);Wa=0;break;case aa.Ya:++Wa;d>R.Wa?(R.ma?(ma=aa.ra,Ta=c,U.v=c,U.sb=0):(ma=aa.Db,sb=0,Ta=c),Ga(a,Ta,[1,1,1])):
Wa>Y.kd?Na():Ga(a,c,[1,1,1]);break;case aa.Db:++sb>R.Ma&&(ma=aa.ra,U.n=0,U.lc=0,U.v=Ta,U.N[0]=0,U.N[1]=0);Ga(a,Ta,[1,1,1]);fb(R.Ia);break;case aa.ra:if(R.ma||++U.n>R.$){var e=Xa(a,U.v,1);if(R.ma||e>R.Wa+R.Va||R.Ea){S.la&&(hb=S.qc*Aa(a,U.v,"roll"),La&&(wa+=hb));if(ib){var r=-1;r=R.ma||R.Ea?ob(a,U.v):Math.atan2(U.N[1],U.N[0]);if(S.Fa){var t=.5+.5*Aa(a,U.v,"pitch");rb=S.pitchRange[0]+(S.pitchRange[1]-S.pitchRange[0])*t}Gb(r,e)}R.Ea?(Ga(a,U.v,R.vc),e>R.uc?(U.sb=0,la.label||(la.label=xa[U.v].label)):++U.sb>
R.Ka&&Na()):ib?Na():Ga(a,U.v,[.5,.5,.5])}else Na()}else{var u=1-(R.$-U.n)/(R.$-1);e=1.5-1*u;Ga(a,U.v,[e,e,e]);fb(R.va*(1-u));var p=Xa(a,U.v,u);p<R.Wa*u*R.wa?Na():++U.lc>10*R.$?Na():xa.some(function(f,v){return U.v===v?!1:Xa(a,v,u)>p*(R.pa*u+(1-u))?!0:!1})?(fb(R.qa[0]),wa+=(2*Math.random()-1)*R.qa[1]*Math.PI/180,U.n=0,U.N[0]=0,U.N[1]=0):(e=ob(a,U.v),U.N[0]+=Math.cos(e),U.N[1]+=Math.sin(e))}}}function Ib(){A.zc([{id:"s50",name:"_",fa:"attribute vec2 a0;uniform vec4 u36;uniform vec2 u33,u34;uniform float u32,u35;varying vec2 vv0;void main(){gl_Position=vec4(a0,0.,1.);float a=u35*(u36.z/u36.w);a*=u34.x/u34.y;float b=cos(u32),c=sin(u32);vec2 f=mat2(b,-c*a,c/a,b)*a0,g=u33+f*u34,d=u36.xy+.5*u36.zw*g;vv0=vec2(d.x,1.-d.y);}",
a:"uniform sampler2D u1;uniform vec2 u7;varying vec2 vv0;const vec3 g=vec3(1.,1.,1.);vec3 c[9];void main(){vec2 d=vv0+.5*u7;c[0]=texture2D(u1,d-u7*vec2(-1.,-1.)).rgb,c[1]=texture2D(u1,d-u7*vec2(-1.,0.)).rgb,c[2]=texture2D(u1,d-u7*vec2(-1.,1.)).rgb,c[3]=texture2D(u1,d-u7*vec2(0.,-1.)).rgb,c[4]=texture2D(u1,d-u7).rgb,c[5]=texture2D(u1,d-u7*vec2(0.,1.)).rgb,c[6]=texture2D(u1,d-u7*vec2(1.,-1.)).rgb,c[7]=texture2D(u1,d-u7*vec2(1.,0.)).rgb,c[8]=texture2D(u1,d-u7*vec2(1.,1.)).rgb;vec3 a,b;a=min(c[0],c[1]),b=max(c[0],c[1]),c[0]=a,c[1]=b,a=min(c[0],c[2]),b=max(c[0],c[2]),c[0]=a,c[2]=b,a=min(c[0],c[3]),b=max(c[0],c[3]),c[0]=a,c[3]=b,a=min(c[0],c[4]),b=max(c[0],c[4]),c[0]=a,c[4]=b,a=min(c[0],c[5]),b=max(c[0],c[5]),c[0]=a,c[5]=b,a=min(c[0],c[6]),b=max(c[0],c[6]),c[0]=a,c[6]=b,a=min(c[0],c[7]),b=max(c[0],c[7]),c[0]=a,c[7]=b,a=min(c[0],c[8]),b=max(c[0],c[8]),c[0]=a,c[8]=b,a=min(c[1],c[2]),b=max(c[1],c[2]),c[1]=a,c[2]=b,a=min(c[1],c[3]),b=max(c[1],c[3]),c[1]=a,c[3]=b,a=min(c[1],c[4]),b=max(c[1],c[4]),c[1]=a,c[4]=b,a=min(c[1],c[5]),b=max(c[1],c[5]),c[1]=a,c[5]=b,a=min(c[1],c[6]),b=max(c[1],c[6]),c[1]=a,c[6]=b,a=min(c[1],c[7]),b=max(c[1],c[7]),c[1]=a,c[7]=b,a=min(c[1],c[8]),b=max(c[1],c[8]),c[1]=a,c[8]=b,a=min(c[2],c[3]),b=max(c[2],c[3]),c[2]=a,c[3]=b,a=min(c[2],c[4]),b=max(c[2],c[4]),c[2]=a,c[4]=b,a=min(c[2],c[5]),b=max(c[2],c[5]),c[2]=a,c[5]=b,a=min(c[2],c[6]),b=max(c[2],c[6]),c[2]=a,c[6]=b,a=min(c[2],c[7]),b=max(c[2],c[7]),c[2]=a,c[7]=b,a=min(c[2],c[8]),b=max(c[2],c[8]),c[2]=a,c[8]=b,a=min(c[3],c[4]),b=max(c[3],c[4]),c[3]=a,c[4]=b,a=min(c[3],c[5]),b=max(c[3],c[5]),c[3]=a,c[5]=b,a=min(c[3],c[6]),b=max(c[3],c[6]),c[3]=a,c[6]=b,a=min(c[3],c[7]),b=max(c[3],c[7]),c[3]=a,c[7]=b,a=min(c[3],c[8]),b=max(c[3],c[8]),c[3]=a,c[8]=b,a=min(c[4],c[5]),b=max(c[4],c[5]),c[4]=a,c[5]=b,a=min(c[4],c[6]),b=max(c[4],c[6]),c[4]=a,c[6]=b,a=min(c[4],c[7]),b=max(c[4],c[7]),c[4]=a,c[7]=b,a=min(c[4],c[8]),b=max(c[4],c[8]),c[4]=a,c[8]=b,gl_FragColor=vec4(c[4]*g,1.);}",
b:"u1 u36 u34 u33 u32 u35 u7".split(" "),precision:"lowp"},{id:"s49",name:"_",fa:"attribute vec2 a0;uniform vec4 u36;uniform vec2 u33,u34;uniform float u32,u35;varying vec2 vv0;void main(){gl_Position=vec4(a0,0.,1.);float a=u35*(u36.z/u36.w);a*=u34.x/u34.y;float b=cos(u32),c=sin(u32);vec2 f=mat2(b,-c*a,c/a,b)*a0,g=u33+f*u34,d=u36.xy+.5*u36.zw*g;vv0=vec2(d.x,1.-d.y);}",a:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vv0);}",b:"u1 u36 u34 u33 u32 u35".split(" "),precision:"lowp"},
{id:"s52",name:"_",fa:"attribute vec2 a0;uniform vec4 u36;varying vec2 vv0;void main(){gl_Position=vec4(a0,0.,1.);vec2 a=u36.xy+.5*u36.zw*a0;vv0=vec2(a.x,1.-a.y);}",a:"uniform sampler2D u1;uniform vec2 u7;varying vec2 vv0;const vec3 g=vec3(1.,1.,1.);float c[5];void main(){c[0]=texture2D(u1,vv0-u7*vec2(-1.,0.)).r,c[1]=texture2D(u1,vv0-u7*vec2(0.,-1.)).r,c[2]=texture2D(u1,vv0-u7).r,c[3]=texture2D(u1,vv0-u7*vec2(0.,1.)).r,c[4]=texture2D(u1,vv0-u7*vec2(1.,0.)).r;float a,b;a=min(c[0],c[1]),b=max(c[0],c[1]),c[0]=a,c[1]=b,a=min(c[0],c[2]),b=max(c[0],c[2]),c[0]=a,c[2]=b,a=min(c[0],c[3]),b=max(c[0],c[3]),c[0]=a,c[3]=b,a=min(c[0],c[4]),b=max(c[0],c[4]),c[0]=a,c[4]=b,a=min(c[1],c[2]),b=max(c[1],c[2]),c[1]=a,c[2]=b,a=min(c[1],c[3]),b=max(c[1],c[3]),c[1]=a,c[3]=b,a=min(c[1],c[4]),b=max(c[1],c[4]),c[1]=a,c[4]=b,a=min(c[2],c[3]),b=max(c[2],c[3]),c[2]=a,c[3]=b,a=min(c[2],c[4]),b=max(c[2],c[4]),c[2]=a,c[4]=b,gl_FragColor=vec4(c[2]*g,1.);}",
b:["u1","u36","u7"],precision:"lowp"},{id:"s51",name:"_",fa:"attribute vec2 a0;uniform vec2 u33,u34;varying vec2 vv0;const vec2 f=vec2(1.,1.);void main(){gl_Position=vec4(a0,0.,1.);vec2 a=u33+a0*u34,b=(a+f)/2.;vv0=b;}",a:"uniform sampler2D u1;uniform vec4 u36;varying vec2 vv0;void main(){vec2 b=u36.xy-.5*u36.zw,c=u36.xy+.5*u36.zw,a=step(b,vv0)*step(vv0,c);vec4 d=texture2D(u1,vec2(vv0.x,1.-vv0.y));gl_FragColor=mix(d,vec4(0.,1.,0.,1.),a.x*a.y*.5);}",b:["u1","u36","u34","u33"],precision:"lowp"}]);var a=
[{type:"1i",name:"u1",value:0}];A.D("s50",a);A.D("s49",a);A.D("s52",a);A.D("s51",a);tb()}function tb(){wa=0;A.D("s49",ub);A.D("s50",ub);la.roll=0}function Oa(){D.aspectRatio=D.L/D.H;qb.o({Oa:Ba.overlapFactors,kc:Ba.nScaleLevels,L:D.L,H:D.H,rc:Ba.scale0Factor,Xa:S.S,sc:Ba.scanCenterFirst})}function vb(a){J.ca={isFlipY:!1,isLinear:!0,width:D.L,height:D.H,isPot:!1,isFloat:!1};J.type===Ca.fb?Object.assign(J.ca,{isKeepArray:!0,array:a.arrayBuffer}):Object.assign(J.ca,{s:a});J.F=W.instance(J.ca);J.fc=!0}
function wb(a,c,d){if(!a.exportData||!a.exportData.labels)return c("INVALID_NN");var e=a.exportData;"undefined"===typeof e.paramsPerLabel&&(e.paramsPerLabel={});"undefined"!==typeof d&&d.paramsPerLabel&&(e.paramsPerLabel=Object.assign(e.paramsPerLabel,d.paramsPerLabel));Ya.reset_state();Pa=new Cb({Ha:a.layers,wb:"cpuRGBA2Float",tb:Hb});P.F=W.instance({isFloat:!1,isPot:!1,width:Pa.Vc()});S.S=e.dxysFactors?e.dxysFactors:Y.S;e.rollMax?(S.qc=e.rollMax,S.la=!0):S.la=!1;e.pitchRange?(S.pitchRange=e.pitchRange,
S.Fa=!0):S.Fa=!1;e.splitYawComponents&&(S.zb=!0);"undefined"!==typeof e.isYaw&&(S.pb=e.isYaw);S.width=Pa.Zc();a="undefined"===typeof d?{}:d;gb="undefined"===typeof a.notHereFactor?1:a.notHereFactor;a=e.labels;d="undefined"===typeof e.paramsPerLabel?!1:e.paramsPerLabel;var r="undefined"===typeof e.inputAspectRatio?1:e.inputAspectRatio,t=Math.sqrt(r);D.da[0]=t;D.da[1]=1/t;D.nb=r;Oa();r=Array(a.length);for(t=0;t<S.width/8;++t)for(var u=0;u<S.width;++u){var p=u+t*S.width;if(p>=a.length)break;var f=u,
v=8*t,z=a[p];r[p]={Ab:d&&d[z]&&d[z].thresholdDetect?d[z].thresholdDetect:Y.Ab,label:z,Mc:e.distances&&e.distances[p]?e.distances[p]:3,ic:{here:f+v*S.width,notHere:f+(v+1)*S.width,yaw:f+(v+2)*S.width,dx:f+(v+3)*S.width,dy:f+(v+4)*S.width,ds:f+(v+5)*S.width,roll:f+(v+6)*S.width,pitch:f+(v+7)*S.width}}}xa=r;c(!1)}var Ma={he:function(a){return Math.ceil(Math.log2(a))},hd:function(a){return Math.log2(a)},ve:function(a){return 0===Math.log2(a)%1},Ld:function(a){var c=[0,0,0,0];a.forEach(function(d){c[0]+=
d[0];c[1]+=d[1];c[2]+=d[2];c[3]+=d[3]});return c},bb:function(a,c,d){return Math.min(Math.max(a,c),d)},Od:function(a){return a*Math.PI/180},Ae:function(a,c){c=Math.pow(10,c);return Math.round(a*c)/c},Be:function(a){return Math.round(1E6*a)/1E6},ie:function(a,c){return(100*a/c).toFixed(3)},xe:function(a,c,d){return a*(1-d)+c*d},Lc:function(a,c){return Ma.Gc(a-c)},Gc:function(a){for(;a>Math.PI;)a-=2*Math.PI;for(;a<=-Math.PI;)a+=2*Math.PI;return a},Qd:function(a,c){return Math.abs(Ma.Lc(a,c))},Fd:function(a,
c){return Math.atan2(Math.sin(a)+Math.sin(c),Math.cos(a)+Math.cos(c))}},xb={get:function(a,c,d){var e=new XMLHttpRequest;e.open("GET",a,!0);e.withCredentials=!1;e.onreadystatechange=function(){4===e.readyState&&(200===e.status||0===e.status?c(e.responseText):"undefined"!==typeof d&&d(e.status))};e.send()},fe:function(a,c){xb.get(a,function(d){c(JSON.parse(d))})},ye:function(a,c,d){var e=new XMLHttpRequest;e.open("POST",a,!0);e.setRequestHeader("Content-type","application/x-www-form-urlencoded");e.onreadystatechange=
function(){4!==e.readyState||200!==e.status&&0!==e.status||d(e.responseText)};e.send(c)},Ud:function(a,c){var d=new XMLHttpRequest;d.open("POST",a,!0);d.responseType="arraybuffer";d.onload=function(){c(d.response)};d.send()}},Jb={Qc:function(a,c,d){switch(a){case "relu":return d+"=max(vec4(0.,0.,0.,0.),"+c+");";case "elu":return d+"=mix(exp(-abs("+c+"))-vec4(1.,1.,1.,1.),"+c+",step(0.,"+c+"));";case "elu01":return d+"=mix(0.1*exp(-abs("+c+"))-vec4(0.1,0.1,0.1,0.1),"+c+",step(0.,"+c+"));";case "arctan":return d+
"=atan(3.14159265359*texture2D(u0,vUV))/3.14159265359;";case "copy":return"";default:return!1}}},A=function(){function a(q,l,E){l=q.createShader(l);q.shaderSource(l,E);q.compileShader(l);return q.getShaderParameter(l,q.COMPILE_STATUS)?l:!1}function c(q,l,E){l=a(q,q.VERTEX_SHADER,l);E=a(q,q.FRAGMENT_SHADER,E);q===b&&u.push(l,E);var K=q.createProgram();q.attachShader(K,l);q.attachShader(K,E);q.linkProgram(K);return K}function d(q,l){void 0===l.fa&&(l.fa="precision lowp float;attribute vec2 a0;varying vec2 vv0;void main(){gl_Position=vec4(a0,0.,1.),vv0=a0*.5+vec2(.5,.5);}");
void 0===l.Gb&&(l.Gb=["a0"]);void 0===l.$a&&(l.$a=[2]);if(void 0===l.precision||"highp"===l.precision)l.precision=m;l.id=v++;void 0!==l.td&&l.td.forEach(function(K,X){l.a=l.a.replace(K,l.Qa[X])});l.Cb=0;l.$a.forEach(function(K){l.Cb+=4*K});l.aa=c(q,l.fa,"precision "+l.precision+" float;\n"+l.a);l.l={};l.b.forEach(function(K){l.l[K]=q.getUniformLocation(l.aa,K)});l.attributes={};l.ia=[];l.Gb.forEach(function(K){var X=q.getAttribLocation(l.aa,K);l.attributes[K]=X;l.ia.push(X)});if(l.f){q.useProgram(l.aa);
f=l;p=l.id;for(var E in l.f)q.uniform1i(l.l[E],l.f[E])}l.mb=!0}function e(q){ra.xd(I);p!==q.id&&(I.K(),p=q.id,f=q,b.useProgram(q.aa),q.ia.forEach(function(l){0!==l&&b.enableVertexAttribArray(l)}))}function r(q,l,E){d(q,l,E);q.useProgram(l.aa);q.enableVertexAttribArray(0);p=-1;return f=l}function t(){return{a:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vv0);}",b:["u1"],f:{u1:0}}}var u=[],p=-1,f=null,v=0,z=!1,m="highp",x=["u1"],g=["u0"],C={u1:0},H={u0:0},B={u1:0,u2:1},
n={u3:0},w={s0:t(),s1:{a:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vv0);}",b:x,f:C,precision:"lowp"},s2:{a:"uniform sampler2D u1,u2;varying vec2 vv0;void main(){vec4 a=texture2D(u2,vv0),b=texture2D(u1,vv0);gl_FragColor=a*b;}",b:["u1","u2"],f:B},s3:{a:"uniform sampler2D u1;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u1,vv0);gl_FragColor=a.r*f;}",b:x,f:C},s4:{a:"uniform sampler2D u1,u2;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u2,vv0),b=texture2D(u1,vv0);gl_FragColor=a.a*b.r*f;}",
b:["u1","u2"],f:B},s5:{a:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vec2(1.-vv0.x,vv0.y));}",b:x,f:C},s6:{a:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vec2(vv0.x,1.-vv0.y));}",b:x,f:C},s7:{a:"uniform sampler2D u0;uniform float u4;varying vec2 vv0;void main(){vec4 a=texture2D(u0,vv0);gl_FragColor=a*u4;}",b:["u0","u4"],f:H},s8:{a:"uniform sampler2D u0;uniform float u4;varying vec2 vv0;const vec4 f=vec4(.25,.25,.25,.25),g=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0);float b=dot(a*u4,f);gl_FragColor=b*g;}",
b:["u0","u4"],f:H},s9:{a:"uniform sampler2D u1;varying vec2 vv0;const vec4 e=vec4(1.,1.,1.,1.);void main(){float a=.25*dot(e,texture2D(u1,vv0));gl_FragColor=a*e;}",b:x,f:C},s10:{a:"uniform sampler2D u1,u5;uniform float u6;const vec4 f=vec4(1.,1.,1.,1.);varying vec2 vv0;void main(){vec4 a=texture2D(u1,vv0),b=texture2D(u5,vv0);gl_FragColor=mix(b,a,u6*f);}",b:["u1","u5","u6"],f:{u1:0,u5:1}},s11:{a:"uniform sampler2D u1;uniform vec2 u7;varying vec2 vv0;void main(){gl_FragColor=.25*(texture2D(u1,vv0+u7)+texture2D(u1,vv0+u7*vec2(1.,-1.))+texture2D(u1,vv0+u7*vec2(-1.,-1.))+texture2D(u1,vv0+u7*vec2(-1.,1.)));}",
b:["u1","u7"],f:C},s12:{a:"uniform sampler2D u1;uniform vec4 u8;varying vec2 vv0;float g(float a,float b){a=floor(a)+.5;return floor(a/exp2(b));}float h(float a,float b){return floor(a*exp2(b)+.5);}float i(float a,float b){return mod(a,h(1.,b));}float e(float c,float a,float b){a=floor(a+.5),b=floor(b+.5);return i(g(c,a),b-a);}vec4 j(float a){if(a==0.)return vec4(0.,0.,0.,0.);float k=128.*step(a,0.);a=abs(a);float c=floor(log2(a)),l=c+127.,b=(a/exp2(c)-1.)*8388608.,d=l/2.,m=fract(d)*2.,n=floor(d),o=e(b,0.,8.),p=e(b,8.,16.),q=m*128.+e(b,16.,23.),r=k+n;return vec4(o,p,q,r)/255.;}void main(){float a=dot(texture2D(u1,vv0),u8);gl_FragColor=j(a);}",
b:["u1","u8"],f:C},s13:{a:"uniform sampler2D u0;varying vec2 vv0;const vec4 e=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),b=e/(e+exp(-a));gl_FragColor=b;}",b:g,f:H},s14:{a:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(0.,0.,0.,0.);void main(){vec4 a=texture2D(u0,vv0);gl_FragColor=max(f,a);}",b:g,f:H},s15:{a:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0);gl_FragColor=mix(exp(-abs(a))-f,a,step(0.,a));}",b:g,f:H},s16:{a:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),b=exp(-abs(a))-f;gl_FragColor=mix(.1*b,a,step(0.,a));}",
b:g,f:H},s17:{a:"uniform sampler2D u0,u6,u9;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),c=texture2D(u6,vv0),d=texture2D(u9,vv0),b=a/d;gl_FragColor=c*mix(exp(-abs(b))-f,b,step(0.,a));}",b:["u0","u6","u9"],f:{u0:0,u6:1,u9:2}},s18:{a:"uniform sampler2D u0;const float e=3.141593;varying vec2 vv0;void main(){gl_FragColor=atan(e*texture2D(u0,vv0))/e;}",b:g,f:H},s19:{a:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),b=log(f+a);gl_FragColor=b;}",
b:g,f:H},s20:{a:"uniform sampler2D u0,u10;uniform float u11;const vec2 e=vec2(.5,.5);const float f=1e-5;const vec4 g=vec4(1.,1.,1.,1.),i=vec4(0.,0.,0.,0.);varying vec2 vv0;void main(){vec4 a=texture2D(u10,e);float b=u11*u11;vec4 c=max(b*a,f*g);gl_FragColor=texture2D(u0,vv0)/c;}",b:["u0","u10","u11"],f:{u0:0,u10:1}},s21:{a:"uniform sampler2D u1;uniform vec2 u12;varying vec2 vv0;void main(){float a=u12.x*u12.y;vec2 b=floor(vv0*a)/a,c=fract(vv0*a),d=floor(b*u12.y),f=floor(u12.x*fract(b*u12.y)),g=(f*u12.y+d)/a;gl_FragColor=texture2D(u1,g+c/a);}",
b:["u1","u12"],f:C},s22:{a:"uniform sampler2D u13,u14,u15;varying vec2 vv0;void main(){vec4 a=texture2D(u15,vv0);vec2 b=a.rg,c=a.ba;vec4 d=texture2D(u13,b),f=texture2D(u14,c);gl_FragColor=d*f;}",b:["u13","u14","u15"],f:{u14:0,u13:1,u15:2}},s23:{a:"uniform float u16;uniform sampler2D u13,u14;varying vec2 vv0;void main(){vec2 a=fract(vv0*u16);vec4 b=texture2D(u13,vv0),c=texture2D(u14,a);gl_FragColor=b*c;}",b:["u14","u13","u16"],f:{u14:0,u13:1}},s24:{a:"uniform float u16;uniform sampler2D u13,u14,u17,u18,u19,u20;varying vec2 vv0;const vec4 e=vec4(1.,1.,1.,1.),g=vec4(1e-3,1e-3,1e-3,1e-3);void main(){vec2 h=vv0*u16,l=floor(h),c=h-l;vec4 m=texture2D(u13,vv0),d=texture2D(u14,c),a=texture2D(u20,vv0);a=a*255.;vec4 n=texture2D(u17,c),o=texture2D(u18,c),p=texture2D(u19,c),i=step(-g,-a),b=e-i,j=b*step(-e-g,-a);b*=e-j;vec4 k=b*step(-2.*e-g,-a);b*=e-k;vec4 q=b;d=i*d+j*n+k*o+q*p,gl_FragColor=m*d;}",
b:"u13 u14 u16 u20 u17 u18 u19".split(" "),f:{u14:0,u13:1,u20:3,u17:4,u18:5,u19:6}},s25:{a:"uniform sampler2D u13,u14,u21;uniform float u16,u22,u23,u24;varying vec2 vv0;const vec2 j=vec2(1.,1.);void main(){vec2 a=floor(u22*vv0),b=u22*vv0-a;float c=u16/u22;vec2 d=floor(b*c),f=b*c-d,g=(a+f)/u22;float k=u22*u24/u16;vec2 l=k*d,h=(l+f*u23)/u24,i=step(h,j);vec4 m=texture2D(u13,g),n=texture2D(u14,h),o=m*n*i.x*i.y,p=texture2D(u21,g);gl_FragColor=o*u23*u23+p;}",b:"u13 u14 u16 u22 u23 u24 u21".split(" "),f:{u14:0,
u13:1,u21:2}},s26:{a:"uniform sampler2D u13,u14;varying vec2 vv0;void main(){vec4 a=texture2D(u13,vv0),b=texture2D(u14,vv0);gl_FragColor=a*b;}",b:["u13","u14"],f:{u14:0,u13:1}},s27:{a:"uniform sampler2D u1,u21;uniform float u25;varying vec2 vv0;void main(){gl_FragColor=texture2D(u21,vv0)+u25*texture2D(u1,vv0);}",b:["u1","u21","u25"],f:{u1:0,u21:1}},s28:{a:"varying vec2 vv0;uniform sampler2D u1;const vec4 f=vec4(1.,1.,1.,1.),g=vec4(.299,.587,.114,0.);void main(){vec4 a=texture2D(u1,vv0);gl_FragColor=dot(a,g)*f;}",
b:x,f:C,precision:"lowp"},s29:{a:"varying vec2 vv0;uniform sampler2D u1;uniform float u26;const vec3 f=vec3(.299,.587,.114);void main(){vec3 a=texture2D(u1,vv0).rgb,b=texture2D(u1,vv0+vec2(0.,u26)).rgb,c=texture2D(u1,vv0+vec2(u26,u26)).rgb,d=texture2D(u1,vv0+vec2(u26,0.)).rgb;gl_FragColor=vec4(dot(a,f),dot(b,f),dot(c,f),dot(d,f));}",b:["u1","u26"],f:C,precision:"lowp"},s30:{a:"varying vec2 vv0;uniform sampler2D u1;uniform float u26;const vec3 f=vec3(.299,.587,.114);void main(){vec3 a=texture2D(u1,vv0).rgb,b=texture2D(u1,vv0+vec2(0.,u26)).rgb,c=texture2D(u1,vv0+vec2(u26,u26)).rgb,d=texture2D(u1,vv0+vec2(u26,0.)).rgb;gl_FragColor=vec4(a.r,b.g,c.b,dot(d,f));}",
b:["u1","u26"],f:C,precision:"lowp"},s31:{a:"varying vec2 vv0;uniform sampler2D u1,u2;uniform float u27;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=vec4(0.);a-=texture2D(u1,vec2(vv0.x-u27,vv0.y-u27))*1.,a-=texture2D(u1,vec2(vv0.x-u27,vv0.y))*2.,a-=texture2D(u1,vec2(vv0.x-u27,vv0.y+u27))*1.,a+=texture2D(u1,vec2(vv0.x+u27,vv0.y-u27))*1.,a+=texture2D(u1,vec2(vv0.x+u27,vv0.y))*2.,a+=texture2D(u1,vec2(vv0.x+u27,vv0.y+u27))*1.;vec4 b=vec4(0.);b-=texture2D(u1,vec2(vv0.x-u27,vv0.y-u27))*1.,b-=texture2D(u1,vec2(vv0.x,vv0.y-u27))*2.,b-=texture2D(u1,vec2(vv0.x+u27,vv0.y-u27))*1.,b+=texture2D(u1,vec2(vv0.x-u27,vv0.y+u27))*1.,b+=texture2D(u1,vec2(vv0.x,vv0.y+u27))*2.,b+=texture2D(u1,vec2(vv0.x+u27,vv0.y+u27))*1.;vec3 c=sqrt(a.rgb*a.rgb+b.rgb*b.rgb);vec4 e=vec4(c,texture2D(u1,vv0).a),g=texture2D(u2,vv0);gl_FragColor=g.a*e.r*f;}",
b:["u1","u2","u27"],f:B},s32:{a:"varying vec2 vv0;uniform sampler2D u1,u2;uniform float u27;const vec4 j=vec4(1.,1.,1.,1.);const vec2 k=vec2(1.,1.);void main(){float h=0.;vec2 l=k*u27,a,b;float c,d,i=0.;for(float e=-4.;e<=4.;e+=1.)for(float f=-4.;f<=4.;f+=1.)a=vec2(e,f),c=length(a)/2.,d=exp(-c*c),b=vv0+l*a,h+=d*texture2D(u1,b).r,i+=d;vec4 m=texture2D(u2,vv0);gl_FragColor=m.a*(texture2D(u1,b).r-h/i)*j;}",b:["u1","u2","u27"],f:B},s33:{a:"uniform sampler2D u3;uniform vec2 u7;varying vec2 vv0;vec4 e(vec4 a,vec4 b){vec4 c=step(a,b);return mix(a,b,c);}const vec2 g=vec2(.5,.5),h=vec2(1.,0.),i=vec2(0.,1.);void main(){vec2 a=vv0-u7*g;vec4 b=texture2D(u3,a),c=texture2D(u3,a+u7*h),d=texture2D(u3,a+u7*i),j=texture2D(u3,a+u7),k=e(b,c),l=e(d,j);gl_FragColor=e(k,l);}",
b:["u3","u7"],f:n},s34:{a:"uniform sampler2D u3;uniform vec2 u7;varying vec2 vv0;const vec2 k=vec2(1.,0.),l=vec2(0.,1.),m=vec2(2.,0.),n=vec2(0.,2.);vec4 e(vec4 a,vec4 b){vec4 c=step(a,b);return mix(a,b,c);}vec4 f(vec2 a){vec4 b=texture2D(u3,a),c=texture2D(u3,a+u7*k),d=texture2D(u3,a+u7*l),g=texture2D(u3,a+u7),h=e(b,c),i=e(d,g);return e(h,i);}void main(){vec2 a=vv0+u7*vec2(-.55,-1.05);vec4 b=f(a),c=f(a+u7*m),d=f(a+u7*2.),g=f(a+u7*n),h=e(b,c),i=e(d,g);gl_FragColor=e(h,i);}",b:["u3","u7"],f:n},s35:{a:"uniform sampler2D u1;varying vec2 vv0;void main(){vec4 a=texture2D(u1,vv0);gl_FragColor=a*a;}",
b:["u1"],f:C,precision:"lowp"},s36:{a:"uniform sampler2D u1;uniform vec2 u7;varying vec2 vv0;const float e=15444.;void main(){vec4 a=1001./e*texture2D(u1,vv0-3.*u7)+2002./e*texture2D(u1,vv0-2.*u7)+3003./e*texture2D(u1,vv0-u7)+3432./e*texture2D(u1,vv0)+3003./e*texture2D(u1,vv0+u7)+2002./e*texture2D(u1,vv0+2.*u7)+1001./e*texture2D(u1,vv0+3.*u7);gl_FragColor=a;}",b:["u7","u1"],f:C,precision:"lowp"},s37:{a:"uniform sampler2D u1,u28,u29;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);const float g=.1;void main(){vec4 a=texture2D(u28,vv0),b=texture2D(u29,vv0),c=texture2D(u1,vv0),d=max(f*g,b-a*a),h=sqrt(d);gl_FragColor=(c-a)/h;}",
b:["u1","u28","u29"],f:{u1:0,u28:1,u29:2}}},F={s38:{a:"uniform float u16,u30;uniform sampler2D u13,u14,u21;varying vec2 vv0;const vec2 ZERO2=vec2(0.,0.),ONE2=vec2(1.,1.),HALF2=vec2(.5,.5),EPS2=vec2(1e-5,1e-5);void main(){vec4 sum=texture2D(u21,vv0);float toSparsity=1.1111;vec2 uvFrom,uvWeight,xyPatch=ZERO2,eps2=EPS2/u16,xyTo=floor(vv0*u16+eps2);float weightSize=toSparsity*u16;vec2 halfFromSparsity=ONE2*(toSparsity-1.)/2.;for(float patch_x=0.;patch_x<1.1111;patch_x+=1.){xyPatch.x=patch_x;for(float patch_y=0.;patch_y<1.1111;patch_y+=1.)xyPatch.y=patch_y,uvFrom=(xyTo+HALF2+u30*(xyPatch-halfFromSparsity))/u16,uvFrom+=step(uvFrom,-eps2),uvFrom-=step(ONE2-eps2,uvFrom),uvWeight=(xyTo*toSparsity+xyPatch+HALF2)/weightSize,sum+=texture2D(u13,uvWeight)*texture2D(u14,uvFrom);}gl_FragColor=sum,gl_FragColor*=2.2222;}",
b:["u16","u13","u14","u21","u30"],Qa:["1.1111","gl_FragColor\\*=2.2222;"]},s39:{a:"uniform float u16,u30,u24;uniform sampler2D u13,u14,u21;varying vec2 vv0;const vec2 ZERO2=vec2(0.,0.),ONE2=vec2(1.,1.),HALF2=vec2(.5,.5),EPS2=vec2(1e-4,1e-4);void main(){vec4 sum=texture2D(u21,vv0);float fromSparsity=1.1111,shrinkFactor=3.3333;vec2 uvFrom,uvWeight,xyFrom,xyPatchTo,xyPatch=ZERO2,xyShrink=ZERO2,eps2=EPS2/u24,xyTo=floor(vv0*u16+eps2);float weightSize=fromSparsity*u24;vec2 halfFromSparsity=ONE2*(fromSparsity-1.)/2.;float toSparsity=weightSize/u16;vec2 xyFrom0=xyTo*shrinkFactor;for(float patch_x=0.;patch_x<1.1111;patch_x+=1.){xyPatch.x=patch_x;for(float patch_y=0.;patch_y<1.1111;patch_y+=1.){xyPatch.y=patch_y;for(float shrink_x=0.;shrink_x<3.3333;shrink_x+=1.){xyShrink.x=shrink_x;for(float shrink_y=0.;shrink_y<3.3333;shrink_y+=1.)xyShrink.y=shrink_y,xyFrom=xyFrom0+xyShrink+shrinkFactor*u30*(xyPatch-halfFromSparsity),uvFrom=(xyFrom+HALF2)/u24,uvFrom+=step(uvFrom,-eps2),uvFrom-=step(ONE2-eps2,uvFrom),xyPatchTo=xyPatch*shrinkFactor+xyShrink,uvWeight=(xyTo*toSparsity+xyPatchTo+HALF2)/weightSize,sum+=texture2D(u13,uvWeight)*texture2D(u14,uvFrom);}}}gl_FragColor=sum,gl_FragColor*=2.2222;}",
b:"u16 u24 u13 u14 u21 u30".split(" "),Qa:["1.1111","gl_FragColor\\*=2.2222;","3.3333"]}},I={Ga:function(){return z},o:function(){if(!z){m="highp";for(var q in w)d(b,w[q],q);A.set("s0");b.enableVertexAttribArray(0);z=!0}},zc:function(q){q.forEach(function(l){I.Fb(l)})},Fb:function(q){w[q.id]=q;d(b,q,q.id)},ac:function(q,l,E){l||(l=q);w[l]=Object.create(F[q]);w[l].cd=!0;F[q].Qa&&F[q].Qa.forEach(function(K,X){w[l].a=w[l].a.replace(new RegExp(K,"g"),E[X])});d(b,w[l],l)},set:function(q){e(w[q])},Ra:function(q){return r(q,
t(),"s40")},xb:function(q){return r(q,{a:"void main(){gl_FragColor=vec4(.5,.5,.5,.5);}",b:[],precision:"highp"},"s41")},Oc:function(q){return"undefined"===typeof w[q]?!1:w[q].mb},K:function(){-1!==p&&(p=-1,f.ia.forEach(function(q){0!==q&&b.disableVertexAttribArray(q)}))},yb:function(){var q=0;f.ia.forEach(function(l,E){E=f.$a[E];b.vertexAttribPointer(l,E,b.FLOAT,!1,f.Cb,q);q+=4*E})},Td:function(){b.enableVertexAttribArray(0)},Sa:function(){I.Ta(b)},Ta:function(q){q.vertexAttribPointer(f.ia[0],2,q.FLOAT,
!1,8,0)},Fe:function(q,l){b.uniform1i(f.l[q],l)},M:function(q,l){b.uniform1f(f.l[q],l)},na:function(q,l,E){b.uniform2f(f.l[q],l,E)},Ge:function(q,l){b.uniform2fv(f.l[q],l)},Ie:function(q,l){b.uniform3fv(f.l[q],l)},He:function(q,l,E,K){b.uniform3f(f.l[q],l,E,K)},Je:function(q,l,E,K,X){b.uniform4f(f.l[q],l,E,K,X)},oa:function(q,l){b.uniform4fv(f.l[q],l)},Ke:function(q,l){b.uniformMatrix2fv(f.l[q],!1,l)},Le:function(q,l){b.uniformMatrix3fv(f.l[q],!1,l)},Me:function(q,l){b.uniformMatrix4fv(f.l[q],!1,
l)},D:function(q,l){I.set(q);l.forEach(function(E){switch(E.type){case "4f":b.uniform4fv(f.l[E.name],E.value);break;case "3f":b.uniform3fv(f.l[E.name],E.value);break;case "2f":b.uniform2fv(f.l[E.name],E.value);break;case "1f":b.uniform1f(f.l[E.name],E.value);break;case "1i":b.uniform1i(f.l[E.name],E.value);break;case "mat2":b.uniformMatrix2fv(f.l[E.name],!1,E.value);break;case "mat3":b.uniformMatrix3fv(f.l[E.name],!1,E.value);break;case "mat4":b.uniformMatrix4fv(f.l[E.name],!1,E.value)}})},ge:function(){return"lowp"},
j:function(){b.disableVertexAttribArray(0);I.K();for(var q in w){var l=w[q];l.mb&&(l.mb=!1,b.deleteProgram(l.aa));l.cd&&delete w[q]}u.forEach(function(E){b.deleteShader(E)});u.splice(0);v=0;z=!1}};return I}(),b=null,Za=function(){function a(m){console.log("ERROR in ContextFF: ",m);return!1}function c(m){function x(){Da.j();C.getExtension("WEBGL_lose_context").loseContext()}if(navigator.userAgent&&-1!==navigator.userAgent.indexOf("forceWebGL1"))return!1;var g=document.createElement("canvas");g.setAttribute("width",
1);g.setAttribute("height",1);var C=null;try{C=g.getContext("webgl2",m)}catch(H){return!1}if(!C)return!1;d(C);ba.Ob(C);m=ba.eb(C);if(!m.T&&!m.V)return x(),!1;m=Da.Jb(C,m);x();return m?!0:!1}function d(m){m.clearColor(0,0,0,0);m.disable(m.DEPTH_TEST);m.disable(m.BLEND);m.disable(m.DITHER);m.disable(m.STENCIL_TEST);m.disable(m.CULL_FACE);m.GENERATE_MIPMAP_HINT&&m.hint(m.GENERATE_MIPMAP_HINT,m.FASTEST);m.disable(m.SAMPLE_ALPHA_TO_COVERAGE);m.disable(m.SAMPLE_COVERAGE);m.depthFunc(m.LEQUAL);m.clearDepth(1)}
var e=null,r=null,t=null,u=null,p=!0,f=null,v=null,z={B:function(){return e.width},U:function(){return e.height},Yd:function(){return e},Wd:function(){return b},W:function(){return p},flush:function(){b.flush()},Sc:function(){f||(f=new Uint8Array(e.width*e.height*4));b.readPixels(0,0,e.width,e.height,b.RGBA,b.UNSIGNED_BYTE,f);return f},$d:function(){return e.toDataURL("image/jpeg")},ae:function(){Ea.J();r||(r=document.createElement("canvas"),t=r.getContext("2d"));r.width=e.width;r.height=e.height;
for(var m=z.Sc(),x=t.createImageData(r.width,r.height),g=r.width,C=r.height,H=x.data,B=0;B<C;++B)for(var n=C-B-1,w=0;w<g;++w){var F=4*(B*g+w),I=4*(n*g+w);H[F]=m[I];H[F+1]=m[I+1];H[F+2]=m[I+2];H[F+3]=m[I+3]}t.putImageData(x,0,0);return r.toDataURL("image/png")},Zd:function(m){!r&&m&&(r=document.createElement("canvas"),t=r.getContext("2d"));var x=m?r:document.createElement("canvas");x.width=e.width;x.height=e.height;(m?t:x.getContext("2d")).drawImage(e,0,0);return x},o:function(m){m.Ic&&!m.cb?e=document.getElementById(m.Ic):
m.cb&&(e=m.cb);e||(e=document.createElement("canvas"));e.width=m&&void 0!==m.width?m.width:512;e.height=m&&void 0!==m.height?m.height:512;"undefined"===typeof m&&(m={});void 0===m.premultipliedAlpha&&(m.premultipliedAlpha=!1);void 0===m.ec&&(m.ec=!0);void 0===m.antialias&&(m.antialias=!1);if(!b){var x={antialias:m.antialias,alpha:!0,preserveDrawingBuffer:!0,premultipliedAlpha:m.premultipliedAlpha,stencil:!1,depth:m.ec};navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("noAntialiasing")&&
(x.antialias=!1);var g=c(x);!g&&x.antialias&&(x.antialias=!1,g=c(x));g&&(b=e.getContext("webgl2",x));b?p=!0:((b=e.getContext("webgl",x))||(b=e.getContext("experimental-webgl",x)),p=!1)}if(!b)return a("WebGL1 and 2 are not enabled");(u=b.getExtension("WEBGL_lose_context"))&&m.mc&&(v=m.mc,e.addEventListener("webglcontextlost",v,!1));if(!ba.o())return a("Not enough GL capabilities");d(b);A.o();Z.o();return Da.Jb(b,ba.Rc())?!0:a("Cannot filter float textures")},j:function(){b&&ba.j();u&&v&&(e.removeEventListener("webglcontextlost",
v,!1),v=null);f=t=r=e=null}};return z}(),ra=function(){function a(){null===c&&("undefined"!==typeof A?c=A:"undefined"!==typeof JEShaders&&(c=JEShaders))}var c=null;a();return{xd:function(d){c!==d&&(c&&c.K(),c=d)},Ga:function(){return c.Ga()},Sa:function(){return c.Sa()},Ta:function(d){return c.Ta(d)},yb:function(){return c.yb()},K:function(){return c.K()},set:function(d){return c.set(d)},Ra:function(d){a();return c.Ra(d)},xb:function(d){a();return c.xb(d)},j:function(){return c.j()}}}(),Ka=function(){function a(h){b.bindTexture(b.TEXTURE_2D,
h)}function c(h){K[0]=h;h=X[0];var M=h>>16&32768,L=h>>12&2047,k=h>>23&255;return 103>k?M:142<k?M|31744|((255==k?0:1)&&h&8388607):113>k?(L|=2048,M|(L>>114-k)+(L>>113-k&1)):M=(M|k-112<<10|L>>1)+(L&1)}function d(h){var M=new Uint16Array(h.length);h.forEach(function(L,k){M[k]=c(L)});return M}function e(){if(null!==na.kb)return na.kb;var h=t(d([1,1,1,1]));return null===h?!0:na.kb=h}function r(){if(null!==na.lb)return na.lb;var h=t(new Uint8Array([255,255,255,255]));return null===h?!0:na.lb=h}function t(h){if(!ra.Ga()||
!H)return null;var M=null;try{var L=b.getError();if("FUCKING_BIG_ERROR"===L)return!1;M=G.instance({isFloat:!1,G:!0,array:h,width:1});L=b.getError();if(L!==b.NO_ERROR)return!1}catch(k){return!1}ia.J();b.viewport(0,0,1,1);b.clearColor(0,0,0,0);b.clear(b.COLOR_BUFFER_BIT);ra.set("s0");M.Hb(0);ja.i(!0,!0);h=new Uint8Array(4);b.readPixels(0,0,1,1,b.RGBA,b.UNSIGNED_BYTE,h);h=.9<h[0];M.remove();ia.R();return h}var u=0,p=null,f=0,v=null,z=null,m=null,x=null,g=null,C=null,H=!1,B=[],n={isFloat:!1,isPot:!0,
isLinear:!1,isMipmap:!1,isAnisotropicFiltering:!1,isMirrorX:!1,isMirrorY:!1,isSrgb:!1,isKeepArray:!1,isFlipY:null,width:0,height:0,url:null,array:null,data:null,s:null,bd:!1,G:!1,Z:null,Ja:4,qb:0},w=!1,F=null,I=null,q=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],l=!1,E=!1,K=new Float32Array(1),X=new Int32Array(K.buffer),na={kb:null,lb:null},G={o:function(){H||(g=[b.RGB,null,b.RGB,b.RGBA],C=[b.RGB,null,b.RGB,b.RGBA],p=[b.TEXTURE0,b.TEXTURE1,b.TEXTURE2,b.TEXTURE3,b.TEXTURE4,b.TEXTURE5,b.TEXTURE6,b.TEXTURE7],
l="undefined"!==typeof JEContext,E="undefined"!==typeof ba,l&&JEContext.we()&&p.push(b.TEXTURE8,b.TEXTURE9),v=[-1,-1,-1,-1,-1,-1,-1,-1],x=[b.UNSIGNED_BYTE,b.FLOAT,b.FLOAT],H=!0)},ad:function(){if(!z){for(var h=new Float32Array(16384),M=0;16384>M;++M)h[M]=2*Math.random()-1;z={random:G.instance({isFloat:!0,isPot:!0,array:h,width:64}),wc:G.instance({isFloat:!1,isPot:!0,width:1,array:new Uint8Array([0,0,0,0])})}}G.Ed()},oe:function(){return z.wc},Ed:function(){x[1]=ba.ib(b)},vd:function(){C=g=[b.RGBA,
b.RGBA,b.RGBA,b.RGBA]},ze:function(h,M){A.set("s1");ia.J();var L=h.B(),k=h.U();b.viewport(0,0,L,k);h.c(0);ja.i(!1,!1);b.readPixels(0,0,L,k,b.RGBA,b.UNSIGNED_BYTE,M)},Vb:function(h,M,L,k,da,sa,ya){h.activeTexture(h.TEXTURE0);var oa=h.createTexture();h.bindTexture(h.TEXTURE_2D,oa);da=da instanceof Float32Array?da:new Float32Array(da);0!==Ma.hd(da.length)%1&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE));h.texParameteri(h.TEXTURE_2D,
h.TEXTURE_MAG_FILTER,h.NEAREST);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST);h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,sa);h.texImage2D(h.TEXTURE_2D,0,h.RGBA,L,k,0,h.RGBA,h.FLOAT,da);h.bindTexture(h.TEXTURE_2D,null);h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,!1);ya&&(ia.R(),A.set("s0"));h.viewport(0,0,L,k);h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,M,0);h.bindTexture(h.TEXTURE_2D,oa);ya?ja.i(!0,!0):Z.Aa(h);h.deleteTexture(oa);H&&(v[0]=-1,m=null,u=0)},instance:function(h){function M(y){var N=
b.getError();if("FUCKING_BIG_ERROR"===N)return!1;b.texImage2D(b.TEXTURE_2D,0,ea,ca,fa,y);N=b.getError();N!==b.NO_ERROR&&ca!==b.RGBA&&(ca=b.RGBA,b.texImage2D(b.TEXTURE_2D,0,ea,ca,fa,y));return!0}function L(){if(!yb){a(pa);ta&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,ta);k.isPot?(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,k.isMirrorX?b.MIRRORED_REPEAT:b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,k.isMirrorY?b.MIRRORED_REPEAT:b.REPEAT)):(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),
b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE));k.isAnisotropicFiltering&&"undefined"!==typeof JESETTINGS&&b.texParameterf(b.TEXTURE_2D,JEContext.ce().TEXTURE_MAX_ANISOTROPY_EXT,JESETTINGS.Gd);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,k.isLinear?b.LINEAR:b.NEAREST);k.isLinear?b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,k.isMipmap&&!Ha?b.NEAREST_MIPMAP_LINEAR:b.LINEAR):b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,k.isMipmap&&!Ha?b.NEAREST_MIPMAP_NEAREST:b.NEAREST);
ca=g[k.Ja-1];ea=C[k.Ja-1];fa=x[sa];if(ba.W()){var y=b.RGBA32F;ca===b.RGBA&&fa===b.FLOAT?k.isMipmap||k.isLinear?ea=Da.Tc(b):ba.Kb()?y&&(ea=y):ea=b.RGBA16F||b.RGBA:ca===b.RGB&&fa===b.FLOAT&&y&&(ea=y,ca=b.RGBA)}if(k.G&&!k.isFloat||k.isFloat&&k.isMipmap&&Da.fd())(y=b.RGBA16F)&&(ea=y),fa=ba.ib(b);k.qb&&($a=k.qb);k.isSrgb&&4===k.Ja&&(ca=JEContext.le());if(k.s)M(k.s);else if(k.url)M(Fa);else if(ua){y=ua;try{"FUCKING_BIG_ERROR"!==b.getError()&&(b.texImage2D(b.TEXTURE_2D,0,ea,O,Q,0,ca,fa,y),b.getError()!==
b.NO_ERROR&&(b.texImage2D(b.TEXTURE_2D,0,ea,O,Q,0,ca,fa,null),b.getError()!==b.NO_ERROR&&b.texImage2D(b.TEXTURE_2D,0,b.RGBA,O,Q,0,b.RGBA,b.UNSIGNED_BYTE,null)))}catch(Vb){b.texImage2D(b.TEXTURE_2D,0,ea,O,Q,0,ca,fa,null)}k.isKeepArray||(ua=null)}else y=b.getError(),"FUCKING_BIG_ERROR"!==y&&(b.texImage2D(b.TEXTURE_2D,0,ea,O,Q,0,ca,fa,null),y=b.getError(),y!==b.NO_ERROR&&(ca=b.RGBA,k.G&&fa!==b.FLOAT&&(fa=b.FLOAT,b.texImage2D(b.TEXTURE_2D,0,ea,O,Q,0,ca,fa,null))));if(k.isMipmap)if(!Ha&&V)V.hb(),ab=!0;
else if(Ha){y=Math.log2(Math.min(O,Q));Qa=Array(1+y);Qa[0]=pa;for(var N=1;N<=y;++N){var ha=Math.pow(2,N),T=O/ha;ha=Q/ha;var Ia=b.createTexture();a(Ia);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texImage2D(b.TEXTURE_2D,0,ea,T,ha,0,ca,fa,null);a(null);Qa[N]=Ia}ab=!0}a(null);v[u]=-1;ta&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1);bb=!0;k.Z&&V&&(k.Z(V),k.Z=null)}}var k=Object.assign({},n,h),da=f++;null===k.isFlipY&&(k.isFlipY=
k.url||k.array?!0:!1);k.data&&(k.array="string"===typeof k.data?Fb(k.data):k.isFloat?new Float32Array(k.data):new Uint8Array(k.data),k.isFlipY=!1);var sa=0,ya=k.s?!0:!1,oa=null,jb=null,zb=!1,kb=null;k.G=k.G||k.isFloat;k.G&&(sa=1);k.bd||ba.W()||!k.isFloat||!E||ba.Kb()||(k.isFloat=!1);k.isFloat&&(sa=2);k.isAnisotropicFiltering&&l&&!JEContext.qe()&&(k.isAnisotropicFiltering=!1);var pa=b.createTexture(),Fa=null,ua=!1,O=0,Q=0,bb=!1,yb=!1,cb=!1,va=null,za=null,lb=null,Ua=null,ea=null,ca=null,fa=null,ta=
k.isFlipY,Kb=(h=k.G&&k.isMipmap)&&Da.Fc(),Ha=h&&Kb?!0:!1,Qa=null,$a=-1,ab=!1,Ja={hc:!1,Ib:null,Wb:null};k.width&&(O=k.width,Q=k.height?k.height:O);var V={get:function(){return pa},B:function(){return O},U:function(){return Q},pe:function(){return k.url},re:function(){return k.isFloat},te:function(){return k.G},ue:function(){return k.isLinear},hb:function(){b.generateMipmap(b.TEXTURE_2D)},Dc:function(y,N){Ha?(y||(y=V.Zb()),V.Za(N),a(Qa[y]),v[N]=-1):V.c(N)},Zb:function(){-1===$a&&($a=Math.log(O)/Math.log(2));
return $a},Pc:function(y){if(Ha){y||(y=V.Zb());A.set("s11");V.Za(0);for(var N=O,ha=Q,T=1;T<=y;++T)N/=2,ha/=2,A.na("u7",.25/N,.25/ha),b.viewport(0,0,N,ha),a(Qa[T-1]),b.framebufferTexture2D(ia.Da(),b.COLOR_ATTACHMENT0,b.TEXTURE_2D,Qa[T],0),ja.i(!1,1===T);v[0]=-1}else V.hb()},Za:function(y){y!==u&&(b.activeTexture(p[y]),u=y)},c:function(y){if(!bb)return!1;V.Za(y);if(v[y]===da)return!1;a(pa);v[y]=da;return!0},Hb:function(y){b.activeTexture(p[y]);u=y;a(pa);v[y]=da},m:function(){m=V;b.framebufferTexture2D(ia.Da(),
b.COLOR_ATTACHMENT0,b.TEXTURE_2D,pa,0)},ba:function(){m=V;b.viewport(0,0,O,Q);b.framebufferTexture2D(ia.Da(),b.COLOR_ATTACHMENT0,b.TEXTURE_2D,pa,0)},Bb:G.Bb,resize:function(y,N){O=y;Q=N;L()},clone:function(y){y=G.instance({width:O,height:Q,G:k.G,isFloat:k.isFloat,isLinear:k.isLinear,isMirrorY:k.isMirrorY,isFlipY:y?!ta:ta,isPot:k.isPot});ra.set("s0");ia.R();y.m();b.viewport(0,0,O,Q);V.c(0);ja.i(!0,!0);return y},yd:function(){b.viewport(0,0,O,Q)},remove:function(){b.deleteTexture(pa);yb=!0;B.splice(B.indexOf(V),
1);V=null},refresh:function(){V.Hb(0);ta&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!0);ya?b.texImage2D(b.TEXTURE_2D,0,ea,ca,b.UNSIGNED_BYTE,k.s):b.texImage2D(b.TEXTURE_2D,0,ea,O,Q,0,ca,fa,ua);ta&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1)},Mb:function(){var y=O*Q*4;za=[new Uint8Array(y),new Uint8Array(y),new Uint8Array(y),new Uint8Array(y)];va=[new Float32Array(za[0].buffer),new Float32Array(za[1].buffer),new Float32Array(za[2].buffer),new Float32Array(za[3].buffer)];lb=new Uint8Array(4*y);Ua=new Float32Array(lb.buffer);
cb=!0},pc:function(){cb||V.Mb();b.readPixels(0,0,O,4*Q,b.RGBA,b.UNSIGNED_BYTE,lb);for(var y=O*Q,N=2*y,ha=3*y,T=0;T<y;++T)va[0][T]=Ua[T],va[1][T]=Ua[T+y],va[2][T]=Ua[T+N],va[3][T]=Ua[T+ha];return va},rd:function(){Ja.hc||(Ja.Ib=new Uint8Array(O*Q*4),Ja.Wb=new Float32Array(Ja.buffer),Ja.hc=!0);b.readPixels(0,0,O,Q,b.RGBA,b.UNSIGNED_BYTE,Ja.Ib);return Ja.Wb},Nb:function(y){ia.J();A.set("s12");V.c(0);if(y)b.viewport(0,0,O,Q),A.oa("u8",.25,.25,.25,.25),ja.i(!1,!0);else for(y=0;4>y;++y)b.viewport(0,Q*y,
O,Q),A.oa("u8",q[y]),ja.i(!1,0===y)},xc:function(y){var N=fa===x[0]&&!r();a(pa);ta&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!0);N?(zb||(oa=document.createElement("canvas"),oa.width=O,oa.height=Q,jb=oa.getContext("2d"),kb=jb.createImageData(O,Q),zb=!0),kb.data.set(y),jb.putImageData(kb,0,0),b.texImage2D(b.TEXTURE_2D,0,ea,ca,fa,oa)):b.texImage2D(b.TEXTURE_2D,0,ea,O,Q,0,ca,fa,y);v[u]=da;ta&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1)},Pe:function(y,N){a(pa);N&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!0);b.texImage2D(b.TEXTURE_2D,
0,ea,ca,fa,y);v[u]=da;N&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1)},De:function(y,N){var ha=O*Q,T=4*ha;y=k.G?y?"RGBE":"JSON":"RGBA";N&&(y=N);N=ba.W()&&!1;var Ia=null;switch(y){case "RGBE":Ia="s42";break;case "JSON":Ia=N?"s0":"s12";break;case "RGBA":case "RGBAARRAY":Ia="s6"}cb||("RGBA"===y||"RGBE"===y||"RGBAARRAY"===y?(za=new Uint8Array(T),cb=!0):"JSON"!==y||N||V.Mb());ia.J();A.set(Ia);V.c(0);T=null;if("RGBA"===y||"RGBE"===y||"RGBAARRAY"===y){b.viewport(0,0,O,Q);ja.i(!0,!0);b.readPixels(0,0,O,Q,b.RGBA,
b.UNSIGNED_BYTE,za);if("RGBAARRAY"===y)return{data:za};w||(F=document.createElement("canvas"),I=F.getContext("2d"),w=!0);F.width=O;F.height=Q;ha=I.createImageData(O,Q);ha.data.set(za);I.putImageData(ha,0,0);T=F.toDataURL("image/png")}else if("JSON"===y)if(N)T=new Float32Array(ha),b.viewport(0,0,O,Q),ja.i(!0,!0),b.readPixels(0,0,O,Q,b.RGBA,b.FLOAT,T);else{for(T=0;4>T;++T)b.viewport(0,Q*T,O,Q),A.oa("u8",q[T]),ja.i(!T,!T);V.pc();T=Array(ha);for(N=0;N<ha;++N)T[4*N]=va[0][N],T[4*N+1]=va[1][N],T[4*N+2]=
va[2][N],T[4*N+3]=va[3][N]}return{format:y,data:T,width:O,height:Q,isMirrorY:k.isMirrorY,isFlipY:"RGBA"===y?k.isFlipY:!k.isFlipY}}};k.isMipmap&&!Ha&&bb&&!ab&&(V.hb(),ab=!0);if(k.url)a(pa),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,1,1,0,b.RGBA,b.UNSIGNED_BYTE,null),Fa=new Image,Fa.Pd="Anonymous",Fa.crossOrigin="Anonymous",Fa.src=k.url,Fa.onload=function(){O=Fa.width;Q=Fa.height;L()};else if(k.s){var Ab=function(){O=void 0!==k.s.videoWidth?k.s.videoWidth:k.s.width;Q=void 0!==k.s.videoHeight?k.s.videoHeight:
k.s.height;O?L():setTimeout(Ab,1)};Ab()}else k.array?(k.G&&!k.isFloat?k.array instanceof Uint16Array?(ua=k.array,L()):e()?(ua=d(k.array),L()):(L(),G.Vb(b,pa,V.B(),V.U(),k.array,ta,!0)):(ua=k.isFloat?k.array instanceof Float32Array?k.array:new Float32Array(k.array):k.array instanceof Uint8Array?k.array:new Uint8Array(k.array),L()),k.isKeepArray||(ua&&ua!==k.array&&(ua=null),delete k.array)):L();V.ke=V.B;k.Z&&bb&&(k.Z(V),k.Z=null);B.push(V);return V},J:function(h){h!==u&&(b.activeTexture(p[h]),u=h);
v[h]=-1;a(null)},Id:function(h){z.random.c(h)},Bb:function(){m=null;b.framebufferTexture2D(ia.Da(),b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,0)},reset:function(){for(var h=0;h<p.length;++h)v[h]=-1;u=-1},Ce:function(){u=-1},Bd:function(){for(var h=0;h<p.length;++h)G.J(h)},Xb:function(){z&&(z.random.remove(),z.wc.remove())},Ne:function(h,M){if("RGBA"===h.format||"RGBE"===h.format){var L=new Image;L.src=h.data;L.onload=function(){G.instance({isMirrorY:h.isMirrorY,isFlipY:h.isFlipY,isFloat:!1,s:L,Z:function(k){if("RGBA"===
h.format)M(k);else{var da=h.width,sa=h.height,ya=G.instance({isMirrorY:h.isMirrorY,isFloat:!0,width:da,height:sa,isFlipY:h.isFlipY});ia.R();b.viewport(0,0,da,sa);A.set("s43");ya.m();k.c(0);ja.i(!0,!0);G.J(0);M(ya);b.flush();setTimeout(k.remove,50)}}})}}else"JSON"===h.format?M(G.instance({isFloat:!0,isFlipY:h.isFlipY,width:h.width,height:h.height,array:new Float32Array(h.data)})):M(!1)},j:function(){m&&(Ea.R(),G.Bb(),Ea.J());G.Bd();B.slice(0).forEach(function(h){h.remove()});B.splice(0);H=!1;f=0;"undefined"!==
typeof Da&&Da.j()}};return G}(),ja=function(){function a(f){var v={P:null,C:null};v.P=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,v.P);f.bufferData(f.ARRAY_BUFFER,new Float32Array([-1,-1,3,-1,-1,3]),f.STATIC_DRAW);v.C=f.createBuffer();f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,v.C);f.bufferData(f.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2]),f.STATIC_DRAW);return v}var c=null,d=0,e=!1,r=[],t=-2,u=-2,p={reset:function(){u=t=-2},o:function(){e||(c=a(b),p.ab(),e=!0)},instance:function(f){var v=d++,z=f.C?f.C.length:
0,m="undefined"===typeof f.mode?b.STATIC_DRAW:f.mode,x=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,x);b.bufferData(b.ARRAY_BUFFER,f.P instanceof Float32Array?f.P:new Float32Array(f.P),m);t=v;var g=null,C=null,H=null;if(f.C){g=b.createBuffer();b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,g);var B=null;65536>f.C.length?(B=Uint16Array,C=b.UNSIGNED_SHORT,H=2):(B=Uint32Array,C=b.UNSIGNED_INT,H=4);B=f.C instanceof B?f.C:new B(f.C);b.bufferData(b.ELEMENT_ARRAY_BUFFER,B,m);u=v}var n={Ec:function(w){t!==v&&(b.bindBuffer(b.ARRAY_BUFFER,
x),t=v);w&&ra.yb()},Bc:function(){u!==v&&(b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,g),u=v)},bind:function(w){n.Ec(w);n.Bc()},Rd:function(){b.drawElements(b.TRIANGLES,z,C,0)},Sd:function(w,F){b.drawElements(b.TRIANGLES,w,C,F*H)},remove:function(){b.deleteBuffer(x);f.C&&b.deleteBuffer(g);n=null}};r.push(n);return n},ab:function(){-1!==t&&(b.bindBuffer(b.ARRAY_BUFFER,c.P),t=-1);-1!==u&&(b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c.C),u=-1)},i:function(f,v){f&&ja.ab();v&&ra.Sa();b.drawElements(b.TRIANGLES,3,b.UNSIGNED_SHORT,
0)},Aa:function(f){f=f||b;var v=a(f);f.bindBuffer(f.ARRAY_BUFFER,v.P);f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,v.C);ra.Ta(f);f.drawElements(f.TRIANGLES,3,f.UNSIGNED_SHORT,0);f.deleteBuffer(v.P);f.deleteBuffer(v.C);p.reset();e&&(p.ab(),ra.Sa())},Xb:function(){var f=b,v=c;f.deleteBuffer(v.P);f.deleteBuffer(v.C)},j:function(){p.Xb();r.forEach(function(f){f.remove()});b.bindBuffer(b.ARRAY_BUFFER,null);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,null);p.reset();e=!1;r.splice(0);d=0}};return p}(),ia=function(){var a=
null,c=null,d=null,e=!1,r=[],t={u:-2,Ub:1},u={Ga:function(){return e},o:function(){if(!e){a=b.createFramebuffer();var p=ba.W();c=p&&b.DRAW_FRAMEBUFFER?b.DRAW_FRAMEBUFFER:b.FRAMEBUFFER;d=p&&b.READ_FRAMEBUFFER?b.READ_FRAMEBUFFER:b.FRAMEBUFFER;e=!0}},de:function(){return c},Uc:function(){return d},Da:function(){return b.FRAMEBUFFER},je:function(){return t},Vd:function(){return a},instance:function(p){void 0===p.dc&&(p.dc=!1);var f=p.F?p.F:null,v=p.width,z=void 0!==p.height?p.height:p.width,m=a,x=null,
g=!1,C=!1,H=0;f&&(v=v?v:f.B(),z=z?z:f.U());var B={tc:function(){g||(m=b.createFramebuffer(),g=!0,H=t.Ub++)},yc:function(){B.tc();B.m();x=b.createRenderbuffer();b.bindRenderbuffer(b.RENDERBUFFER,x);b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT16,v,z);b.framebufferRenderbuffer(c,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,x);b.clearDepth(1)},bind:function(n,w){H!==t.u&&(b.bindFramebuffer(c,m),t.u=H);f&&f.m();w&&b.viewport(0,0,v,z);n&&b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT)},Hd:function(){H!==
t.u&&(b.bindFramebuffer(c,m),t.u=H)},clear:function(){b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT)},Md:function(){b.clear(b.COLOR_BUFFER_BIT)},Nd:function(){b.clear(b.DEPTH_BUFFER_BIT)},yd:function(){b.viewport(0,0,v,z)},m:function(){H!==t.u&&(b.bindFramebuffer(c,m),t.u=H)},rtt:function(n){f=n;t.u!==H&&(b.bindFramebuffer(b.FRAMEBUFFER,m),t.u=H);n.m()},J:function(){b.bindFramebuffer(c,null);t.u=-1},resize:function(n,w){v=n;z=w;x&&(b.bindRenderbuffer(b.RENDERBUFFER,x),b.renderbufferStorage(b.RENDERBUFFER,
b.DEPTH_COMPONENT16,v,z))},remove:function(){m===a||C||(b.bindFramebuffer(c,m),b.framebufferTexture2D(c,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,0),x&&b.framebufferRenderbuffer(c,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,null),b.bindFramebuffer(c,null),b.deleteFramebuffer(m),x&&b.deleteRenderbuffer(x));C=!0}};p.dc&&B.yc();r.push(B);return B},J:function(){b.bindFramebuffer(c,null);t.u=-1},Cd:function(){b.bindFramebuffer(c,null);b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT);b.viewport(0,0,ba.B(),ba.U());t.u=
-1},reset:function(){t.u=-2},R:function(){0!==t.u&&(b.bindFramebuffer(c,a),t.u=0)},clear:function(){b.viewport(0,0,ba.B(),ba.U());b.clear(b.COLOR_BUFFER_BIT)},j:function(){u.J();r.forEach(function(p){p.remove()});b.deleteFramebuffer(a);u.reset();e=!1;r.splice(0);t.u=-2;t.Ub=1}};return u}(),ba=function(){function a(){d="undefined"===typeof Za?JEContext:Za;e=!0}function c(n,w){for(var F=0;F<n.length;++F){var I=w.getExtension(n[F]);if(I)return I}return null}var d=null,e=!1,r=!1,t=null,u=null,p=!1,f=
null,v=!1,z=null,m=!1,x=null,g=null,C={T:!0,V:!0,gb:!0},H="undefined"===typeof window?{}:window,B={o:function(){if(e)return!0;a();var n=b;if(!r){t=B.Rb(n);if((p=(H.GL_EXT_FLOAT=t)?!0:!1)||B.W())u=B.Sb(n),H.GL_EXT_FLOATLINEAR=u;r=!0}if(!m){if(f=B.za(n))v=!0,H.GL_EXT_HALFFLOAT=f;if(v||B.W())z=B.Tb(n),H.GL_EXT_HALFFLOATLINEAR=z;m=!0}x=B.Pb(n);H.GL_EXT_COLORBUFFERFLOAT=x;g=B.Qb(n);H.GL_EXT_COLORBUFFERHALFFLOAT=g;ia.o();Ka.o();if(!B.Jc())return!1;ja.o();Ka.ad();return!0},B:function(){e||a();return d.B()},
U:function(){e||a();return d.U()},W:function(){e||a();return d.W()},Ob:function(n){B.Pb(n);B.Qb(n);B.Rb(n);B.Sb(n);B.za(n);B.Tb(n)},Pb:c.bind(null,["EXT_color_buffer_float","WEBGL_color_buffer_float","OES_color_buffer_float"]),Qb:c.bind(null,["EXT_color_buffer_half_float","WEBGL_color_buffer_half_float","OES_color_buffer_half_float"]),Rb:c.bind(null,["OES_texture_float","MOZ_OES_texture_float","WEBKIT_OES_texture_float"]),Sb:c.bind(null,["OES_texture_float_linear","MOZ_OES_texture_float_linear","WEBKIT_OES_texture_float_linear"]),
za:c.bind(null,["OES_texture_half_float","MOZ_OES_texture_half_float","WEBKIT_OES_texture_half_float"]),Tb:c.bind(null,["OES_texture_half_float_linear","MOZ_OES_texture_half_float_linear","WEBKIT_OES_texture_half_float_linear"]),ib:function(n){var w=B.za(n);return w&&w.HALF_FLOAT_OES?w.HALF_FLOAT_OES:n.HALF_FLOAT||n.FLOAT},Rc:function(){return C},Kb:function(){return C.T},Kd:function(){return C.V},Jd:function(){return C.gb},Ua:function(n,w,F){function I(){n.bindTexture(n.TEXTURE_2D,null);n.bindFramebuffer(q,
null);n.deleteTexture(K);n.deleteFramebuffer(E)}var q=n.FRAMEBUFFER,l=n.NEAREST,E=n.createFramebuffer();n.bindFramebuffer(q,E);var K=n.createTexture();n.bindTexture(n.TEXTURE_2D,K);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,l);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,l);n.texImage2D(n.TEXTURE_2D,0,w,1,1,0,n.RGBA,F,null);n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,K,0);if(n.checkFramebufferStatus(n.READ_FRAMEBUFFER||n.FRAMEBUFFER)!==n.FRAMEBUFFER_COMPLETE)return I(),
!1;ra.xb(n);n.clearColor(0,0,0,0);n.viewport(0,0,1,1);n.disable(n.DEPTH_TEST);n.clear(n.COLOR_BUFFER_BIT);ja.Aa(n);n.bindFramebuffer(q,null);ra.Ra(n);n.activeTexture(n.TEXTURE0);n.bindTexture(n.TEXTURE_2D,K);ja.Aa(n);w=new Uint8Array(4);n.readPixels(0,0,1,1,n.RGBA,n.UNSIGNED_BYTE,w);I();return 3<Math.abs(w[0]-127)?!1:!0},eb:function(n){var w={T:!1,V:!1};n.disable(n.BLEND);n.clearColor(0,0,0,0);n.clear(n.COLOR_BUFFER_BIT);n.RGBA32F&&B.Ua(n,n.RGBA32F,n.FLOAT)&&(w.T=!0);!w.T&&B.Ua(n,n.RGBA,n.FLOAT)&&
(w.T=!0);var F=B.ib(n);n.RGBA16F&&B.Ua(n,n.RGBA16F,F)&&(w.V=!0);!w.V&&B.Ua(n,n.RGBA,F)&&(w.V=!0);return w},Kc:function(){var n=ia.instance({width:1});n.tc();var w=Ka.instance({width:1,isFloat:!0,Ja:3});n.m();w.m();b.flush();b.checkFramebufferStatus(ia.Uc())!==b.FRAMEBUFFER_COMPLETE?(Ka.vd(),C.gb=!1):C.gb=!0;n.remove();w.remove()},Jc:function(){var n=B.eb(b);Object.assign(C,n);if(!C.T&&!C.V)return!1;B.Kc();return!0},j:function(){Ka.j();ra.j();ia.j();ja.j();e=!1}};return B}(),Z=ja,Ea=ia,W=Ka,Da=function(){function a(w,
F,I,q){g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,q?g.NEAREST_MIPMAP_NEAREST:g.LINEAR);var l=null;if(null!==I)try{l=g.getError();if("FUCKING_BIG_ERROR"===l)return!1;g.texImage2D(g.TEXTURE_2D,0,w,2,2,0,g.RGBA,F,I);l=g.getError();if(l!==g.NO_ERROR)return!1}catch(E){return!1}q&&g.generateMipmap(g.TEXTURE_2D);g.clear(g.COLOR_BUFFER_BIT);Z.Aa(g);l=g.getError();if("FUCKING_BIG_ERROR"===l)return!1;g.readPixels(0,0,1,1,g.RGBA,g.UNSIGNED_BYTE,z);l=g.getError();l===g.INVALID_OPERATION&&"undefined"!==
typeof g.PIXEL_PACK_BUFFER&&(g.bindBuffer(g.PIXEL_PACK_BUFFER,null),g.readPixels(0,0,1,1,g.RGBA,g.UNSIGNED_BYTE,z),l=g.getError());if(l!==g.NO_ERROR)return!1;if(I=0!==z[0])f.oc=F,f.cc=w;return I}function c(w,F){return C.T&&a(w,g.FLOAT,new Float32Array(x),F)?(p=u.Eb,!0):!1}function d(w,F,I){if(!C.V)return!1;var q=ba.za(g);if(q&&q.HALF_FLOAT_OES&&a(w,q.HALF_FLOAT_OES,new Uint16Array(x),F)||g.HALF_FLOAT&&a(w,g.HALF_FLOAT,new Uint16Array(x),F)||a(w,g.FLOAT,new Float32Array(x),F))return p=u.ga,!0;g.bindTexture(g.TEXTURE_2D,
I);g.texImage2D(g.TEXTURE_2D,0,g.RGBA,1,1,0,g.RGBA,g.UNSIGNED_BYTE,null);g.bindFramebuffer(f.xa,n);Ka.Vb(g,I,1,1,new Float32Array(x),!1,!1);g.bindFramebuffer(f.xa,null);g.bindTexture(g.TEXTURE_2D,I);return a(w,null,null,F)?(p=u.ga,!0):!1}function e(w,F,I){v=!0;if(d(w,!0,I)||c(F,!0))return!0;v=!1;return d(w,!1,I)||c(F,!1)?!0:!1}function r(w){if(p===u.K){g=w||b;p=u.RGBA8;v=!0;ba.Ob(g);C||(C=ba.eb(g));Ea.reset();n=g.createFramebuffer();f.xa=g.DRAW_FRAMEBUFFER||g.FRAMEBUFFER;g.bindFramebuffer(f.xa,null);
g.clearColor(0,0,0,0);g.viewport(0,0,1,1);A.K();H=A.Ra(g);w=g.createTexture();g.activeTexture(g.TEXTURE0);g.bindTexture(g.TEXTURE_2D,w);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.REPEAT);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.REPEAT);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.NEAREST);B=w;var F=w=g.RGBA,I=g.RGBA16F,q=g.RGBA32F;q&&(w=q);I&&(F=I);if((I||q)&&e(F,w,B))return t(),!0;w=F=g.RGBA;if(e(F,w,B))return t(),!0;p=u.RGBA8;t();return!1}}function t(){g.deleteProgram(H.aa);g.deleteTexture(B);
B=H=null}var u={K:-1,Eb:3,ga:2,RGBA8:0},p=u.K,f={oc:null,cc:null,xa:null},v=!0,z=new Uint8Array(4),m=[.8,1,.8,1],x=m.concat(m,m,m),g=null,C=null,H=null,B=null,n=null;return{Fc:function(w){r(w);return v},Jb:function(w,F){p===u.K&&(typeof("undefined"!==F)&&(C=F),r(w));return p!==u.RGBA8},se:function(w){r(w);return p===u.Eb},fd:function(w){r(w);return p===u.ga},ee:function(w){r(w);return f.oc},Tc:function(w){r(w);return f.cc},j:function(){g=null;v=!0;p=u.K;C=null}}}(),Lb=function(){return{instance:function(a){var c=
W.instance(a.alpha),d=W.instance(a.beta);return{Nc:function(){c.c(1);d.c(2)}}}}}(),Db=function(){return{instance:function(a){var c=null,d=!1,e=!1,r=null,t=!1,u=!1,p=null,f="undefined"===typeof a.preprocessing?!1:a.preprocessing,v="undefined"===typeof a.preprocessingSize?a.size:a.preprocessingSize;a.mask&&(d=!0,SETTINGS&&void 0!==SETTINGS.Ac&&(a.mask=SETTINGS.Ac+a.mask),c=W.instance({isFloat:!1,url:a.mask}));var z=!1;a.customInputShader&&(z="s44",A.Fb({name:"_",id:z,a:a.customInputShader,b:["uSource"],
precision:"lowp"}),A.D(z,[{type:"1i",name:"_",value:0}]));switch(f){case "sobel":p="s31";t=!0;break;case "meanNormalization":p="s32";t=!0;break;case "grayScale":p="s28";t=!1;break;case "grayScaleTilt":p="s29";u=!0;t=!1;break;case "rgbGrayTilt":p="s30";u=!0;t=!1;break;case "copy":p=z?z:"s0";break;case "inputLightRegulation":p=z?z:"s28";r=Mb.instance({bc:v,nc:a.size,jc:a.nBlurPass,ed:!1});e=!0;break;case "direct":case "none":p=!1;break;default:p="s3"}u&&A.D(p,[{name:"u26",type:"1f",value:a.tilt}]);
d&&(p+="Mask");var m=W.instance({isFloat:!1,isPot:!1,width:a.size}),x={B:function(){return v},jb:function(){return x.B()},Yc:function(){return e?r.$b():m},I:function(){Ea.R();p&&(A.set(p),t&&A.M("u27",1/a.size),m.ba(),d&&c.c(1),Z.i(!1,!1),m.c(0),e&&r.process(m))},j:function(){m.remove();d&&c.remove()}};return x}}}(),Eb=function(){return{instance:function(a){"undefined"===typeof a.disableNormalize&&(a.disableNormalize=!1);var c={input:null,ta:null,ob:null,O:null,Na:null,ub:null,vb:null},d=null,e=[],
r=[],t=!1,u=null,p=!0,f=-1,v=a.isReorganize?a.isReorganize:!1,z=a.kernelsNumber?!0:!1,m=a.dynPelu?Lb.instance(a.dynPelu):!1,x=m?!0:!1,g={isEnabled:!1};a.dd?(a.sparsity="undefined"!==typeof a.sparsity?a.sparsity:a.Pa.jb(),p=!1):"full"===a.connectivityUp&&(a.sparsity=a.Pa.jb());var C={elu:"s15",elu01:"s16",relu:"s14",arctan:"s18",sigmoid:"s13",copy:"s0",softplus:"s19",dynPelu:"s17"}[a.activation],H=a.sparsity*a.sparsity,B=!1,n=a.size,w="";if(a.maxPooling){switch(a.maxPooling.size){case 2:w="s33";break;
case 4:w="s34"}B=!0;n/=a.maxPooling.size;c.ub=W.instance({isFloat:!0,isPot:!1,width:n})}var F=void 0!==a.md&&a.md?!0:!1,I=null,q=null,l=null;if(F){I="s45"+a.index.toString();A.ac("s45",I,[((a.normalization.n-1)/2).toFixed(1)]);A.D(I,[{type:"1i",name:"u1",value:0},{type:"2f",name:"u7",value:[1/a.size,1/a.size]},{type:"1f",name:"u6",value:a.normalization.alpha},{type:"1f",name:"u9",value:a.normalization.beta},{type:"1f",name:"u31",value:a.normalization.k}]);var E={isFloat:!0,isPot:!0,width:a.size};
q=W.instance(E);l=W.instance(E)}var K=-1,X=null;p&&(c.O=W.instance({isFloat:!0,isPot:!1,width:a.size}));c.ta=W.instance(a.bias);var na={B:function(){return a.size},jb:function(){return n},Yb:function(){return a.classesCount},Cc:function(G){d.c(G)},pd:function(){a.remap&&a.remap.isEnabled&&(g={isEnabled:!0,jd:W.instance({isFloat:!1,isFlipY:!1,array:new Uint8Array(a.remap.maskTexture.data),width:a.remap.maskTexture.width,isPot:!1}),Ha:a.remap.layers.map(function(G){return a.parent.Wc(G)}),depth:a.remap.depth})},
wd:function(){switch(a.connectivityUp){case "direct":X=Nb.instance(a.connectivity);break;case "square":X=Ob.instance(a.connectivity);break;case "squareFast":X=Pb.instance(a.connectivity,a.activation);break;case "full":X=Qb.instance(a.connectivity);break;case "conv":f=a.kernelsNumber,X=Rb.instance(a.connectivity),v&&(c.Na=W.instance({width:n,isFloat:!0,isFlipY:!1,isPot:!1}))}if(X.ea){var G=a.size*a.sparsity;K=Math.log(G/a.size)/Math.log(2);c.input=W.instance({isMipmap:!0,isFloat:!0,isPot:!0,width:G,
qb:K});c.ob=W.instance({isFloat:!0,isPot:!0,width:a.size})}},I:function(G){d=G;X.ea?(c.input.ba(),z&&c.ta.c(2),X.I(g),c.input.c(0),c.input.Pc(K),c.ob.ba(),z?A.set("s0"):(A.set("s27"),A.M("u25",H),c.ta.c(1)),c.input.Dc(K,0),Z.i(!1,!1),A.set(C),F?q.m():c.O.m(),c.ob.c(0),x&&m.Nc(),Z.i(!1,!1)):(c.O.ba(),c.ta.c(1),X.I());F&&(A.set(I),l.m(),q.c(0),Z.i(!1,!1),A.set("s46"),A.M("u6",1),c.O.m(),l.c(1),Z.i(!1,!1));if(p)return B?(c.ub.ba(),c.O.c(0),A.set(w),A.na("u7",1/a.size,1/a.size),Z.i(!1,!1),G=c.ub):G=c.O,
G.c(0),v&&(c.Na.m(),A.set("s21"),A.na("u12",f,n/f),Z.i(!1,!1),G=c.Na,c.Na.c(0)),G;G=c.O;a.disableNormalize||(A.set("gpuRawAvg"===t?"s8":"s7"),A.M("u4",1/a.size),c.vb.ba(),c.O.c(0),Z.i(!1,!1),G=c.vb);switch(t){case "cpuRGBA2Float":G.Nb(!1);G=na.qd(G);u(G);break;case "cpuMeanFloat":G.Nb(!0);G=G.rd();u(G);break;case "gpuRawAvg":case "gpuRaw":G.c(0);case "none":null!==u&&u(G)}return!1},Hc:function(G){G&&(t=G.wb||"none",u=G.tb||null);c.O=W.instance({isFloat:!0,isPot:!0,isMipmap:!1,width:a.size});G="undefined"!==
typeof a.classesCount&&a.classesCount?a.classesCount:a.size*a.size;for(var h=0,M=0,L=0;h<G;++h)e.push(M+(a.size-1-L)*a.size),r.push([-1,-1,-1,-1]),++M,M===a.size&&(M=0,++L);a.disableNormalize||(c.vb=W.instance({isFloat:!0,isPot:!0,width:a.size}))},qd:function(G){var h=G.pc();e.forEach(function(M,L){r[L][0]=h[0][M];r[L][1]=h[1][M];r[L][2]=h[2][M];r[L][3]=h[3][M]});return r},j:function(){for(var G in c){var h=c[G];h&&h.remove()}X&&(X.j(),X=null)}};a.Pa&&na.wd(a.Pa);return na}}}(),Nb=function(){return{instance:function(a){var c=
W.instance(a.weights);delete a.weights.data;return{ea:!0,Ca:function(){return 1},j:function(){c.remove()},$c:function(){return c},I:function(){A.set("s26");c.c(1);Z.i(!1,!1)}}}}}(),Qb=function(){return{instance:function(a){var c=a.fromLayerSize,d=W.instance(a.weights);delete a.weights.data;return{ea:!0,Ca:function(){return c},j:function(){d.remove()},I:function(e){if(e.isEnabled){A.set("s24");e.jd.c(3);var r,t=Math.min(e.Ha.length,e.depth);for(r=0;r<t;++r)e.Ha[r].Cc(4+r)}else A.set("s23");A.M("u16",
a.toLayerSize);d.c(1);Z.i(!1,!1)}}}}}(),Ob=function(){return{instance:function(a){for(var c=a.fromLayerSize,d=a.toLayerSize,e=a.toSparsity,r=e*d,t=r/c,u=c/d,p=0,f=0,v=0,z=Array(e*d*e*d*4),m=Array(e*d*e*d*4),x=Array(c*c),g=0;g<x.length;++g)x[g]=0;g=Math.floor(e/2);for(var C=.5/d,H=.5/c,B=.5/r,n=0;n<d;++n)for(var w=Math.round(n*u),F=0;F<d;++F){var I=Math.round(F*u),q=n/d,l=F/d;q+=C;l+=C;for(var E=0;E<e;++E){var K=w+E-g;0>K&&(K+=c);K>=c&&(K-=c);for(var X=0;X<e;++X){var na=p/r,G=f/r,h=I+X-g;0>h&&(h+=
c);h>=c&&(h-=c);var M=K/c,L=h/c;G=1-G-1/r;M+=H;L+=H;na+=B;G+=B;var k=n*e+E,da=F*e+X;da=d*e-da-1;k=da*d*e+k;z[4*k]=na;z[4*k+1]=G;z[4*k+2]=M;z[4*k+3]=L;L=x[h*c+K]++;k=L%t;M=K*t+k;h=h*t+(L-k)/t;h=c*t-1-h;h=h*c*t+M;m[4*h]=na;m[4*h+1]=G;m[4*h+2]=q;m[4*h+3]=l;++p>=r&&(p=0,++f);++v}}}x=null;var sa=W.instance(a.weights);delete a.weights.data;var ya=W.instance({width:r,isFloat:!0,array:new Float32Array(m),isPot:!0});m=null;var oa=W.instance({width:r,isFloat:!0,array:new Float32Array(z),isPot:!0});z=null;return{ea:!0,
Ca:function(){return t},j:function(){ya.remove();oa.remove();sa.remove()},I:function(){A.set("s22");sa.c(1);oa.c(2);Z.i(!1,!1)}}}}}(),Rb=function(){return{instance:function(a){var c=a.kernelsNumber,d=a.toSparsity,e=d*a.toLayerSize/a.fromLayerSize,r=W.instance(a.weights);delete a.weights.data;return{ea:!0,Ca:function(){return e},me:function(){return d},$c:function(){return r},j:function(){r.remove()},I:function(){A.set("s25");A.M("u22",c);A.M("u23",d);A.M("u16",a.toLayerSize);A.M("u24",a.fromLayerSize);
r.c(1);Z.i(!1,!1)}}}}}(),Pb=function(){return{instance:function(a,c){var d=a.fromLayerSize,e=a.toLayerSize,r=a.toSparsity,t=a.stride?a.stride:1,u=r*e/d,p=e<d,f=d/e,v=W.instance(a.weights);delete a.weights.data;var z="s47"+[d.toString(),e.toString(),r.toString(),t.toString(),c].join("_");A.Oc(z)||(a=Jb.Qc(c,"gl_FragColor","gl_FragColor"),e=[{type:"1f",name:"u16",value:e},{type:"1f",name:"u30",value:t}],p&&e.push({type:"1f",name:"u24",value:d}),d=[(p?u:r).toFixed(1),a],p&&d.push(f.toFixed(1)),A.ac(p?
"s39":"s38",z,d),A.D(z,e.concat([{type:"1i",name:"u14",value:0},{type:"1i",name:"u21",value:1},{type:"1i",name:"u13",value:3}])));return{ea:!1,Ca:function(){return u},j:function(){v.remove()},I:function(){A.set(z);v.c(3);Z.i(!1,!1)}}}}}(),Mb=function(){return{instance:function(a){var c=a.jc?a.jc:3,d=a.bc?a.bc:64,e=a.nc?a.nc:64,r=a.ed?!0:!1;a={isFloat:!1,width:d,isPot:!1,isFlipY:!1};var t=W.instance(a),u=W.instance(a),p=W.instance(a),f=W.instance(a),v=W.instance({isFloat:!0,width:e,isPot:!1,isFlipY:!1}),
z=1/d;return{process:function(m){A.set("s35");f.m();Z.i(r,!1);A.set("s36");for(var x=0;x<c;++x)t.m(),A.na("u7",z,0),Z.i(r,!1),p.m(),f.c(0),Z.i(r,!1),u.m(),t.c(0),A.na("u7",0,z),Z.i(r,!1),f.m(),p.c(0),Z.i(r,!1),x!==c-1&&u.c(0);A.set("s37");v.m();m.c(0);u.c(1);f.c(2);Z.i(r,!1);v.c(0)},$b:function(){return v}}}}}(),qb=function(){var a={kc:4,Oa:[1.5,1.5,2],Xa:[.1,.1,.1],rc:1,L:-1,H:-1,zd:2,nd:1,sc:!0},c=null,d=[],e=0,r=[.5,.5,1];return{o:function(t){c=Object.assign({},a,t);d.splice(0);t=c.Oa[0]*c.Xa[0];
var u=c.Oa[1]*c.Xa[1],p=1/(1+c.Oa[2]*c.Xa[2]),f=c.rc*Math.min(c.L,c.H),v=f/c.L;f/=c.H;for(var z=0;z<c.kc;++z){var m=Math.pow(p,z),x=v*m,g=f*m;m=x*t;var C=g*u,H=x/2;g/=2;for(var B=1+(1-H-H)/m,n=1+(1-g-g)/C,w=0;w<n;++w)for(var F=g+w*C,I=0;I<B;++I)d.push([H+I*m,F,x*c.nd])}c.sc&&d.sort(function(q,l){var E=q[0]-.5;q=q[1]-.5;var K=l[0]-.5;l=l[1]-.5;return E*E+q*q-(K*K+l*l)})},get:function(){var t=d.length;if(0===t)return r;e>=t&&(e=0);var u=d[Math.floor(e)];e=(e+1/c.zd)%t;return u}}}(),mb=function(){var a=
{n:5,rb:1,gd:0,Ba:[30,45],ya:[2,200],k:.7,Dd:200,od:.05},c=-1,d=null,e=-1,r=-1,t=0,u=-1,p=-1,f=0,v=0,z=a.ya[1],m={Xc:function(){switch(c){case -1:return-1;case 0:return p+d.gd;case 1:return f}},Xd:function(x){return Math.pow(Math.min(Math.max(u,0),d.n-1)/(d.n-1),x||1)},o:function(x){d=Object.assign({},a,x);u=p=d.rb;c=0},Ad:function(x){x=("undefined"===typeof x?Date.now():x)||0;var g=Math.min(Math.max(x-v,d.ya[0]),d.ya[1]);z=g;v=x;var C=-1===e?0:d.k;e=Math.min(Math.max(1E3/g,5),120)*(1-C)+e*C;x-r>
d.Dd&&5<++t&&(g=d.k,u=u*(1-g)+(e<d.Ba[0]?p-1:e>d.Ba[1]?p+1:p)*g,Math.abs(u-p)>1-d.od&&(g=Math.min(Math.max(Math.round(u),0),d.n-1),g!==p&&(u=p=g,e=(d.Ba[1]-d.Ba[0])/2)),r=x)},Ee:function(x){f=x;c=1},Oe:function(){c=0;m.reset()},reset:function(){z=a.ya[1];r=e=-1;t=0},be:function(){return z}};return m}(),Y={ua:512,S:[.05,.05,.15],sd:{nScaleLevels:3,scale0Factor:.8,overlapFactors:[2,2,3],scanCenterFirst:!0,scaleXRange:[1/15,.9]},kd:3,Ab:.68,Ma:10,Ia:.03,$:8,Va:-.02,va:.02,pa:.7,Ka:20,wa:.3,qa:[.02,10],
La:[1,6],ld:3},Ba=Object.create(Y.sd),hb=0,rb=0,ib=!1,S={width:-1,pb:!0,la:!1,Fa:!1,qc:null,zb:!1,pitchRange:null,S:Y.S},Pa=null,qa=null,Ra=!1,La=!1,wa=0,Sa=null,D=null,Sb={aspectRatio:1,nb:1,da:[1,1],L:0,H:0,Y:0,X:0,ka:"s49",A:{ja:[0,0],scale:[1,1]}},P={F:null,g:[0,0,0,0]},aa={sa:-2,LOADING:-1,ha:0,Ya:1,Db:2,ra:3},ma=aa.sa,Va=-2,xa=null;var sb=Wa=0;var Ta=-1;var U={n:0,lc:0,sb:0,v:-1,N:[0,0]},Ca={undefined:0,video:1,Lb:2,fb:3},J=null,Tb={current:0,element:null,F:null,fc:!1,type:Ca.undefined,time:-1,
ca:null},Bb=!1,la={distance:0,label:!1,positionScale:[0,0,0,0],detectScore:0,yaw:0,pitch:0,roll:0},gb=1,Ub={cutShader:null,thresholdDetectFactor:1,thresholdDetectFactorUnstitch:1,isSkipConfirmation:!1,isKeepTracking:!1,trackingFactors:[2,2,2],secondNeighborFactor:Y.pa,nLocateAutomoves:Y.Ma,locateMoveNoiseAmplitude:Y.Ia,nConfirmAutoMoves:Y.$,nConfirmUnstitchMoves:Y.Ka,confirmMoveNoiseAmplitude:Y.va,thresholdConfirmOffset:Y.Va,tiltPosAngleIfAmbiguousDetection:Y.qa,confirmScoreMinFactorDuringAutoMove:Y.wa},
ka={},R={Wa:1,uc:1,ma:!1,Ea:!1,vc:null,pa:Y.pa,Ma:-1,Ia:-1,$:-1,Va:-1,va:-1,Ka:-1,qa:null,wa:-1},ub=[{type:"1f",name:"u32",value:0}],Ya={VERSION:"1.2.0",init:function(a){function c(d){a.callbackReady&&a.callbackReady(d)}if(ma!==aa.sa)return c("ALREADY_INITIALIZED");ma=aa.LOADING;D=Object.assign({},Sb);J=Object.assign({},Tb);if("undefined"!==typeof a.canvas)qa=a.canvas,Ra=!1;else if("undefined"===typeof a.canvasId)qa=document.createElement("canvas"),Ra=!1;else{qa=document.getElementById(a.canvasId);
if(!qa)return c("INVALID_CANVASID"),!1;Ra=!0}"undefined"!==typeof a.isDebugRender&&(Ra=a.isDebugRender);Ra&&(qa.style.display="block");a.scanSettings&&Object.assign(Ba,a.scanSettings);a.canvasSize&&(Y.ua=a.canvasSize);mb.o({n:Y.La[1]-Y.La[0]+1,rb:Y.ld-Y.La[0]});La="undefined"===typeof a.followZRot?!1:a.followZRot;Sa="undefined"===typeof a.ZRotRange?null:a.ZRotRange;Bb="undefined"!==typeof WorkerGlobalScope&&"undefined"!==typeof self&&self instanceof WorkerGlobalScope;-1!==Y.ua&&(qa.width=Y.ua,qa.height=
Y.ua);Ya.set_source(a.video,a.videoCrop);if(!Za.o({cb:qa,width:qa.width,height:qa.height,debug:!1,mc:c.bind(null,"GLCONTEXT_LOST"),premultipliedAlpha:!1}))return c("GL_INCOMPATIBLE"),!1;0===J.current&&(vb(J.element),Oa());Ib();eb();ma=aa.ha;c(!1);return!0},set_source:function(a,c){"undefined"!==typeof a&&a?(J.element=a,J.current=0,J.element.isFakeVideo?(D.Y=J.element.videoWidth,D.X=J.element.videoHeight,J.type=Ca.fb):"VIDEO"===a.tagName?(D.Y=J.element.videoWidth,D.X=J.element.videoHeight,J.type=Ca.video):
(D.Y=J.element.width,D.X=J.element.height,J.type=Ca.Lb),nb(c)):J.current=1;-1===[aa.sa,aa.LOADING].indexOf(ma)&&(J.ca&&J.ca.s&&(J.ca.s=a),Oa(),eb(),J.type===Ca.Lb&&J.F.refresh())},set_NN:function(a,c,d){if(1===Va)c&&c("NN_LOADING");else{var e=function(r){Va=0;c&&c(r)};Va=1;"string"===typeof a?xb.get(a,function(r){if(!r)return e("INVALID_NN");var t=null;try{t=JSON.parse(r)}catch(u){return e("INVALID_NN")}wb(t,e,d)},function(){e("NOTFOUND_NN")}):wb(a,e,d)}},reset_state:function(){tb();ma=aa.ha},destroy:function(){Ya.reset_state();
Pa&&Pa.j();Za.j();Va=-2;ma=aa.sa;return Promise.resolve()},detect:function(a,c,d){if(ma===aa.LOADING||0!==Va)return la;Object.assign(ka,Ub,d?d:{});R.Wa=ka.thresholdDetectFactor;R.uc=ka.thresholdDetectFactorUnstitch;R.ma=ka.isSkipConfirmation;R.Ea=ka.isKeepTracking;R.vc=ka.trackingFactors;R.pa=ka.secondNeighborFactor;R.Ma=ka.nLocateAutomoves;R.Ia=ka.locateMoveNoiseAmplitude;R.$=ka.nConfirmAutoMoves;R.Va=ka.thresholdConfirmOffset;R.va=ka.confirmMoveNoiseAmplitude;R.Ka=ka.nConfirmUnstitchMoves;R.qa=
ka.tiltPosAngleIfAmbiguousDetection;R.wa=ka.confirmScoreMinFactorDuringAutoMove;Ea.R();la.label=!1;switch(J.current){case 0:J.type===Ca.video&&J.time!==J.element.currentTime?(J.F.refresh(),J.time=J.element.currentTime):J.type===Ca.fb&&J.element.needsUpdate&&(J.F.xc(J.element.arrayBuffer),J.element.needsUpdate=!1);switch(ka.cutShader){case "median":D.ka="s50";break;default:D.ka="s49"}break;case 1:if(!J.fc){D.L=c.size.width;D.H=c.size.height;switch(ka.cutShader){case "IOS":D.ka="s52";A.D("s52",[{name:"u7",
type:"2f",value:[1/D.L,1/D.H]}]);break;default:D.ka="s49"}vb(null);Oa()}J.F.xc(c.buffer)}a||(a=mb.Xc()+Y.La[0],mb.Ad());for(c=0;c<a;++c)P.F.ba(),A.set(D.ka),La&&S.la&&A.M("u32",ma===aa.ra?wa:0),J.F.c(0),A.oa("u36",P.g),Z.i(!1,!1),P.F.c(0),ib=c===a-1,Pa.I(!1,P.F),Ea.R();Ea.Cd();Ra&&(b.viewport(0,0,qa.width,qa.height),A.set("s51"),J.F.c(0),A.oa("u36",P.g),Z.i(!1,!1),Bb&&b.commit?b.commit():b.flush());return la},get_aspectRatio:function(){return D.L/D.H},set_scanSettings:function(a){Object.assign(Ba,
a);Oa()},set_videoCrop:function(a){nb(a);eb();Oa()}};return Ya}();
;return WEBARROCKSOBJECT||window.WEBARROCKSOBJECT;})();